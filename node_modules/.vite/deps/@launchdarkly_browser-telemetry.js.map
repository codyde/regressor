{
  "version": 3,
  "sources": ["browser-external:worker_threads", "../../tracekit/tracekit.js", "../../@launchdarkly/src/collectors/dom/getTarget.ts", "../../@launchdarkly/src/collectors/dom/toSelector.ts", "../../@launchdarkly/src/collectors/dom/ClickCollector.ts", "../../@launchdarkly/src/collectors/dom/KeypressCollector.ts", "../../@launchdarkly/src/collectors/error.ts", "../../@launchdarkly/src/filters/filterHttpBreadcrumb.ts", "../../@launchdarkly/src/filters/filterUrl.ts", "../../@launchdarkly/src/collectors/http/fetchDecorator.ts", "../../@launchdarkly/src/collectors/http/fetch.ts", "../../@launchdarkly/src/collectors/http/xhrDecorator.ts", "../../@launchdarkly/src/collectors/http/xhr.ts", "../../@launchdarkly/src/filters/defaultUrlFilter.ts", "../../@launchdarkly/src/randomUuidV4.ts", "../../@launchdarkly/src/stack/StackParser.ts", "../../@launchdarkly/src/BrowserTelemetryImpl.ts", "../../@launchdarkly/src/inspectors.ts", "../../rrweb/es/rrweb/packages/rrweb-snapshot/es/rrweb-snapshot.js", "../../rrweb/es/rrweb/packages/rrweb/src/utils.js", "../../rrweb/es/rrweb/packages/types/dist/types.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/mutation.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/observer.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/cross-origin-iframe-mirror.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/iframe-manager.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/shadow-dom-manager.js", "../../rrweb/es/rrweb/ext/tslib/tslib.es6.js", "../../rrweb/es/rrweb/ext/base64-arraybuffer/dist/base64-arraybuffer.es5.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/serialize-args.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/canvas.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/webgl.js", "../../rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__node__WorkerClass.js", "../../rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__node__createBase64WorkerFactory.js", "../../rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__browser__createBase64WorkerFactory.js", "../../rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__auto__isNodeJS.js", "../../rrweb/es/rrweb/_virtual/image-bitmap-data-url-worker.js", "../../rrweb/es/rrweb/_virtual/_rollup-plugin-web-worker-loader__helper__auto__createBase64WorkerFactory.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/canvas-manager.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/observers/canvas/2d.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/stylesheet-manager.js", "../../rrweb/es/rrweb/packages/rrweb/src/record/index.js", "../../@launchdarkly/src/collectors/rrweb/ContinuousReplay.ts", "../../@launchdarkly/src/collectors/rrweb/EventBuffer.ts", "../../@launchdarkly/src/collectors/rrweb/RollingBuffer.ts", "../../@launchdarkly/src/collectors/rrweb/RollingReplay.ts", "../../@launchdarkly/src/collectors/rrweb/SessionReplay.ts", "../../@launchdarkly/src/options.ts", "../../@launchdarkly/src/index.ts"],
  "sourcesContent": ["module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"worker_threads\" has been externalized for browser compatibility. Cannot access \"worker_threads.${key}\" in client code. See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "/**\n * https://github.com/csnover/TraceKit\n * @license MIT\n * @namespace TraceKit\n */\n(function(window, undefined) {\nif (!window) {\n    return;\n}\n\nvar TraceKit = {};\nvar _oldTraceKit = window.TraceKit;\n\n// global reference to slice\nvar _slice = [].slice;\nvar UNKNOWN_FUNCTION = '?';\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Error_types\nvar ERROR_TYPES_RE = /^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;\n\n/**\n * A better form of hasOwnProperty<br/>\n * Example: `_has(MainHostObject, property) === true/false`\n *\n * @param {Object} object to check property\n * @param {string} key to check\n * @return {Boolean} true if the object has the key and it is not inherited\n */\nfunction _has(object, key) {\n    return Object.prototype.hasOwnProperty.call(object, key);\n}\n\n/**\n * Returns true if the parameter is undefined<br/>\n * Example: `_isUndefined(val) === true/false`\n *\n * @param {*} what Value to check\n * @return {Boolean} true if undefined and false otherwise\n */\nfunction _isUndefined(what) {\n    return typeof what === 'undefined';\n}\n\n/**\n * Export TraceKit out to another variable<br/>\n * Example: `var TK = TraceKit.noConflict()`\n * @return {Object} The TraceKit object\n * @memberof TraceKit\n */\nTraceKit.noConflict = function noConflict() {\n    window.TraceKit = _oldTraceKit;\n    return TraceKit;\n};\n\n/**\n * Wrap any function in a TraceKit reporter<br/>\n * Example: `func = TraceKit.wrap(func);`\n *\n * @param {Function} func Function to be wrapped\n * @return {Function} The wrapped func\n * @memberof TraceKit\n */\nTraceKit.wrap = function traceKitWrapper(func) {\n    function wrapped() {\n        try {\n            return func.apply(this, arguments);\n        } catch (e) {\n            TraceKit.report(e);\n            throw e;\n        }\n    }\n    return wrapped;\n};\n\n/**\n * Cross-browser processing of unhandled exceptions\n *\n * Syntax:\n * ```js\n *   TraceKit.report.subscribe(function(stackInfo) { ... })\n *   TraceKit.report.unsubscribe(function(stackInfo) { ... })\n *   TraceKit.report(exception)\n *   try { ...code... } catch(ex) { TraceKit.report(ex); }\n * ```\n *\n * Supports:\n *   - Firefox: full stack trace with line numbers, plus column number\n *     on top frame; column number is not guaranteed\n *   - Opera: full stack trace with line and column numbers\n *   - Chrome: full stack trace with line and column numbers\n *   - Safari: line and column number for the top frame only; some frames\n *     may be missing, and column number is not guaranteed\n *   - IE: line and column number for the top frame only; some frames\n *     may be missing, and column number is not guaranteed\n *\n * In theory, TraceKit should work on all of the following versions:\n *   - IE5.5+ (only 8.0 tested)\n *   - Firefox 0.9+ (only 3.5+ tested)\n *   - Opera 7+ (only 10.50 tested; versions 9 and earlier may require\n *     Exceptions Have Stacktrace to be enabled in opera:config)\n *   - Safari 3+ (only 4+ tested)\n *   - Chrome 1+ (only 5+ tested)\n *   - Konqueror 3.5+ (untested)\n *\n * Requires TraceKit.computeStackTrace.\n *\n * Tries to catch all unhandled exceptions and report them to the\n * subscribed handlers. Please note that TraceKit.report will rethrow the\n * exception. This is REQUIRED in order to get a useful stack trace in IE.\n * If the exception does not reach the top of the browser, you will only\n * get a stack trace from the point where TraceKit.report was called.\n *\n * Handlers receive a TraceKit.StackTrace object as described in the\n * TraceKit.computeStackTrace docs.\n *\n * @memberof TraceKit\n * @namespace\n */\nTraceKit.report = (function reportModuleWrapper() {\n    var handlers = [],\n        lastException = null,\n        lastExceptionStack = null;\n\n    /**\n     * Add a crash handler.\n     * @param {Function} handler\n     * @memberof TraceKit.report\n     */\n    function subscribe(handler) {\n        installGlobalHandler();\n        installGlobalUnhandledRejectionHandler();\n        handlers.push(handler);\n    }\n\n    /**\n     * Remove a crash handler.\n     * @param {Function} handler\n     * @memberof TraceKit.report\n     */\n    function unsubscribe(handler) {\n        for (var i = handlers.length - 1; i >= 0; --i) {\n            if (handlers[i] === handler) {\n                handlers.splice(i, 1);\n            }\n        }\n\n        if (handlers.length === 0) {\n            uninstallGlobalHandler();\n            uninstallGlobalUnhandledRejectionHandler();\n        }\n    }\n\n    /**\n     * Dispatch stack information to all handlers.\n     * @param {TraceKit.StackTrace} stack\n     * @param {boolean} isWindowError Is this a top-level window error?\n     * @param {Error=} error The error that's being handled (if available, null otherwise)\n     * @memberof TraceKit.report\n     * @throws An exception if an error occurs while calling an handler.\n     */\n    function notifyHandlers(stack, isWindowError, error) {\n        var exception = null;\n        if (isWindowError && !TraceKit.collectWindowErrors) {\n          return;\n        }\n        for (var i in handlers) {\n            if (_has(handlers, i)) {\n                try {\n                    handlers[i](stack, isWindowError, error);\n                } catch (inner) {\n                    exception = inner;\n                }\n            }\n        }\n\n        if (exception) {\n            throw exception;\n        }\n    }\n\n    var _oldOnerrorHandler, _onErrorHandlerInstalled;\n    var _oldOnunhandledrejectionHandler, _onUnhandledRejectionHandlerInstalled;\n\n    /**\n     * Ensures all global unhandled exceptions are recorded.\n     * Supported by Gecko and IE.\n     * @param {string} message Error message.\n     * @param {string} url URL of script that generated the exception.\n     * @param {(number|string)} lineNo The line number at which the error occurred.\n     * @param {(number|string)=} columnNo The column number at which the error occurred.\n     * @param {Error=} errorObj The actual Error object.\n     * @memberof TraceKit.report\n     */\n    function traceKitWindowOnError(message, url, lineNo, columnNo, errorObj) {\n        var stack = null;\n\n        if (lastExceptionStack) {\n            TraceKit.computeStackTrace.augmentStackTraceWithInitialElement(lastExceptionStack, url, lineNo, message);\n    \t    processLastException();\n        } else if (errorObj) {\n            stack = TraceKit.computeStackTrace(errorObj);\n            notifyHandlers(stack, true, errorObj);\n        } else {\n            var location = {\n              'url': url,\n              'line': lineNo,\n              'column': columnNo\n            };\n\n            var name;\n            var msg = message; // must be new var or will modify original `arguments`\n            if ({}.toString.call(message) === '[object String]') {\n                var groups = message.match(ERROR_TYPES_RE);\n                if (groups) {\n                    name = groups[1];\n                    msg = groups[2];\n                }\n            }\n\n            location.func = TraceKit.computeStackTrace.guessFunctionName(location.url, location.line);\n            location.context = TraceKit.computeStackTrace.gatherContext(location.url, location.line);\n            stack = {\n                'name': name,\n                'message': msg,\n                'mode': 'onerror',\n                'stack': [location]\n            };\n\n            notifyHandlers(stack, true, null);\n        }\n\n        if (_oldOnerrorHandler) {\n            return _oldOnerrorHandler.apply(this, arguments);\n        }\n\n        return false;\n    }\n\n    /**\n     * Ensures all unhandled rejections are recorded.\n     * @param {PromiseRejectionEvent} e event.\n     * @memberof TraceKit.report\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onunhandledrejection\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PromiseRejectionEvent\n     */\n    function traceKitWindowOnUnhandledRejection(e) {\n        var stack = TraceKit.computeStackTrace(e.reason);\n        notifyHandlers(stack, true, e.reason);\n    }\n\n    /**\n     * Install a global onerror handler\n     * @memberof TraceKit.report\n     */\n    function installGlobalHandler() {\n        if (_onErrorHandlerInstalled === true) {\n            return;\n        }\n\n        _oldOnerrorHandler = window.onerror;\n        window.onerror = traceKitWindowOnError;\n        _onErrorHandlerInstalled = true;\n    }\n\n    /**\n     * Uninstall the global onerror handler\n     * @memberof TraceKit.report\n     */\n    function uninstallGlobalHandler() {\n        if (_onErrorHandlerInstalled) {\n            window.onerror = _oldOnerrorHandler;\n            _onErrorHandlerInstalled = false;\n        }\n    }\n\n    /**\n     * Install a global onunhandledrejection handler\n     * @memberof TraceKit.report\n     */\n    function installGlobalUnhandledRejectionHandler() {\n        if (_onUnhandledRejectionHandlerInstalled === true) {\n            return;\n        }\n\n        _oldOnunhandledrejectionHandler = window.onunhandledrejection;\n        window.onunhandledrejection = traceKitWindowOnUnhandledRejection;\n        _onUnhandledRejectionHandlerInstalled = true;\n    }\n\n    /**\n     * Uninstall the global onunhandledrejection handler\n     * @memberof TraceKit.report\n     */\n    function uninstallGlobalUnhandledRejectionHandler() {\n        if (_onUnhandledRejectionHandlerInstalled) {\n            window.onunhandledrejection = _oldOnunhandledrejectionHandler;\n            _onUnhandledRejectionHandlerInstalled = false;\n        }\n    }\n\n    /**\n     * Process the most recent exception\n     * @memberof TraceKit.report\n     */\n    function processLastException() {\n        var _lastExceptionStack = lastExceptionStack,\n            _lastException = lastException;\n        lastExceptionStack = null;\n        lastException = null;\n        notifyHandlers(_lastExceptionStack, false, _lastException);\n    }\n\n    /**\n     * Reports an unhandled Error to TraceKit.\n     * @param {Error} ex\n     * @memberof TraceKit.report\n     * @throws An exception if an incomplete stack trace is detected (old IE browsers).\n     */\n    function report(ex) {\n        if (lastExceptionStack) {\n            if (lastException === ex) {\n                return; // already caught by an inner catch block, ignore\n            } else {\n              processLastException();\n            }\n        }\n\n        var stack = TraceKit.computeStackTrace(ex);\n        lastExceptionStack = stack;\n        lastException = ex;\n\n        // If the stack trace is incomplete, wait for 2 seconds for\n        // slow slow IE to see if onerror occurs or not before reporting\n        // this exception; otherwise, we will end up with an incomplete\n        // stack trace\n        setTimeout(function () {\n            if (lastException === ex) {\n                processLastException();\n            }\n        }, (stack.incomplete ? 2000 : 0));\n\n        throw ex; // re-throw to propagate to the top level (and cause window.onerror)\n    }\n\n    report.subscribe = subscribe;\n    report.unsubscribe = unsubscribe;\n    return report;\n}());\n\n/**\n * An object representing a single stack frame.\n * @typedef {Object} StackFrame\n * @property {string} url The JavaScript or HTML file URL.\n * @property {string} func The function name, or empty for anonymous functions (if guessing did not work).\n * @property {string[]?} args The arguments passed to the function, if known.\n * @property {number=} line The line number, if known.\n * @property {number=} column The column number, if known.\n * @property {string[]} context An array of source code lines; the middle element corresponds to the correct line#.\n * @memberof TraceKit\n */\n\n/**\n * An object representing a JavaScript stack trace.\n * @typedef {Object} StackTrace\n * @property {string} name The name of the thrown exception.\n * @property {string} message The exception error message.\n * @property {TraceKit.StackFrame[]} stack An array of stack frames.\n * @property {string} mode 'stack', 'stacktrace', 'multiline', 'callers', 'onerror', or 'failed' -- method used to collect the stack trace.\n * @memberof TraceKit\n */\n\n/**\n * TraceKit.computeStackTrace: cross-browser stack traces in JavaScript\n *\n * Syntax:\n *   ```js\n *   s = TraceKit.computeStackTrace.ofCaller([depth])\n *   s = TraceKit.computeStackTrace(exception) // consider using TraceKit.report instead (see below)\n *   ```\n *\n * Supports:\n *   - Firefox:  full stack trace with line numbers and unreliable column\n *               number on top frame\n *   - Opera 10: full stack trace with line and column numbers\n *   - Opera 9-: full stack trace with line numbers\n *   - Chrome:   full stack trace with line and column numbers\n *   - Safari:   line and column number for the topmost stacktrace element\n *               only\n *   - IE:       no line numbers whatsoever\n *\n * Tries to guess names of anonymous functions by looking for assignments\n * in the source code. In IE and Safari, we have to guess source file names\n * by searching for function bodies inside all page scripts. This will not\n * work for scripts that are loaded cross-domain.\n * Here be dragons: some function names may be guessed incorrectly, and\n * duplicate functions may be mismatched.\n *\n * TraceKit.computeStackTrace should only be used for tracing purposes.\n * Logging of unhandled exceptions should be done with TraceKit.report,\n * which builds on top of TraceKit.computeStackTrace and provides better\n * IE support by utilizing the window.onerror event to retrieve information\n * about the top of the stack.\n *\n * Note: In IE and Safari, no stack trace is recorded on the Error object,\n * so computeStackTrace instead walks its *own* chain of callers.\n * This means that:\n *  * in Safari, some methods may be missing from the stack trace;\n *  * in IE, the topmost function in the stack trace will always be the\n *    caller of computeStackTrace.\n *\n * This is okay for tracing (because you are likely to be calling\n * computeStackTrace from the function you want to be the topmost element\n * of the stack trace anyway), but not okay for logging unhandled\n * exceptions (because your catch block will likely be far away from the\n * inner function that actually caused the exception).\n *\n * Tracing example:\n *  ```js\n *     function trace(message) {\n *         var stackInfo = TraceKit.computeStackTrace.ofCaller();\n *         var data = message + \"\\n\";\n *         for(var i in stackInfo.stack) {\n *             var item = stackInfo.stack[i];\n *             data += (item.func || '[anonymous]') + \"() in \" + item.url + \":\" + (item.line || '0') + \"\\n\";\n *         }\n *         if (window.console)\n *             console.info(data);\n *         else\n *             alert(data);\n *     }\n * ```\n * @memberof TraceKit\n * @namespace\n */\nTraceKit.computeStackTrace = (function computeStackTraceWrapper() {\n    var debug = false,\n        sourceCache = {};\n\n    /**\n     * Attempts to retrieve source code via XMLHttpRequest, which is used\n     * to look up anonymous function names.\n     * @param {string} url URL of source code.\n     * @return {string} Source contents.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function loadSource(url) {\n        if (!TraceKit.remoteFetching) { //Only attempt request if remoteFetching is on.\n            return '';\n        }\n        try {\n            var getXHR = function() {\n                try {\n                    return new window.XMLHttpRequest();\n                } catch (e) {\n                    // explicitly bubble up the exception if not found\n                    return new window.ActiveXObject('Microsoft.XMLHTTP');\n                }\n            };\n\n            var request = getXHR();\n            request.open('GET', url, false);\n            request.send('');\n            return request.responseText;\n        } catch (e) {\n            return '';\n        }\n    }\n\n    /**\n     * Retrieves source code from the source code cache.\n     * @param {string} url URL of source code.\n     * @return {Array.<string>} Source contents.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function getSource(url) {\n        if (typeof url !== 'string') {\n            return [];\n        }\n\n        if (!_has(sourceCache, url)) {\n            // URL needs to be able to fetched within the acceptable domain.  Otherwise,\n            // cross-domain errors will be triggered.\n            /*\n                Regex matches:\n                0 - Full Url\n                1 - Protocol\n                2 - Domain\n                3 - Port (Useful for internal applications)\n                4 - Path\n            */\n            var source = '';\n            var domain = '';\n            try { domain = window.document.domain; } catch (e) { }\n            var match = /(.*)\\:\\/\\/([^:\\/]+)([:\\d]*)\\/{0,1}([\\s\\S]*)/.exec(url);\n            if (match && match[2] === domain) {\n                source = loadSource(url);\n            }\n            sourceCache[url] = source ? source.split('\\n') : [];\n        }\n\n        return sourceCache[url];\n    }\n\n    /**\n     * Tries to use an externally loaded copy of source code to determine\n     * the name of a function by looking at the name of the variable it was\n     * assigned to, if any.\n     * @param {string} url URL of source code.\n     * @param {(string|number)} lineNo Line number in source code.\n     * @return {string} The function name, if discoverable.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function guessFunctionName(url, lineNo) {\n        var reFunctionArgNames = /function ([^(]*)\\(([^)]*)\\)/,\n            reGuessFunction = /['\"]?([0-9A-Za-z$_]+)['\"]?\\s*[:=]\\s*(function|eval|new Function)/,\n            line = '',\n            maxLines = 10,\n            source = getSource(url),\n            m;\n\n        if (!source.length) {\n            return UNKNOWN_FUNCTION;\n        }\n\n        // Walk backwards from the first line in the function until we find the line which\n        // matches the pattern above, which is the function definition\n        for (var i = 0; i < maxLines; ++i) {\n            line = source[lineNo - i] + line;\n\n            if (!_isUndefined(line)) {\n                if ((m = reGuessFunction.exec(line))) {\n                    return m[1];\n                } else if ((m = reFunctionArgNames.exec(line))) {\n                    return m[1];\n                }\n            }\n        }\n\n        return UNKNOWN_FUNCTION;\n    }\n\n    /**\n     * Retrieves the surrounding lines from where an exception occurred.\n     * @param {string} url URL of source code.\n     * @param {(string|number)} line Line number in source code to center around for context.\n     * @return {?Array.<string>} Lines of source code.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function gatherContext(url, line) {\n        var source = getSource(url);\n\n        if (!source.length) {\n            return null;\n        }\n\n        var context = [],\n            // linesBefore & linesAfter are inclusive with the offending line.\n            // if linesOfContext is even, there will be one extra line\n            //   *before* the offending line.\n            linesBefore = Math.floor(TraceKit.linesOfContext / 2),\n            // Add one extra line if linesOfContext is odd\n            linesAfter = linesBefore + (TraceKit.linesOfContext % 2),\n            start = Math.max(0, line - linesBefore - 1),\n            end = Math.min(source.length, line + linesAfter - 1);\n\n        line -= 1; // convert to 0-based index\n\n        for (var i = start; i < end; ++i) {\n            if (!_isUndefined(source[i])) {\n                context.push(source[i]);\n            }\n        }\n\n        return context.length > 0 ? context : null;\n    }\n\n    /**\n     * Escapes special characters, except for whitespace, in a string to be\n     * used inside a regular expression as a string literal.\n     * @param {string} text The string.\n     * @return {string} The escaped string literal.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function escapeRegExp(text) {\n        return text.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#]/g, '\\\\$&');\n    }\n\n    /**\n     * Escapes special characters in a string to be used inside a regular\n     * expression as a string literal. Also ensures that HTML entities will\n     * be matched the same as their literal friends.\n     * @param {string} body The string.\n     * @return {string} The escaped string.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function escapeCodeAsRegExpForMatchingInsideHTML(body) {\n        return escapeRegExp(body).replace('<', '(?:<|&lt;)').replace('>', '(?:>|&gt;)').replace('&', '(?:&|&amp;)').replace('\"', '(?:\"|&quot;)').replace(/\\s+/g, '\\\\s+');\n    }\n\n    /**\n     * Determines where a code fragment occurs in the source code.\n     * @param {RegExp} re The function definition.\n     * @param {Array.<string>} urls A list of URLs to search.\n     * @return {?Object.<string, (string|number)>} An object containing\n     * the url, line, and column number of the defined function.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function findSourceInUrls(re, urls) {\n        var source, m;\n        for (var i = 0, j = urls.length; i < j; ++i) {\n            if ((source = getSource(urls[i])).length) {\n                source = source.join('\\n');\n                if ((m = re.exec(source))) {\n\n                    return {\n                        'url': urls[i],\n                        'line': source.substring(0, m.index).split('\\n').length,\n                        'column': m.index - source.lastIndexOf('\\n', m.index) - 1\n                    };\n                }\n            }\n        }\n\n        return null;\n    }\n\n    /**\n     * Determines at which column a code fragment occurs on a line of the\n     * source code.\n     * @param {string} fragment The code fragment.\n     * @param {string} url The URL to search.\n     * @param {(string|number)} line The line number to examine.\n     * @return {?number} The column number.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function findSourceInLine(fragment, url, line) {\n        var source = getSource(url),\n            re = new RegExp('\\\\b' + escapeRegExp(fragment) + '\\\\b'),\n            m;\n\n        line -= 1;\n\n        if (source && source.length > line && (m = re.exec(source[line]))) {\n            return m.index;\n        }\n\n        return null;\n    }\n\n    /**\n     * Determines where a function was defined within the source code.\n     * @param {(Function|string)} func A function reference or serialized\n     * function definition.\n     * @return {?Object.<string, (string|number)>} An object containing\n     * the url, line, and column number of the defined function.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function findSourceByFunctionBody(func) {\n        if (_isUndefined(window && window.document)) {\n            return;\n        }\n\n        var urls = [window.location.href],\n            scripts = window.document.getElementsByTagName('script'),\n            body,\n            code = '' + func,\n            codeRE = /^function(?:\\s+([\\w$]+))?\\s*\\(([\\w\\s,]*)\\)\\s*\\{\\s*(\\S[\\s\\S]*\\S)\\s*\\}\\s*$/,\n            eventRE = /^function on([\\w$]+)\\s*\\(event\\)\\s*\\{\\s*(\\S[\\s\\S]*\\S)\\s*\\}\\s*$/,\n            re,\n            parts,\n            result;\n\n        for (var i = 0; i < scripts.length; ++i) {\n            var script = scripts[i];\n            if (script.src) {\n                urls.push(script.src);\n            }\n        }\n\n        if (!(parts = codeRE.exec(code))) {\n            re = new RegExp(escapeRegExp(code).replace(/\\s+/g, '\\\\s+'));\n        }\n\n        // not sure if this is really necessary, but I don’t have a test\n        // corpus large enough to confirm that and it was in the original.\n        else {\n            var name = parts[1] ? '\\\\s+' + parts[1] : '',\n                args = parts[2].split(',').join('\\\\s*,\\\\s*');\n\n            body = escapeRegExp(parts[3]).replace(/;$/, ';?'); // semicolon is inserted if the function ends with a comment.replace(/\\s+/g, '\\\\s+');\n            re = new RegExp('function' + name + '\\\\s*\\\\(\\\\s*' + args + '\\\\s*\\\\)\\\\s*{\\\\s*' + body + '\\\\s*}');\n        }\n\n        // look for a normal function definition\n        if ((result = findSourceInUrls(re, urls))) {\n            return result;\n        }\n\n        // look for an old-school event handler function\n        if ((parts = eventRE.exec(code))) {\n            var event = parts[1];\n            body = escapeCodeAsRegExpForMatchingInsideHTML(parts[2]);\n\n            // look for a function defined in HTML as an onXXX handler\n            re = new RegExp('on' + event + '=[\\\\\\'\"]\\\\s*' + body + '\\\\s*[\\\\\\'\"]', 'i');\n\n            if ((result = findSourceInUrls(re, urls[0]))) {\n                return result;\n            }\n\n            // look for ???\n            re = new RegExp(body);\n\n            if ((result = findSourceInUrls(re, urls))) {\n                return result;\n            }\n        }\n\n        return null;\n    }\n\n    // Contents of Exception in various browsers.\n    //\n    // SAFARI:\n    // ex.message = Can't find variable: qq\n    // ex.line = 59\n    // ex.sourceId = 580238192\n    // ex.sourceURL = http://...\n    // ex.expressionBeginOffset = 96\n    // ex.expressionCaretOffset = 98\n    // ex.expressionEndOffset = 98\n    // ex.name = ReferenceError\n    //\n    // FIREFOX:\n    // ex.message = qq is not defined\n    // ex.fileName = http://...\n    // ex.lineNumber = 59\n    // ex.columnNumber = 69\n    // ex.stack = ...stack trace... (see the example below)\n    // ex.name = ReferenceError\n    //\n    // CHROME:\n    // ex.message = qq is not defined\n    // ex.name = ReferenceError\n    // ex.type = not_defined\n    // ex.arguments = ['aa']\n    // ex.stack = ...stack trace...\n    //\n    // INTERNET EXPLORER:\n    // ex.message = ...\n    // ex.name = ReferenceError\n    //\n    // OPERA:\n    // ex.message = ...message... (see the example below)\n    // ex.name = ReferenceError\n    // ex.opera#sourceloc = 11  (pretty much useless, duplicates the info in ex.message)\n    // ex.stacktrace = n/a; see 'opera:config#UserPrefs|Exceptions Have Stacktrace'\n\n    /**\n     * Computes stack trace information from the stack property.\n     * Chrome and Gecko use this property.\n     * @param {Error} ex\n     * @return {?TraceKit.StackTrace} Stack trace information.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function computeStackTraceFromStackProp(ex) {\n        if (!ex.stack) {\n            return null;\n        }\n\n        var chrome = /^\\s*at (.*?) ?\\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\\/).*?)(?::(\\d+))?(?::(\\d+))?\\)?\\s*$/i,\n            gecko = /^\\s*(.*?)(?:\\((.*?)\\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\\[native).*?|[^@]*bundle)(?::(\\d+))?(?::(\\d+))?\\s*$/i,\n            winjs = /^\\s*at (?:((?:\\[object object\\])?.+) )?\\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\\d+)(?::(\\d+))?\\)?\\s*$/i,\n\n            // Used to additionally parse URL/line/column from eval frames\n            isEval,\n            geckoEval = /(\\S+) line (\\d+)(?: > eval line \\d+)* > eval/i,\n            chromeEval = /\\((\\S*)(?::(\\d+))(?::(\\d+))\\)/,\n\n            lines = ex.stack.split('\\n'),\n            stack = [],\n            submatch,\n            parts,\n            element,\n            reference = /^(.*) is undefined$/.exec(ex.message);\n\n        for (var i = 0, j = lines.length; i < j; ++i) {\n            if ((parts = chrome.exec(lines[i]))) {\n                var isNative = parts[2] && parts[2].indexOf('native') === 0; // start of line\n                isEval = parts[2] && parts[2].indexOf('eval') === 0; // start of line\n                if (isEval && (submatch = chromeEval.exec(parts[2]))) {\n                    // throw out eval line/column and use top-most line/column number\n                    parts[2] = submatch[1]; // url\n                    parts[3] = submatch[2]; // line\n                    parts[4] = submatch[3]; // column\n                }\n                element = {\n                    'url': !isNative ? parts[2] : null,\n                    'func': parts[1] || UNKNOWN_FUNCTION,\n                    'args': isNative ? [parts[2]] : [],\n                    'line': parts[3] ? +parts[3] : null,\n                    'column': parts[4] ? +parts[4] : null\n                };\n            } else if ( parts = winjs.exec(lines[i]) ) {\n                element = {\n                    'url': parts[2],\n                    'func': parts[1] || UNKNOWN_FUNCTION,\n                    'args': [],\n                    'line': +parts[3],\n                    'column': parts[4] ? +parts[4] : null\n                };\n            } else if ((parts = gecko.exec(lines[i]))) {\n                isEval = parts[3] && parts[3].indexOf(' > eval') > -1;\n                if (isEval && (submatch = geckoEval.exec(parts[3]))) {\n                    // throw out eval line/column and use top-most line number\n                    parts[3] = submatch[1];\n                    parts[4] = submatch[2];\n                    parts[5] = null; // no column when eval\n                } else if (i === 0 && !parts[5] && !_isUndefined(ex.columnNumber)) {\n                    // FireFox uses this awesome columnNumber property for its top frame\n                    // Also note, Firefox's column number is 0-based and everything else expects 1-based,\n                    // so adding 1\n                    // NOTE: this hack doesn't work if top-most frame is eval\n                    stack[0].column = ex.columnNumber + 1;\n                }\n                element = {\n                    'url': parts[3],\n                    'func': parts[1] || UNKNOWN_FUNCTION,\n                    'args': parts[2] ? parts[2].split(',') : [],\n                    'line': parts[4] ? +parts[4] : null,\n                    'column': parts[5] ? +parts[5] : null\n                };\n            } else {\n                continue;\n            }\n\n            if (!element.func && element.line) {\n                element.func = guessFunctionName(element.url, element.line);\n            }\n\n            element.context = element.line ? gatherContext(element.url, element.line) : null;\n            stack.push(element);\n        }\n\n        if (!stack.length) {\n            return null;\n        }\n\n        if (stack[0] && stack[0].line && !stack[0].column && reference) {\n            stack[0].column = findSourceInLine(reference[1], stack[0].url, stack[0].line);\n        }\n\n        return {\n            'mode': 'stack',\n            'name': ex.name,\n            'message': ex.message,\n            'stack': stack\n        };\n    }\n\n    /**\n     * Computes stack trace information from the stacktrace property.\n     * Opera 10+ uses this property.\n     * @param {Error} ex\n     * @return {?TraceKit.StackTrace} Stack trace information.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function computeStackTraceFromStacktraceProp(ex) {\n        // Access and store the stacktrace property before doing ANYTHING\n        // else to it because Opera is not very good at providing it\n        // reliably in other circumstances.\n        var stacktrace = ex.stacktrace;\n        if (!stacktrace) {\n            return;\n        }\n\n        var opera10Regex = / line (\\d+).*script (?:in )?(\\S+)(?:: in function (\\S+))?$/i,\n            opera11Regex = / line (\\d+), column (\\d+)\\s*(?:in (?:<anonymous function: ([^>]+)>|([^\\)]+))\\((.*)\\))? in (.*):\\s*$/i,\n            lines = stacktrace.split('\\n'),\n            stack = [],\n            parts;\n\n        for (var line = 0; line < lines.length; line += 2) {\n            var element = null;\n            if ((parts = opera10Regex.exec(lines[line]))) {\n                element = {\n                    'url': parts[2],\n                    'line': +parts[1],\n                    'column': null,\n                    'func': parts[3],\n                    'args':[]\n                };\n            } else if ((parts = opera11Regex.exec(lines[line]))) {\n                element = {\n                    'url': parts[6],\n                    'line': +parts[1],\n                    'column': +parts[2],\n                    'func': parts[3] || parts[4],\n                    'args': parts[5] ? parts[5].split(',') : []\n                };\n            }\n\n            if (element) {\n                if (!element.func && element.line) {\n                    element.func = guessFunctionName(element.url, element.line);\n                }\n                if (element.line) {\n                    try {\n                        element.context = gatherContext(element.url, element.line);\n                    } catch (exc) {}\n                }\n\n                if (!element.context) {\n                    element.context = [lines[line + 1]];\n                }\n\n                stack.push(element);\n            }\n        }\n\n        if (!stack.length) {\n            return null;\n        }\n\n        return {\n            'mode': 'stacktrace',\n            'name': ex.name,\n            'message': ex.message,\n            'stack': stack\n        };\n    }\n\n    /**\n     * NOT TESTED.\n     * Computes stack trace information from an error message that includes\n     * the stack trace.\n     * Opera 9 and earlier use this method if the option to show stack\n     * traces is turned on in opera:config.\n     * @param {Error} ex\n     * @return {?TraceKit.StackTrace} Stack information.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function computeStackTraceFromOperaMultiLineMessage(ex) {\n        // TODO: Clean this function up\n        // Opera includes a stack trace into the exception message. An example is:\n        //\n        // Statement on line 3: Undefined variable: undefinedFunc\n        // Backtrace:\n        //   Line 3 of linked script file://localhost/Users/andreyvit/Projects/TraceKit/javascript-client/sample.js: In function zzz\n        //         undefinedFunc(a);\n        //   Line 7 of inline#1 script in file://localhost/Users/andreyvit/Projects/TraceKit/javascript-client/sample.html: In function yyy\n        //           zzz(x, y, z);\n        //   Line 3 of inline#1 script in file://localhost/Users/andreyvit/Projects/TraceKit/javascript-client/sample.html: In function xxx\n        //           yyy(a, a, a);\n        //   Line 1 of function script\n        //     try { xxx('hi'); return false; } catch(ex) { TraceKit.report(ex); }\n        //   ...\n\n        var lines = ex.message.split('\\n');\n        if (lines.length < 4) {\n            return null;\n        }\n\n        var lineRE1 = /^\\s*Line (\\d+) of linked script ((?:file|https?|blob)\\S+)(?:: in function (\\S+))?\\s*$/i,\n            lineRE2 = /^\\s*Line (\\d+) of inline#(\\d+) script in ((?:file|https?|blob)\\S+)(?:: in function (\\S+))?\\s*$/i,\n            lineRE3 = /^\\s*Line (\\d+) of function script\\s*$/i,\n            stack = [],\n            scripts = (window && window.document && window.document.getElementsByTagName('script')),\n            inlineScriptBlocks = [],\n            parts;\n\n        for (var s in scripts) {\n            if (_has(scripts, s) && !scripts[s].src) {\n                inlineScriptBlocks.push(scripts[s]);\n            }\n        }\n\n        for (var line = 2; line < lines.length; line += 2) {\n            var item = null;\n            if ((parts = lineRE1.exec(lines[line]))) {\n                item = {\n                    'url': parts[2],\n                    'func': parts[3],\n                    'args': [],\n                    'line': +parts[1],\n                    'column': null\n                };\n            } else if ((parts = lineRE2.exec(lines[line]))) {\n                item = {\n                    'url': parts[3],\n                    'func': parts[4],\n                    'args': [],\n                    'line': +parts[1],\n                    'column': null // TODO: Check to see if inline#1 (+parts[2]) points to the script number or column number.\n                };\n                var relativeLine = (+parts[1]); // relative to the start of the <SCRIPT> block\n                var script = inlineScriptBlocks[parts[2] - 1];\n                if (script) {\n                    var source = getSource(item.url);\n                    if (source) {\n                        source = source.join('\\n');\n                        var pos = source.indexOf(script.innerText);\n                        if (pos >= 0) {\n                            item.line = relativeLine + source.substring(0, pos).split('\\n').length;\n                        }\n                    }\n                }\n            } else if ((parts = lineRE3.exec(lines[line]))) {\n                var url = window.location.href.replace(/#.*$/, '');\n                var re = new RegExp(escapeCodeAsRegExpForMatchingInsideHTML(lines[line + 1]));\n                var src = findSourceInUrls(re, [url]);\n                item = {\n                    'url': url,\n                    'func': '',\n                    'args': [],\n                    'line': src ? src.line : parts[1],\n                    'column': null\n                };\n            }\n\n            if (item) {\n                if (!item.func) {\n                    item.func = guessFunctionName(item.url, item.line);\n                }\n                var context = gatherContext(item.url, item.line);\n                var midline = (context ? context[Math.floor(context.length / 2)] : null);\n                if (context && midline.replace(/^\\s*/, '') === lines[line + 1].replace(/^\\s*/, '')) {\n                    item.context = context;\n                } else {\n                    // if (context) alert(\"Context mismatch. Correct midline:\\n\" + lines[i+1] + \"\\n\\nMidline:\\n\" + midline + \"\\n\\nContext:\\n\" + context.join(\"\\n\") + \"\\n\\nURL:\\n\" + item.url);\n                    item.context = [lines[line + 1]];\n                }\n                stack.push(item);\n            }\n        }\n        if (!stack.length) {\n            return null; // could not parse multiline exception message as Opera stack trace\n        }\n\n        return {\n            'mode': 'multiline',\n            'name': ex.name,\n            'message': lines[0],\n            'stack': stack\n        };\n    }\n\n    /**\n     * Adds information about the first frame to incomplete stack traces.\n     * Safari and IE require this to get complete data on the first frame.\n     * @param {TraceKit.StackTrace} stackInfo Stack trace information from\n     * one of the compute* methods.\n     * @param {string} url The URL of the script that caused an error.\n     * @param {(number|string)} lineNo The line number of the script that\n     * caused an error.\n     * @param {string=} message The error generated by the browser, which\n     * hopefully contains the name of the object that caused the error.\n     * @return {boolean} Whether or not the stack information was\n     * augmented.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function augmentStackTraceWithInitialElement(stackInfo, url, lineNo, message) {\n        var initial = {\n            'url': url,\n            'line': lineNo\n        };\n\n        if (initial.url && initial.line) {\n            stackInfo.incomplete = false;\n\n            if (!initial.func) {\n                initial.func = guessFunctionName(initial.url, initial.line);\n            }\n\n            if (!initial.context) {\n                initial.context = gatherContext(initial.url, initial.line);\n            }\n\n            var reference = / '([^']+)' /.exec(message);\n            if (reference) {\n                initial.column = findSourceInLine(reference[1], initial.url, initial.line);\n            }\n\n            if (stackInfo.stack.length > 0) {\n                if (stackInfo.stack[0].url === initial.url) {\n                    if (stackInfo.stack[0].line === initial.line) {\n                        return false; // already in stack trace\n                    } else if (!stackInfo.stack[0].line && stackInfo.stack[0].func === initial.func) {\n                        stackInfo.stack[0].line = initial.line;\n                        stackInfo.stack[0].context = initial.context;\n                        return false;\n                    }\n                }\n            }\n\n            stackInfo.stack.unshift(initial);\n            stackInfo.partial = true;\n            return true;\n        } else {\n            stackInfo.incomplete = true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Computes stack trace information by walking the arguments.caller\n     * chain at the time the exception occurred. This will cause earlier\n     * frames to be missed but is the only way to get any stack trace in\n     * Safari and IE. The top frame is restored by\n     * {@link augmentStackTraceWithInitialElement}.\n     * @param {Error} ex\n     * @return {TraceKit.StackTrace=} Stack trace information.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function computeStackTraceByWalkingCallerChain(ex, depth) {\n        var functionName = /function\\s+([_$a-zA-Z\\xA0-\\uFFFF][_$a-zA-Z0-9\\xA0-\\uFFFF]*)?\\s*\\(/i,\n            stack = [],\n            funcs = {},\n            recursion = false,\n            parts,\n            item,\n            source;\n\n        for (var curr = computeStackTraceByWalkingCallerChain.caller; curr && !recursion; curr = curr.caller) {\n            if (curr === computeStackTrace || curr === TraceKit.report) {\n                continue;\n            }\n\n            item = {\n                'url': null,\n                'func': UNKNOWN_FUNCTION,\n                'args': [],\n                'line': null,\n                'column': null\n            };\n\n            if (curr.name) {\n                item.func = curr.name;\n            } else if ((parts = functionName.exec(curr.toString()))) {\n                item.func = parts[1];\n            }\n\n            if (typeof item.func === 'undefined') {\n              try {\n                item.func = parts.input.substring(0, parts.input.indexOf('{'));\n              } catch (e) { }\n            }\n\n            if ((source = findSourceByFunctionBody(curr))) {\n                item.url = source.url;\n                item.line = source.line;\n\n                if (item.func === UNKNOWN_FUNCTION) {\n                    item.func = guessFunctionName(item.url, item.line);\n                }\n\n                var reference = / '([^']+)' /.exec(ex.message || ex.description);\n                if (reference) {\n                    item.column = findSourceInLine(reference[1], source.url, source.line);\n                }\n            }\n\n            if (funcs['' + curr]) {\n                recursion = true;\n            }else{\n                funcs['' + curr] = true;\n            }\n\n            stack.push(item);\n        }\n\n        if (depth) {\n            stack.splice(0, depth);\n        }\n\n        var result = {\n            'mode': 'callers',\n            'name': ex.name,\n            'message': ex.message,\n            'stack': stack\n        };\n        augmentStackTraceWithInitialElement(result, ex.sourceURL || ex.fileName, ex.line || ex.lineNumber, ex.message || ex.description);\n        return result;\n    }\n\n    /**\n     * Computes a stack trace for an exception.\n     * @param {Error} ex\n     * @param {(string|number)=} depth\n     * @memberof TraceKit.computeStackTrace\n     */\n    function computeStackTrace(ex, depth) {\n        var stack = null;\n        depth = (depth == null ? 0 : +depth);\n\n        try {\n            // This must be tried first because Opera 10 *destroys*\n            // its stacktrace property if you try to access the stack\n            // property first!!\n            stack = computeStackTraceFromStacktraceProp(ex);\n            if (stack) {\n                return stack;\n            }\n        } catch (e) {\n            if (debug) {\n                throw e;\n            }\n        }\n\n        try {\n            stack = computeStackTraceFromStackProp(ex);\n            if (stack) {\n                return stack;\n            }\n        } catch (e) {\n            if (debug) {\n                throw e;\n            }\n        }\n\n        try {\n            stack = computeStackTraceFromOperaMultiLineMessage(ex);\n            if (stack) {\n                return stack;\n            }\n        } catch (e) {\n            if (debug) {\n                throw e;\n            }\n        }\n\n        try {\n            stack = computeStackTraceByWalkingCallerChain(ex, depth + 1);\n            if (stack) {\n                return stack;\n            }\n        } catch (e) {\n            if (debug) {\n                throw e;\n            }\n        }\n\n        return {\n            'name': ex.name,\n            'message': ex.message,\n            'mode': 'failed'\n        };\n    }\n\n    /**\n     * Logs a stacktrace starting from the previous call and working down.\n     * @param {(number|string)=} depth How many frames deep to trace.\n     * @return {TraceKit.StackTrace} Stack trace information.\n     * @memberof TraceKit.computeStackTrace\n     */\n    function computeStackTraceOfCaller(depth) {\n        depth = (depth == null ? 0 : +depth) + 1; // \"+ 1\" because \"ofCaller\" should drop one frame\n        try {\n            throw new Error();\n        } catch (ex) {\n            return computeStackTrace(ex, depth + 1);\n        }\n    }\n\n    computeStackTrace.augmentStackTraceWithInitialElement = augmentStackTraceWithInitialElement;\n    computeStackTrace.computeStackTraceFromStackProp = computeStackTraceFromStackProp;\n    computeStackTrace.guessFunctionName = guessFunctionName;\n    computeStackTrace.gatherContext = gatherContext;\n    computeStackTrace.ofCaller = computeStackTraceOfCaller;\n    computeStackTrace.getSource = getSource;\n\n    return computeStackTrace;\n}());\n\n/**\n * Extends support for global error handling for asynchronous browser\n * functions. Adopted from Closure Library's errorhandler.js\n * @memberof TraceKit\n */\nTraceKit.extendToAsynchronousCallbacks = function () {\n    var _helper = function _helper(fnName) {\n        var originalFn = window[fnName];\n        window[fnName] = function traceKitAsyncExtension() {\n            // Make a copy of the arguments\n            var args = _slice.call(arguments);\n            var originalCallback = args[0];\n            if (typeof (originalCallback) === 'function') {\n                args[0] = TraceKit.wrap(originalCallback);\n            }\n            // IE < 9 doesn't support .call/.apply on setInterval/setTimeout, but it\n            // also only supports 2 argument and doesn't care what \"this\" is, so we\n            // can just call the original function directly.\n            if (originalFn.apply) {\n                return originalFn.apply(this, args);\n            } else {\n                return originalFn(args[0], args[1]);\n            }\n        };\n    };\n\n    _helper('setTimeout');\n    _helper('setInterval');\n};\n\n//Default options:\nif (!TraceKit.remoteFetching) {\n    TraceKit.remoteFetching = true;\n}\nif (!TraceKit.collectWindowErrors) {\n    TraceKit.collectWindowErrors = true;\n}\nif (!TraceKit.linesOfContext || TraceKit.linesOfContext < 1) {\n    // 5 lines before, the offending line, 5 lines after\n    TraceKit.linesOfContext = 11;\n}\n\n// UMD export\nif (typeof define === 'function' && define.amd) {\n    define('TraceKit', [], TraceKit);\n} else if (typeof module !== 'undefined' && module.exports && window.module !== module) {\n    module.exports = TraceKit;\n} else {\n    window.TraceKit = TraceKit;\n}\n\n}(typeof window !== 'undefined' ? window : global));\n", null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, "var NodeType;\r\n(function (NodeType) {\r\n    NodeType[NodeType[\"Document\"] = 0] = \"Document\";\r\n    NodeType[NodeType[\"DocumentType\"] = 1] = \"DocumentType\";\r\n    NodeType[NodeType[\"Element\"] = 2] = \"Element\";\r\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\r\n    NodeType[NodeType[\"CDATA\"] = 4] = \"CDATA\";\r\n    NodeType[NodeType[\"Comment\"] = 5] = \"Comment\";\r\n})(NodeType || (NodeType = {}));\n\nfunction isElement(n) {\r\n    return n.nodeType === n.ELEMENT_NODE;\r\n}\r\nfunction isShadowRoot(n) {\r\n    var host = n === null || n === void 0 ? void 0 : n.host;\r\n    return Boolean((host === null || host === void 0 ? void 0 : host.shadowRoot) === n);\r\n}\r\nfunction isNativeShadowDom(shadowRoot) {\r\n    return Object.prototype.toString.call(shadowRoot) === '[object ShadowRoot]';\r\n}\r\nfunction fixBrowserCompatibilityIssuesInCSS(cssText) {\r\n    if (cssText.includes(' background-clip: text;') &&\r\n        !cssText.includes(' -webkit-background-clip: text;')) {\r\n        cssText = cssText.replace(' background-clip: text;', ' -webkit-background-clip: text; background-clip: text;');\r\n    }\r\n    return cssText;\r\n}\r\nfunction getCssRulesString(s) {\r\n    try {\r\n        var rules = s.rules || s.cssRules;\r\n        return rules\r\n            ? fixBrowserCompatibilityIssuesInCSS(Array.from(rules).map(getCssRuleString).join(''))\r\n            : null;\r\n    }\r\n    catch (error) {\r\n        return null;\r\n    }\r\n}\r\nfunction getCssRuleString(rule) {\r\n    var cssStringified = rule.cssText;\r\n    if (isCSSImportRule(rule)) {\r\n        try {\r\n            cssStringified = getCssRulesString(rule.styleSheet) || cssStringified;\r\n        }\r\n        catch (_a) {\r\n        }\r\n    }\r\n    return cssStringified;\r\n}\r\nfunction isCSSImportRule(rule) {\r\n    return 'styleSheet' in rule;\r\n}\r\nvar Mirror = (function () {\r\n    function Mirror() {\r\n        this.idNodeMap = new Map();\r\n        this.nodeMetaMap = new WeakMap();\r\n    }\r\n    Mirror.prototype.getId = function (n) {\r\n        var _a;\r\n        if (!n)\r\n            return -1;\r\n        var id = (_a = this.getMeta(n)) === null || _a === void 0 ? void 0 : _a.id;\r\n        return id !== null && id !== void 0 ? id : -1;\r\n    };\r\n    Mirror.prototype.getNode = function (id) {\r\n        return this.idNodeMap.get(id) || null;\r\n    };\r\n    Mirror.prototype.getIds = function () {\r\n        return Array.from(this.idNodeMap.keys());\r\n    };\r\n    Mirror.prototype.getMeta = function (n) {\r\n        return this.nodeMetaMap.get(n) || null;\r\n    };\r\n    Mirror.prototype.removeNodeFromMap = function (n) {\r\n        var _this = this;\r\n        var id = this.getId(n);\r\n        this.idNodeMap[\"delete\"](id);\r\n        if (n.childNodes) {\r\n            n.childNodes.forEach(function (childNode) {\r\n                return _this.removeNodeFromMap(childNode);\r\n            });\r\n        }\r\n    };\r\n    Mirror.prototype.has = function (id) {\r\n        return this.idNodeMap.has(id);\r\n    };\r\n    Mirror.prototype.hasNode = function (node) {\r\n        return this.nodeMetaMap.has(node);\r\n    };\r\n    Mirror.prototype.add = function (n, meta) {\r\n        var id = meta.id;\r\n        this.idNodeMap.set(id, n);\r\n        this.nodeMetaMap.set(n, meta);\r\n    };\r\n    Mirror.prototype.replace = function (id, n) {\r\n        var oldNode = this.getNode(id);\r\n        if (oldNode) {\r\n            var meta = this.nodeMetaMap.get(oldNode);\r\n            if (meta)\r\n                this.nodeMetaMap.set(n, meta);\r\n        }\r\n        this.idNodeMap.set(id, n);\r\n    };\r\n    Mirror.prototype.reset = function () {\r\n        this.idNodeMap = new Map();\r\n        this.nodeMetaMap = new WeakMap();\r\n    };\r\n    return Mirror;\r\n}());\r\nfunction createMirror() {\r\n    return new Mirror();\r\n}\r\nfunction maskInputValue(_a) {\r\n    var maskInputOptions = _a.maskInputOptions, tagName = _a.tagName, type = _a.type, value = _a.value, maskInputFn = _a.maskInputFn;\r\n    var text = value || '';\r\n    if (maskInputOptions[tagName.toLowerCase()] ||\r\n        maskInputOptions[type]) {\r\n        if (maskInputFn) {\r\n            text = maskInputFn(text);\r\n        }\r\n        else {\r\n            text = '*'.repeat(text.length);\r\n        }\r\n    }\r\n    return text;\r\n}\r\nvar ORIGINAL_ATTRIBUTE_NAME = '__rrweb_original__';\r\nfunction is2DCanvasBlank(canvas) {\r\n    var ctx = canvas.getContext('2d');\r\n    if (!ctx)\r\n        return true;\r\n    var chunkSize = 50;\r\n    for (var x = 0; x < canvas.width; x += chunkSize) {\r\n        for (var y = 0; y < canvas.height; y += chunkSize) {\r\n            var getImageData = ctx.getImageData;\r\n            var originalGetImageData = ORIGINAL_ATTRIBUTE_NAME in getImageData\r\n                ? getImageData[ORIGINAL_ATTRIBUTE_NAME]\r\n                : getImageData;\r\n            var pixelBuffer = new Uint32Array(originalGetImageData.call(ctx, x, y, Math.min(chunkSize, canvas.width - x), Math.min(chunkSize, canvas.height - y)).data.buffer);\r\n            if (pixelBuffer.some(function (pixel) { return pixel !== 0; }))\r\n                return false;\r\n        }\r\n    }\r\n    return true;\r\n}\n\nvar _id = 1;\r\nvar tagNameRegex = new RegExp('[^a-z0-9-_:]');\r\nvar IGNORED_NODE = -2;\r\nfunction genId() {\r\n    return _id++;\r\n}\r\nfunction getValidTagName(element) {\r\n    if (element instanceof HTMLFormElement) {\r\n        return 'form';\r\n    }\r\n    var processedTagName = element.tagName.toLowerCase().trim();\r\n    if (tagNameRegex.test(processedTagName)) {\r\n        return 'div';\r\n    }\r\n    return processedTagName;\r\n}\r\nfunction stringifyStyleSheet(sheet) {\r\n    return sheet.cssRules\r\n        ? Array.from(sheet.cssRules)\r\n            .map(function (rule) { return rule.cssText || ''; })\r\n            .join('')\r\n        : '';\r\n}\r\nfunction extractOrigin(url) {\r\n    var origin = '';\r\n    if (url.indexOf('//') > -1) {\r\n        origin = url.split('/').slice(0, 3).join('/');\r\n    }\r\n    else {\r\n        origin = url.split('/')[0];\r\n    }\r\n    origin = origin.split('?')[0];\r\n    return origin;\r\n}\r\nvar canvasService;\r\nvar canvasCtx;\r\nvar URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")(.*?)\"|([^)]*))\\)/gm;\r\nvar RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/|#).*/;\r\nvar DATA_URI = /^(data:)([^,]*),(.*)/i;\r\nfunction absoluteToStylesheet(cssText, href) {\r\n    return (cssText || '').replace(URL_IN_CSS_REF, function (origin, quote1, path1, quote2, path2, path3) {\r\n        var filePath = path1 || path2 || path3;\r\n        var maybeQuote = quote1 || quote2 || '';\r\n        if (!filePath) {\r\n            return origin;\r\n        }\r\n        if (!RELATIVE_PATH.test(filePath)) {\r\n            return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\r\n        }\r\n        if (DATA_URI.test(filePath)) {\r\n            return \"url(\".concat(maybeQuote).concat(filePath).concat(maybeQuote, \")\");\r\n        }\r\n        if (filePath[0] === '/') {\r\n            return \"url(\".concat(maybeQuote).concat(extractOrigin(href) + filePath).concat(maybeQuote, \")\");\r\n        }\r\n        var stack = href.split('/');\r\n        var parts = filePath.split('/');\r\n        stack.pop();\r\n        for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\r\n            var part = parts_1[_i];\r\n            if (part === '.') {\r\n                continue;\r\n            }\r\n            else if (part === '..') {\r\n                stack.pop();\r\n            }\r\n            else {\r\n                stack.push(part);\r\n            }\r\n        }\r\n        return \"url(\".concat(maybeQuote).concat(stack.join('/')).concat(maybeQuote, \")\");\r\n    });\r\n}\r\nvar SRCSET_NOT_SPACES = /^[^ \\t\\n\\r\\u000c]+/;\r\nvar SRCSET_COMMAS_OR_SPACES = /^[, \\t\\n\\r\\u000c]+/;\r\nfunction getAbsoluteSrcsetString(doc, attributeValue) {\r\n    if (attributeValue.trim() === '') {\r\n        return attributeValue;\r\n    }\r\n    var pos = 0;\r\n    function collectCharacters(regEx) {\r\n        var chars;\r\n        var match = regEx.exec(attributeValue.substring(pos));\r\n        if (match) {\r\n            chars = match[0];\r\n            pos += chars.length;\r\n            return chars;\r\n        }\r\n        return '';\r\n    }\r\n    var output = [];\r\n    while (true) {\r\n        collectCharacters(SRCSET_COMMAS_OR_SPACES);\r\n        if (pos >= attributeValue.length) {\r\n            break;\r\n        }\r\n        var url = collectCharacters(SRCSET_NOT_SPACES);\r\n        if (url.slice(-1) === ',') {\r\n            url = absoluteToDoc(doc, url.substring(0, url.length - 1));\r\n            output.push(url);\r\n        }\r\n        else {\r\n            var descriptorsStr = '';\r\n            url = absoluteToDoc(doc, url);\r\n            var inParens = false;\r\n            while (true) {\r\n                var c = attributeValue.charAt(pos);\r\n                if (c === '') {\r\n                    output.push((url + descriptorsStr).trim());\r\n                    break;\r\n                }\r\n                else if (!inParens) {\r\n                    if (c === ',') {\r\n                        pos += 1;\r\n                        output.push((url + descriptorsStr).trim());\r\n                        break;\r\n                    }\r\n                    else if (c === '(') {\r\n                        inParens = true;\r\n                    }\r\n                }\r\n                else {\r\n                    if (c === ')') {\r\n                        inParens = false;\r\n                    }\r\n                }\r\n                descriptorsStr += c;\r\n                pos += 1;\r\n            }\r\n        }\r\n    }\r\n    return output.join(', ');\r\n}\r\nfunction absoluteToDoc(doc, attributeValue) {\r\n    if (!attributeValue || attributeValue.trim() === '') {\r\n        return attributeValue;\r\n    }\r\n    var a = doc.createElement('a');\r\n    a.href = attributeValue;\r\n    return a.href;\r\n}\r\nfunction isSVGElement(el) {\r\n    return Boolean(el.tagName === 'svg' || el.ownerSVGElement);\r\n}\r\nfunction getHref() {\r\n    var a = document.createElement('a');\r\n    a.href = '';\r\n    return a.href;\r\n}\r\nfunction transformAttribute(doc, tagName, name, value) {\r\n    if (name === 'src' ||\r\n        (name === 'href' && value && !(tagName === 'use' && value[0] === '#'))) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'xlink:href' && value && value[0] !== '#') {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'background' &&\r\n        value &&\r\n        (tagName === 'table' || tagName === 'td' || tagName === 'th')) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else if (name === 'srcset' && value) {\r\n        return getAbsoluteSrcsetString(doc, value);\r\n    }\r\n    else if (name === 'style' && value) {\r\n        return absoluteToStylesheet(value, getHref());\r\n    }\r\n    else if (tagName === 'object' && name === 'data' && value) {\r\n        return absoluteToDoc(doc, value);\r\n    }\r\n    else {\r\n        return value;\r\n    }\r\n}\r\nfunction _isBlockedElement(element, blockClass, blockSelector) {\r\n    if (typeof blockClass === 'string') {\r\n        if (element.classList.contains(blockClass)) {\r\n            return true;\r\n        }\r\n    }\r\n    else {\r\n        for (var eIndex = element.classList.length; eIndex--;) {\r\n            var className = element.classList[eIndex];\r\n            if (blockClass.test(className)) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    if (blockSelector) {\r\n        return element.matches(blockSelector);\r\n    }\r\n    return false;\r\n}\r\nfunction classMatchesRegex(node, regex, checkAncestors) {\r\n    if (!node)\r\n        return false;\r\n    if (node.nodeType !== node.ELEMENT_NODE) {\r\n        if (!checkAncestors)\r\n            return false;\r\n        return classMatchesRegex(node.parentNode, regex, checkAncestors);\r\n    }\r\n    for (var eIndex = node.classList.length; eIndex--;) {\r\n        var className = node.classList[eIndex];\r\n        if (regex.test(className)) {\r\n            return true;\r\n        }\r\n    }\r\n    if (!checkAncestors)\r\n        return false;\r\n    return classMatchesRegex(node.parentNode, regex, checkAncestors);\r\n}\r\nfunction needMaskingText(node, maskTextClass, maskTextSelector) {\r\n    var el = node.nodeType === node.ELEMENT_NODE\r\n        ? node\r\n        : node.parentElement;\r\n    if (el === null)\r\n        return false;\r\n    if (typeof maskTextClass === 'string') {\r\n        if (el.classList.contains(maskTextClass))\r\n            return true;\r\n        if (el.closest(\".\".concat(maskTextClass)))\r\n            return true;\r\n    }\r\n    else {\r\n        if (classMatchesRegex(el, maskTextClass, true))\r\n            return true;\r\n    }\r\n    if (maskTextSelector) {\r\n        if (el.matches(maskTextSelector))\r\n            return true;\r\n        if (el.closest(maskTextSelector))\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\nfunction onceIframeLoaded(iframeEl, listener, iframeLoadTimeout) {\r\n    var win = iframeEl.contentWindow;\r\n    if (!win) {\r\n        return;\r\n    }\r\n    var fired = false;\r\n    var readyState;\r\n    try {\r\n        readyState = win.document.readyState;\r\n    }\r\n    catch (error) {\r\n        return;\r\n    }\r\n    if (readyState !== 'complete') {\r\n        var timer_1 = setTimeout(function () {\r\n            if (!fired) {\r\n                listener();\r\n                fired = true;\r\n            }\r\n        }, iframeLoadTimeout);\r\n        iframeEl.addEventListener('load', function () {\r\n            clearTimeout(timer_1);\r\n            fired = true;\r\n            listener();\r\n        });\r\n        return;\r\n    }\r\n    var blankUrl = 'about:blank';\r\n    if (win.location.href !== blankUrl ||\r\n        iframeEl.src === blankUrl ||\r\n        iframeEl.src === '') {\r\n        setTimeout(listener, 0);\r\n        return iframeEl.addEventListener('load', listener);\r\n    }\r\n    iframeEl.addEventListener('load', listener);\r\n}\r\nfunction onceStylesheetLoaded(link, listener, styleSheetLoadTimeout) {\r\n    var fired = false;\r\n    var styleSheetLoaded;\r\n    try {\r\n        styleSheetLoaded = link.sheet;\r\n    }\r\n    catch (error) {\r\n        return;\r\n    }\r\n    if (styleSheetLoaded)\r\n        return;\r\n    var timer = setTimeout(function () {\r\n        if (!fired) {\r\n            listener();\r\n            fired = true;\r\n        }\r\n    }, styleSheetLoadTimeout);\r\n    link.addEventListener('load', function () {\r\n        clearTimeout(timer);\r\n        fired = true;\r\n        listener();\r\n    });\r\n}\r\nfunction serializeNode(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, blockClass = options.blockClass, blockSelector = options.blockSelector, maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, inlineStylesheet = options.inlineStylesheet, _a = options.maskInputOptions, maskInputOptions = _a === void 0 ? {} : _a, maskTextFn = options.maskTextFn, maskInputFn = options.maskInputFn, _b = options.dataURLOptions, dataURLOptions = _b === void 0 ? {} : _b, inlineImages = options.inlineImages, recordCanvas = options.recordCanvas, keepIframeSrcFn = options.keepIframeSrcFn, _c = options.newlyAddedElement, newlyAddedElement = _c === void 0 ? false : _c;\r\n    var rootId = getRootId(doc, mirror);\r\n    switch (n.nodeType) {\r\n        case n.DOCUMENT_NODE:\r\n            if (n.compatMode !== 'CSS1Compat') {\r\n                return {\r\n                    type: NodeType.Document,\r\n                    childNodes: [],\r\n                    compatMode: n.compatMode\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    type: NodeType.Document,\r\n                    childNodes: []\r\n                };\r\n            }\r\n        case n.DOCUMENT_TYPE_NODE:\r\n            return {\r\n                type: NodeType.DocumentType,\r\n                name: n.name,\r\n                publicId: n.publicId,\r\n                systemId: n.systemId,\r\n                rootId: rootId\r\n            };\r\n        case n.ELEMENT_NODE:\r\n            return serializeElementNode(n, {\r\n                doc: doc,\r\n                blockClass: blockClass,\r\n                blockSelector: blockSelector,\r\n                inlineStylesheet: inlineStylesheet,\r\n                maskInputOptions: maskInputOptions,\r\n                maskInputFn: maskInputFn,\r\n                dataURLOptions: dataURLOptions,\r\n                inlineImages: inlineImages,\r\n                recordCanvas: recordCanvas,\r\n                keepIframeSrcFn: keepIframeSrcFn,\r\n                newlyAddedElement: newlyAddedElement,\r\n                rootId: rootId\r\n            });\r\n        case n.TEXT_NODE:\r\n            return serializeTextNode(n, {\r\n                maskTextClass: maskTextClass,\r\n                maskTextSelector: maskTextSelector,\r\n                maskTextFn: maskTextFn,\r\n                rootId: rootId\r\n            });\r\n        case n.CDATA_SECTION_NODE:\r\n            return {\r\n                type: NodeType.CDATA,\r\n                textContent: '',\r\n                rootId: rootId\r\n            };\r\n        case n.COMMENT_NODE:\r\n            return {\r\n                type: NodeType.Comment,\r\n                textContent: n.textContent || '',\r\n                rootId: rootId\r\n            };\r\n        default:\r\n            return false;\r\n    }\r\n}\r\nfunction getRootId(doc, mirror) {\r\n    if (!mirror.hasNode(doc))\r\n        return undefined;\r\n    var docId = mirror.getId(doc);\r\n    return docId === 1 ? undefined : docId;\r\n}\r\nfunction serializeTextNode(n, options) {\r\n    var _a;\r\n    var maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, maskTextFn = options.maskTextFn, rootId = options.rootId;\r\n    var parentTagName = n.parentNode && n.parentNode.tagName;\r\n    var textContent = n.textContent;\r\n    var isStyle = parentTagName === 'STYLE' ? true : undefined;\r\n    var isScript = parentTagName === 'SCRIPT' ? true : undefined;\r\n    if (isStyle && textContent) {\r\n        try {\r\n            if (n.nextSibling || n.previousSibling) {\r\n            }\r\n            else if ((_a = n.parentNode.sheet) === null || _a === void 0 ? void 0 : _a.cssRules) {\r\n                textContent = stringifyStyleSheet(n.parentNode.sheet);\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.warn(\"Cannot get CSS styles from text's parentNode. Error: \".concat(err), n);\r\n        }\r\n        textContent = absoluteToStylesheet(textContent, getHref());\r\n    }\r\n    if (isScript) {\r\n        textContent = 'SCRIPT_PLACEHOLDER';\r\n    }\r\n    if (!isStyle &&\r\n        !isScript &&\r\n        textContent &&\r\n        needMaskingText(n, maskTextClass, maskTextSelector)) {\r\n        textContent = maskTextFn\r\n            ? maskTextFn(textContent)\r\n            : textContent.replace(/[\\S]/g, '*');\r\n    }\r\n    return {\r\n        type: NodeType.Text,\r\n        textContent: textContent || '',\r\n        isStyle: isStyle,\r\n        rootId: rootId\r\n    };\r\n}\r\nfunction serializeElementNode(n, options) {\r\n    var doc = options.doc, blockClass = options.blockClass, blockSelector = options.blockSelector, inlineStylesheet = options.inlineStylesheet, _a = options.maskInputOptions, maskInputOptions = _a === void 0 ? {} : _a, maskInputFn = options.maskInputFn, _b = options.dataURLOptions, dataURLOptions = _b === void 0 ? {} : _b, inlineImages = options.inlineImages, recordCanvas = options.recordCanvas, keepIframeSrcFn = options.keepIframeSrcFn, _c = options.newlyAddedElement, newlyAddedElement = _c === void 0 ? false : _c, rootId = options.rootId;\r\n    var needBlock = _isBlockedElement(n, blockClass, blockSelector);\r\n    var tagName = getValidTagName(n);\r\n    var attributes = {};\r\n    var len = n.attributes.length;\r\n    for (var i = 0; i < len; i++) {\r\n        var attr = n.attributes[i];\r\n        attributes[attr.name] = transformAttribute(doc, tagName, attr.name, attr.value);\r\n    }\r\n    if (tagName === 'link' && inlineStylesheet) {\r\n        var stylesheet = Array.from(doc.styleSheets).find(function (s) {\r\n            return s.href === n.href;\r\n        });\r\n        var cssText = null;\r\n        if (stylesheet) {\r\n            cssText = getCssRulesString(stylesheet);\r\n        }\r\n        if (cssText) {\r\n            delete attributes.rel;\r\n            delete attributes.href;\r\n            attributes._cssText = absoluteToStylesheet(cssText, stylesheet.href);\r\n        }\r\n    }\r\n    if (tagName === 'style' &&\r\n        n.sheet &&\r\n        !(n.innerText || n.textContent || '').trim().length) {\r\n        var cssText = getCssRulesString(n.sheet);\r\n        if (cssText) {\r\n            attributes._cssText = absoluteToStylesheet(cssText, getHref());\r\n        }\r\n    }\r\n    if (tagName === 'input' || tagName === 'textarea' || tagName === 'select') {\r\n        var value = n.value;\r\n        var checked = n.checked;\r\n        if (attributes.type !== 'radio' &&\r\n            attributes.type !== 'checkbox' &&\r\n            attributes.type !== 'submit' &&\r\n            attributes.type !== 'button' &&\r\n            value) {\r\n            attributes.value = maskInputValue({\r\n                type: attributes.type,\r\n                tagName: tagName,\r\n                value: value,\r\n                maskInputOptions: maskInputOptions,\r\n                maskInputFn: maskInputFn\r\n            });\r\n        }\r\n        else if (checked) {\r\n            attributes.checked = checked;\r\n        }\r\n    }\r\n    if (tagName === 'option') {\r\n        if (n.selected && !maskInputOptions['select']) {\r\n            attributes.selected = true;\r\n        }\r\n        else {\r\n            delete attributes.selected;\r\n        }\r\n    }\r\n    if (tagName === 'canvas' && recordCanvas) {\r\n        if (n.__context === '2d') {\r\n            if (!is2DCanvasBlank(n)) {\r\n                attributes.rr_dataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            }\r\n        }\r\n        else if (!('__context' in n)) {\r\n            var canvasDataURL = n.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            var blankCanvas = document.createElement('canvas');\r\n            blankCanvas.width = n.width;\r\n            blankCanvas.height = n.height;\r\n            var blankCanvasDataURL = blankCanvas.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            if (canvasDataURL !== blankCanvasDataURL) {\r\n                attributes.rr_dataURL = canvasDataURL;\r\n            }\r\n        }\r\n    }\r\n    if (tagName === 'img' && inlineImages) {\r\n        if (!canvasService) {\r\n            canvasService = doc.createElement('canvas');\r\n            canvasCtx = canvasService.getContext('2d');\r\n        }\r\n        var image_1 = n;\r\n        var oldValue_1 = image_1.crossOrigin;\r\n        image_1.crossOrigin = 'anonymous';\r\n        var recordInlineImage = function () {\r\n            try {\r\n                canvasService.width = image_1.naturalWidth;\r\n                canvasService.height = image_1.naturalHeight;\r\n                canvasCtx.drawImage(image_1, 0, 0);\r\n                attributes.rr_dataURL = canvasService.toDataURL(dataURLOptions.type, dataURLOptions.quality);\r\n            }\r\n            catch (err) {\r\n                console.warn(\"Cannot inline img src=\".concat(image_1.currentSrc, \"! Error: \").concat(err));\r\n            }\r\n            oldValue_1\r\n                ? (attributes.crossOrigin = oldValue_1)\r\n                : image_1.removeAttribute('crossorigin');\r\n        };\r\n        if (image_1.complete && image_1.naturalWidth !== 0)\r\n            recordInlineImage();\r\n        else\r\n            image_1.onload = recordInlineImage;\r\n    }\r\n    if (tagName === 'audio' || tagName === 'video') {\r\n        attributes.rr_mediaState = n.paused\r\n            ? 'paused'\r\n            : 'played';\r\n        attributes.rr_mediaCurrentTime = n.currentTime;\r\n    }\r\n    if (!newlyAddedElement) {\r\n        if (n.scrollLeft) {\r\n            attributes.rr_scrollLeft = n.scrollLeft;\r\n        }\r\n        if (n.scrollTop) {\r\n            attributes.rr_scrollTop = n.scrollTop;\r\n        }\r\n    }\r\n    if (needBlock) {\r\n        var _d = n.getBoundingClientRect(), width = _d.width, height = _d.height;\r\n        attributes = {\r\n            \"class\": attributes[\"class\"],\r\n            rr_width: \"\".concat(width, \"px\"),\r\n            rr_height: \"\".concat(height, \"px\")\r\n        };\r\n    }\r\n    if (tagName === 'iframe' && !keepIframeSrcFn(attributes.src)) {\r\n        if (!n.contentDocument) {\r\n            attributes.rr_src = attributes.src;\r\n        }\r\n        delete attributes.src;\r\n    }\r\n    return {\r\n        type: NodeType.Element,\r\n        tagName: tagName,\r\n        attributes: attributes,\r\n        childNodes: [],\r\n        isSVG: isSVGElement(n) || undefined,\r\n        needBlock: needBlock,\r\n        rootId: rootId\r\n    };\r\n}\r\nfunction lowerIfExists(maybeAttr) {\r\n    if (maybeAttr === undefined) {\r\n        return '';\r\n    }\r\n    else {\r\n        return maybeAttr.toLowerCase();\r\n    }\r\n}\r\nfunction slimDOMExcluded(sn, slimDOMOptions) {\r\n    if (slimDOMOptions.comment && sn.type === NodeType.Comment) {\r\n        return true;\r\n    }\r\n    else if (sn.type === NodeType.Element) {\r\n        if (slimDOMOptions.script &&\r\n            (sn.tagName === 'script' ||\r\n                (sn.tagName === 'link' &&\r\n                    sn.attributes.rel === 'preload' &&\r\n                    sn.attributes.as === 'script') ||\r\n                (sn.tagName === 'link' &&\r\n                    sn.attributes.rel === 'prefetch' &&\r\n                    typeof sn.attributes.href === 'string' &&\r\n                    sn.attributes.href.endsWith('.js')))) {\r\n            return true;\r\n        }\r\n        else if (slimDOMOptions.headFavicon &&\r\n            ((sn.tagName === 'link' && sn.attributes.rel === 'shortcut icon') ||\r\n                (sn.tagName === 'meta' &&\r\n                    (lowerIfExists(sn.attributes.name).match(/^msapplication-tile(image|color)$/) ||\r\n                        lowerIfExists(sn.attributes.name) === 'application-name' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'icon' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'apple-touch-icon' ||\r\n                        lowerIfExists(sn.attributes.rel) === 'shortcut icon')))) {\r\n            return true;\r\n        }\r\n        else if (sn.tagName === 'meta') {\r\n            if (slimDOMOptions.headMetaDescKeywords &&\r\n                lowerIfExists(sn.attributes.name).match(/^description|keywords$/)) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaSocial &&\r\n                (lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/) ||\r\n                    lowerIfExists(sn.attributes.name).match(/^(og|twitter):/) ||\r\n                    lowerIfExists(sn.attributes.name) === 'pinterest')) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaRobots &&\r\n                (lowerIfExists(sn.attributes.name) === 'robots' ||\r\n                    lowerIfExists(sn.attributes.name) === 'googlebot' ||\r\n                    lowerIfExists(sn.attributes.name) === 'bingbot')) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaHttpEquiv &&\r\n                sn.attributes['http-equiv'] !== undefined) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaAuthorship &&\r\n                (lowerIfExists(sn.attributes.name) === 'author' ||\r\n                    lowerIfExists(sn.attributes.name) === 'generator' ||\r\n                    lowerIfExists(sn.attributes.name) === 'framework' ||\r\n                    lowerIfExists(sn.attributes.name) === 'publisher' ||\r\n                    lowerIfExists(sn.attributes.name) === 'progid' ||\r\n                    lowerIfExists(sn.attributes.property).match(/^article:/) ||\r\n                    lowerIfExists(sn.attributes.property).match(/^product:/))) {\r\n                return true;\r\n            }\r\n            else if (slimDOMOptions.headMetaVerification &&\r\n                (lowerIfExists(sn.attributes.name) === 'google-site-verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'yandex-verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'csrf-token' ||\r\n                    lowerIfExists(sn.attributes.name) === 'p:domain_verify' ||\r\n                    lowerIfExists(sn.attributes.name) === 'verify-v1' ||\r\n                    lowerIfExists(sn.attributes.name) === 'verification' ||\r\n                    lowerIfExists(sn.attributes.name) === 'shopify-checkout-api-token')) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction serializeNodeWithId(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, blockClass = options.blockClass, blockSelector = options.blockSelector, maskTextClass = options.maskTextClass, maskTextSelector = options.maskTextSelector, _a = options.skipChild, skipChild = _a === void 0 ? false : _a, _b = options.inlineStylesheet, inlineStylesheet = _b === void 0 ? true : _b, _c = options.maskInputOptions, maskInputOptions = _c === void 0 ? {} : _c, maskTextFn = options.maskTextFn, maskInputFn = options.maskInputFn, slimDOMOptions = options.slimDOMOptions, _d = options.dataURLOptions, dataURLOptions = _d === void 0 ? {} : _d, _e = options.inlineImages, inlineImages = _e === void 0 ? false : _e, _f = options.recordCanvas, recordCanvas = _f === void 0 ? false : _f, onSerialize = options.onSerialize, onIframeLoad = options.onIframeLoad, _g = options.iframeLoadTimeout, iframeLoadTimeout = _g === void 0 ? 5000 : _g, onStylesheetLoad = options.onStylesheetLoad, _h = options.stylesheetLoadTimeout, stylesheetLoadTimeout = _h === void 0 ? 5000 : _h, _j = options.keepIframeSrcFn, keepIframeSrcFn = _j === void 0 ? function () { return false; } : _j, _k = options.newlyAddedElement, newlyAddedElement = _k === void 0 ? false : _k;\r\n    var _l = options.preserveWhiteSpace, preserveWhiteSpace = _l === void 0 ? true : _l;\r\n    var _serializedNode = serializeNode(n, {\r\n        doc: doc,\r\n        mirror: mirror,\r\n        blockClass: blockClass,\r\n        blockSelector: blockSelector,\r\n        maskTextClass: maskTextClass,\r\n        maskTextSelector: maskTextSelector,\r\n        inlineStylesheet: inlineStylesheet,\r\n        maskInputOptions: maskInputOptions,\r\n        maskTextFn: maskTextFn,\r\n        maskInputFn: maskInputFn,\r\n        dataURLOptions: dataURLOptions,\r\n        inlineImages: inlineImages,\r\n        recordCanvas: recordCanvas,\r\n        keepIframeSrcFn: keepIframeSrcFn,\r\n        newlyAddedElement: newlyAddedElement\r\n    });\r\n    if (!_serializedNode) {\r\n        console.warn(n, 'not serialized');\r\n        return null;\r\n    }\r\n    var id;\r\n    if (mirror.hasNode(n)) {\r\n        id = mirror.getId(n);\r\n    }\r\n    else if (slimDOMExcluded(_serializedNode, slimDOMOptions) ||\r\n        (!preserveWhiteSpace &&\r\n            _serializedNode.type === NodeType.Text &&\r\n            !_serializedNode.isStyle &&\r\n            !_serializedNode.textContent.replace(/^\\s+|\\s+$/gm, '').length)) {\r\n        id = IGNORED_NODE;\r\n    }\r\n    else {\r\n        id = genId();\r\n    }\r\n    var serializedNode = Object.assign(_serializedNode, { id: id });\r\n    mirror.add(n, serializedNode);\r\n    if (id === IGNORED_NODE) {\r\n        return null;\r\n    }\r\n    if (onSerialize) {\r\n        onSerialize(n);\r\n    }\r\n    var recordChild = !skipChild;\r\n    if (serializedNode.type === NodeType.Element) {\r\n        recordChild = recordChild && !serializedNode.needBlock;\r\n        delete serializedNode.needBlock;\r\n        var shadowRoot = n.shadowRoot;\r\n        if (shadowRoot && isNativeShadowDom(shadowRoot))\r\n            serializedNode.isShadowHost = true;\r\n    }\r\n    if ((serializedNode.type === NodeType.Document ||\r\n        serializedNode.type === NodeType.Element) &&\r\n        recordChild) {\r\n        if (slimDOMOptions.headWhitespace &&\r\n            serializedNode.type === NodeType.Element &&\r\n            serializedNode.tagName === 'head') {\r\n            preserveWhiteSpace = false;\r\n        }\r\n        var bypassOptions = {\r\n            doc: doc,\r\n            mirror: mirror,\r\n            blockClass: blockClass,\r\n            blockSelector: blockSelector,\r\n            maskTextClass: maskTextClass,\r\n            maskTextSelector: maskTextSelector,\r\n            skipChild: skipChild,\r\n            inlineStylesheet: inlineStylesheet,\r\n            maskInputOptions: maskInputOptions,\r\n            maskTextFn: maskTextFn,\r\n            maskInputFn: maskInputFn,\r\n            slimDOMOptions: slimDOMOptions,\r\n            dataURLOptions: dataURLOptions,\r\n            inlineImages: inlineImages,\r\n            recordCanvas: recordCanvas,\r\n            preserveWhiteSpace: preserveWhiteSpace,\r\n            onSerialize: onSerialize,\r\n            onIframeLoad: onIframeLoad,\r\n            iframeLoadTimeout: iframeLoadTimeout,\r\n            onStylesheetLoad: onStylesheetLoad,\r\n            stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n            keepIframeSrcFn: keepIframeSrcFn\r\n        };\r\n        for (var _i = 0, _m = Array.from(n.childNodes); _i < _m.length; _i++) {\r\n            var childN = _m[_i];\r\n            var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\r\n            if (serializedChildNode) {\r\n                serializedNode.childNodes.push(serializedChildNode);\r\n            }\r\n        }\r\n        if (isElement(n) && n.shadowRoot) {\r\n            for (var _o = 0, _p = Array.from(n.shadowRoot.childNodes); _o < _p.length; _o++) {\r\n                var childN = _p[_o];\r\n                var serializedChildNode = serializeNodeWithId(childN, bypassOptions);\r\n                if (serializedChildNode) {\r\n                    isNativeShadowDom(n.shadowRoot) &&\r\n                        (serializedChildNode.isShadow = true);\r\n                    serializedNode.childNodes.push(serializedChildNode);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (n.parentNode &&\r\n        isShadowRoot(n.parentNode) &&\r\n        isNativeShadowDom(n.parentNode)) {\r\n        serializedNode.isShadow = true;\r\n    }\r\n    if (serializedNode.type === NodeType.Element &&\r\n        serializedNode.tagName === 'iframe') {\r\n        onceIframeLoaded(n, function () {\r\n            var iframeDoc = n.contentDocument;\r\n            if (iframeDoc && onIframeLoad) {\r\n                var serializedIframeNode = serializeNodeWithId(iframeDoc, {\r\n                    doc: iframeDoc,\r\n                    mirror: mirror,\r\n                    blockClass: blockClass,\r\n                    blockSelector: blockSelector,\r\n                    maskTextClass: maskTextClass,\r\n                    maskTextSelector: maskTextSelector,\r\n                    skipChild: false,\r\n                    inlineStylesheet: inlineStylesheet,\r\n                    maskInputOptions: maskInputOptions,\r\n                    maskTextFn: maskTextFn,\r\n                    maskInputFn: maskInputFn,\r\n                    slimDOMOptions: slimDOMOptions,\r\n                    dataURLOptions: dataURLOptions,\r\n                    inlineImages: inlineImages,\r\n                    recordCanvas: recordCanvas,\r\n                    preserveWhiteSpace: preserveWhiteSpace,\r\n                    onSerialize: onSerialize,\r\n                    onIframeLoad: onIframeLoad,\r\n                    iframeLoadTimeout: iframeLoadTimeout,\r\n                    onStylesheetLoad: onStylesheetLoad,\r\n                    stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n                    keepIframeSrcFn: keepIframeSrcFn\r\n                });\r\n                if (serializedIframeNode) {\r\n                    onIframeLoad(n, serializedIframeNode);\r\n                }\r\n            }\r\n        }, iframeLoadTimeout);\r\n    }\r\n    if (serializedNode.type === NodeType.Element &&\r\n        serializedNode.tagName === 'link' &&\r\n        serializedNode.attributes.rel === 'stylesheet') {\r\n        onceStylesheetLoaded(n, function () {\r\n            if (onStylesheetLoad) {\r\n                var serializedLinkNode = serializeNodeWithId(n, {\r\n                    doc: doc,\r\n                    mirror: mirror,\r\n                    blockClass: blockClass,\r\n                    blockSelector: blockSelector,\r\n                    maskTextClass: maskTextClass,\r\n                    maskTextSelector: maskTextSelector,\r\n                    skipChild: false,\r\n                    inlineStylesheet: inlineStylesheet,\r\n                    maskInputOptions: maskInputOptions,\r\n                    maskTextFn: maskTextFn,\r\n                    maskInputFn: maskInputFn,\r\n                    slimDOMOptions: slimDOMOptions,\r\n                    dataURLOptions: dataURLOptions,\r\n                    inlineImages: inlineImages,\r\n                    recordCanvas: recordCanvas,\r\n                    preserveWhiteSpace: preserveWhiteSpace,\r\n                    onSerialize: onSerialize,\r\n                    onIframeLoad: onIframeLoad,\r\n                    iframeLoadTimeout: iframeLoadTimeout,\r\n                    onStylesheetLoad: onStylesheetLoad,\r\n                    stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n                    keepIframeSrcFn: keepIframeSrcFn\r\n                });\r\n                if (serializedLinkNode) {\r\n                    onStylesheetLoad(n, serializedLinkNode);\r\n                }\r\n            }\r\n        }, stylesheetLoadTimeout);\r\n    }\r\n    return serializedNode;\r\n}\r\nfunction snapshot(n, options) {\r\n    var _a = options || {}, _b = _a.mirror, mirror = _b === void 0 ? new Mirror() : _b, _c = _a.blockClass, blockClass = _c === void 0 ? 'rr-block' : _c, _d = _a.blockSelector, blockSelector = _d === void 0 ? null : _d, _e = _a.maskTextClass, maskTextClass = _e === void 0 ? 'rr-mask' : _e, _f = _a.maskTextSelector, maskTextSelector = _f === void 0 ? null : _f, _g = _a.inlineStylesheet, inlineStylesheet = _g === void 0 ? true : _g, _h = _a.inlineImages, inlineImages = _h === void 0 ? false : _h, _j = _a.recordCanvas, recordCanvas = _j === void 0 ? false : _j, _k = _a.maskAllInputs, maskAllInputs = _k === void 0 ? false : _k, maskTextFn = _a.maskTextFn, maskInputFn = _a.maskInputFn, _l = _a.slimDOM, slimDOM = _l === void 0 ? false : _l, dataURLOptions = _a.dataURLOptions, preserveWhiteSpace = _a.preserveWhiteSpace, onSerialize = _a.onSerialize, onIframeLoad = _a.onIframeLoad, iframeLoadTimeout = _a.iframeLoadTimeout, onStylesheetLoad = _a.onStylesheetLoad, stylesheetLoadTimeout = _a.stylesheetLoadTimeout, _m = _a.keepIframeSrcFn, keepIframeSrcFn = _m === void 0 ? function () { return false; } : _m;\r\n    var maskInputOptions = maskAllInputs === true\r\n        ? {\r\n            color: true,\r\n            date: true,\r\n            'datetime-local': true,\r\n            email: true,\r\n            month: true,\r\n            number: true,\r\n            range: true,\r\n            search: true,\r\n            tel: true,\r\n            text: true,\r\n            time: true,\r\n            url: true,\r\n            week: true,\r\n            textarea: true,\r\n            select: true,\r\n            password: true\r\n        }\r\n        : maskAllInputs === false\r\n            ? {\r\n                password: true\r\n            }\r\n            : maskAllInputs;\r\n    var slimDOMOptions = slimDOM === true || slimDOM === 'all'\r\n        ?\r\n            {\r\n                script: true,\r\n                comment: true,\r\n                headFavicon: true,\r\n                headWhitespace: true,\r\n                headMetaDescKeywords: slimDOM === 'all',\r\n                headMetaSocial: true,\r\n                headMetaRobots: true,\r\n                headMetaHttpEquiv: true,\r\n                headMetaAuthorship: true,\r\n                headMetaVerification: true\r\n            }\r\n        : slimDOM === false\r\n            ? {}\r\n            : slimDOM;\r\n    return serializeNodeWithId(n, {\r\n        doc: n,\r\n        mirror: mirror,\r\n        blockClass: blockClass,\r\n        blockSelector: blockSelector,\r\n        maskTextClass: maskTextClass,\r\n        maskTextSelector: maskTextSelector,\r\n        skipChild: false,\r\n        inlineStylesheet: inlineStylesheet,\r\n        maskInputOptions: maskInputOptions,\r\n        maskTextFn: maskTextFn,\r\n        maskInputFn: maskInputFn,\r\n        slimDOMOptions: slimDOMOptions,\r\n        dataURLOptions: dataURLOptions,\r\n        inlineImages: inlineImages,\r\n        recordCanvas: recordCanvas,\r\n        preserveWhiteSpace: preserveWhiteSpace,\r\n        onSerialize: onSerialize,\r\n        onIframeLoad: onIframeLoad,\r\n        iframeLoadTimeout: iframeLoadTimeout,\r\n        onStylesheetLoad: onStylesheetLoad,\r\n        stylesheetLoadTimeout: stylesheetLoadTimeout,\r\n        keepIframeSrcFn: keepIframeSrcFn,\r\n        newlyAddedElement: false\r\n    });\r\n}\r\n\nvar commentre = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\r\nfunction parse(css, options) {\r\n    if (options === void 0) { options = {}; }\r\n    var lineno = 1;\r\n    var column = 1;\r\n    function updatePosition(str) {\r\n        var lines = str.match(/\\n/g);\r\n        if (lines) {\r\n            lineno += lines.length;\r\n        }\r\n        var i = str.lastIndexOf('\\n');\r\n        column = i === -1 ? column + str.length : str.length - i;\r\n    }\r\n    function position() {\r\n        var start = { line: lineno, column: column };\r\n        return function (node) {\r\n            node.position = new Position(start);\r\n            whitespace();\r\n            return node;\r\n        };\r\n    }\r\n    var Position = (function () {\r\n        function Position(start) {\r\n            this.start = start;\r\n            this.end = { line: lineno, column: column };\r\n            this.source = options.source;\r\n        }\r\n        return Position;\r\n    }());\r\n    Position.prototype.content = css;\r\n    var errorsList = [];\r\n    function error(msg) {\r\n        var err = new Error(\"\".concat(options.source || '', \":\").concat(lineno, \":\").concat(column, \": \").concat(msg));\r\n        err.reason = msg;\r\n        err.filename = options.source;\r\n        err.line = lineno;\r\n        err.column = column;\r\n        err.source = css;\r\n        if (options.silent) {\r\n            errorsList.push(err);\r\n        }\r\n        else {\r\n            throw err;\r\n        }\r\n    }\r\n    function stylesheet() {\r\n        var rulesList = rules();\r\n        return {\r\n            type: 'stylesheet',\r\n            stylesheet: {\r\n                source: options.source,\r\n                rules: rulesList,\r\n                parsingErrors: errorsList\r\n            }\r\n        };\r\n    }\r\n    function open() {\r\n        return match(/^{\\s*/);\r\n    }\r\n    function close() {\r\n        return match(/^}/);\r\n    }\r\n    function rules() {\r\n        var node;\r\n        var rules = [];\r\n        whitespace();\r\n        comments(rules);\r\n        while (css.length && css.charAt(0) !== '}' && (node = atrule() || rule())) {\r\n            if (node !== false) {\r\n                rules.push(node);\r\n                comments(rules);\r\n            }\r\n        }\r\n        return rules;\r\n    }\r\n    function match(re) {\r\n        var m = re.exec(css);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var str = m[0];\r\n        updatePosition(str);\r\n        css = css.slice(str.length);\r\n        return m;\r\n    }\r\n    function whitespace() {\r\n        match(/^\\s*/);\r\n    }\r\n    function comments(rules) {\r\n        if (rules === void 0) { rules = []; }\r\n        var c;\r\n        while ((c = comment())) {\r\n            if (c !== false) {\r\n                rules.push(c);\r\n            }\r\n            c = comment();\r\n        }\r\n        return rules;\r\n    }\r\n    function comment() {\r\n        var pos = position();\r\n        if ('/' !== css.charAt(0) || '*' !== css.charAt(1)) {\r\n            return;\r\n        }\r\n        var i = 2;\r\n        while ('' !== css.charAt(i) &&\r\n            ('*' !== css.charAt(i) || '/' !== css.charAt(i + 1))) {\r\n            ++i;\r\n        }\r\n        i += 2;\r\n        if ('' === css.charAt(i - 1)) {\r\n            return error('End of comment missing');\r\n        }\r\n        var str = css.slice(2, i - 2);\r\n        column += 2;\r\n        updatePosition(str);\r\n        css = css.slice(i);\r\n        column += 2;\r\n        return pos({\r\n            type: 'comment',\r\n            comment: str\r\n        });\r\n    }\r\n    function selector() {\r\n        var m = match(/^([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        return trim(m[0])\r\n            .replace(/\\/\\*([^*]|[\\r\\n]|(\\*+([^*/]|[\\r\\n])))*\\*\\/+/g, '')\r\n            .replace(/\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'/g, function (m) {\r\n            return m.replace(/,/g, '\\u200C');\r\n        })\r\n            .split(/\\s*(?![^(]*\\)),\\s*/)\r\n            .map(function (s) {\r\n            return s.replace(/\\u200C/g, ',');\r\n        });\r\n    }\r\n    function declaration() {\r\n        var pos = position();\r\n        var propMatch = match(/^(\\*?[-#\\/\\*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/);\r\n        if (!propMatch) {\r\n            return;\r\n        }\r\n        var prop = trim(propMatch[0]);\r\n        if (!match(/^:\\s*/)) {\r\n            return error(\"property missing ':'\");\r\n        }\r\n        var val = match(/^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^\\)]*?\\)|[^};])+)/);\r\n        var ret = pos({\r\n            type: 'declaration',\r\n            property: prop.replace(commentre, ''),\r\n            value: val ? trim(val[0]).replace(commentre, '') : ''\r\n        });\r\n        match(/^[;\\s]*/);\r\n        return ret;\r\n    }\r\n    function declarations() {\r\n        var decls = [];\r\n        if (!open()) {\r\n            return error(\"missing '{'\");\r\n        }\r\n        comments(decls);\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            if (decl !== false) {\r\n                decls.push(decl);\r\n                comments(decls);\r\n            }\r\n            decl = declaration();\r\n        }\r\n        if (!close()) {\r\n            return error(\"missing '}'\");\r\n        }\r\n        return decls;\r\n    }\r\n    function keyframe() {\r\n        var m;\r\n        var vals = [];\r\n        var pos = position();\r\n        while ((m = match(/^((\\d+\\.\\d+|\\.\\d+|\\d+)%?|[a-z]+)\\s*/))) {\r\n            vals.push(m[1]);\r\n            match(/^,\\s*/);\r\n        }\r\n        if (!vals.length) {\r\n            return;\r\n        }\r\n        return pos({\r\n            type: 'keyframe',\r\n            values: vals,\r\n            declarations: declarations()\r\n        });\r\n    }\r\n    function atkeyframes() {\r\n        var pos = position();\r\n        var m = match(/^@([-\\w]+)?keyframes\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var vendor = m[1];\r\n        m = match(/^([-\\w]+)\\s*/);\r\n        if (!m) {\r\n            return error('@keyframes missing name');\r\n        }\r\n        var name = m[1];\r\n        if (!open()) {\r\n            return error(\"@keyframes missing '{'\");\r\n        }\r\n        var frame;\r\n        var frames = comments();\r\n        while ((frame = keyframe())) {\r\n            frames.push(frame);\r\n            frames = frames.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@keyframes missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'keyframes',\r\n            name: name,\r\n            vendor: vendor,\r\n            keyframes: frames\r\n        });\r\n    }\r\n    function atsupports() {\r\n        var pos = position();\r\n        var m = match(/^@supports *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var supports = trim(m[1]);\r\n        if (!open()) {\r\n            return error(\"@supports missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@supports missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'supports',\r\n            supports: supports,\r\n            rules: style\r\n        });\r\n    }\r\n    function athost() {\r\n        var pos = position();\r\n        var m = match(/^@host\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        if (!open()) {\r\n            return error(\"@host missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@host missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'host',\r\n            rules: style\r\n        });\r\n    }\r\n    function atmedia() {\r\n        var pos = position();\r\n        var m = match(/^@media *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var media = trim(m[1]);\r\n        if (!open()) {\r\n            return error(\"@media missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@media missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'media',\r\n            media: media,\r\n            rules: style\r\n        });\r\n    }\r\n    function atcustommedia() {\r\n        var pos = position();\r\n        var m = match(/^@custom-media\\s+(--[^\\s]+)\\s*([^{;]+);/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        return pos({\r\n            type: 'custom-media',\r\n            name: trim(m[1]),\r\n            media: trim(m[2])\r\n        });\r\n    }\r\n    function atpage() {\r\n        var pos = position();\r\n        var m = match(/^@page */);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var sel = selector() || [];\r\n        if (!open()) {\r\n            return error(\"@page missing '{'\");\r\n        }\r\n        var decls = comments();\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            decls.push(decl);\r\n            decls = decls.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@page missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'page',\r\n            selectors: sel,\r\n            declarations: decls\r\n        });\r\n    }\r\n    function atdocument() {\r\n        var pos = position();\r\n        var m = match(/^@([-\\w]+)?document *([^{]+)/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        var vendor = trim(m[1]);\r\n        var doc = trim(m[2]);\r\n        if (!open()) {\r\n            return error(\"@document missing '{'\");\r\n        }\r\n        var style = comments().concat(rules());\r\n        if (!close()) {\r\n            return error(\"@document missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'document',\r\n            document: doc,\r\n            vendor: vendor,\r\n            rules: style\r\n        });\r\n    }\r\n    function atfontface() {\r\n        var pos = position();\r\n        var m = match(/^@font-face\\s*/);\r\n        if (!m) {\r\n            return;\r\n        }\r\n        if (!open()) {\r\n            return error(\"@font-face missing '{'\");\r\n        }\r\n        var decls = comments();\r\n        var decl;\r\n        while ((decl = declaration())) {\r\n            decls.push(decl);\r\n            decls = decls.concat(comments());\r\n        }\r\n        if (!close()) {\r\n            return error(\"@font-face missing '}'\");\r\n        }\r\n        return pos({\r\n            type: 'font-face',\r\n            declarations: decls\r\n        });\r\n    }\r\n    var atimport = _compileAtrule('import');\r\n    var atcharset = _compileAtrule('charset');\r\n    var atnamespace = _compileAtrule('namespace');\r\n    function _compileAtrule(name) {\r\n        var re = new RegExp('^@' + name + '\\\\s*([^;]+);');\r\n        return function () {\r\n            var pos = position();\r\n            var m = match(re);\r\n            if (!m) {\r\n                return;\r\n            }\r\n            var ret = { type: name };\r\n            ret[name] = m[1].trim();\r\n            return pos(ret);\r\n        };\r\n    }\r\n    function atrule() {\r\n        if (css[0] !== '@') {\r\n            return;\r\n        }\r\n        return (atkeyframes() ||\r\n            atmedia() ||\r\n            atcustommedia() ||\r\n            atsupports() ||\r\n            atimport() ||\r\n            atcharset() ||\r\n            atnamespace() ||\r\n            atdocument() ||\r\n            atpage() ||\r\n            athost() ||\r\n            atfontface());\r\n    }\r\n    function rule() {\r\n        var pos = position();\r\n        var sel = selector();\r\n        if (!sel) {\r\n            return error('selector missing');\r\n        }\r\n        comments();\r\n        return pos({\r\n            type: 'rule',\r\n            selectors: sel,\r\n            declarations: declarations()\r\n        });\r\n    }\r\n    return addParent(stylesheet());\r\n}\r\nfunction trim(str) {\r\n    return str ? str.replace(/^\\s+|\\s+$/g, '') : '';\r\n}\r\nfunction addParent(obj, parent) {\r\n    var isNode = obj && typeof obj.type === 'string';\r\n    var childParent = isNode ? obj : parent;\r\n    for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\r\n        var k = _a[_i];\r\n        var value = obj[k];\r\n        if (Array.isArray(value)) {\r\n            value.forEach(function (v) {\r\n                addParent(v, childParent);\r\n            });\r\n        }\r\n        else if (value && typeof value === 'object') {\r\n            addParent(value, childParent);\r\n        }\r\n    }\r\n    if (isNode) {\r\n        Object.defineProperty(obj, 'parent', {\r\n            configurable: true,\r\n            writable: true,\r\n            enumerable: false,\r\n            value: parent || null\r\n        });\r\n    }\r\n    return obj;\r\n}\n\nvar tagMap = {\r\n    script: 'noscript',\r\n    altglyph: 'altGlyph',\r\n    altglyphdef: 'altGlyphDef',\r\n    altglyphitem: 'altGlyphItem',\r\n    animatecolor: 'animateColor',\r\n    animatemotion: 'animateMotion',\r\n    animatetransform: 'animateTransform',\r\n    clippath: 'clipPath',\r\n    feblend: 'feBlend',\r\n    fecolormatrix: 'feColorMatrix',\r\n    fecomponenttransfer: 'feComponentTransfer',\r\n    fecomposite: 'feComposite',\r\n    feconvolvematrix: 'feConvolveMatrix',\r\n    fediffuselighting: 'feDiffuseLighting',\r\n    fedisplacementmap: 'feDisplacementMap',\r\n    fedistantlight: 'feDistantLight',\r\n    fedropshadow: 'feDropShadow',\r\n    feflood: 'feFlood',\r\n    fefunca: 'feFuncA',\r\n    fefuncb: 'feFuncB',\r\n    fefuncg: 'feFuncG',\r\n    fefuncr: 'feFuncR',\r\n    fegaussianblur: 'feGaussianBlur',\r\n    feimage: 'feImage',\r\n    femerge: 'feMerge',\r\n    femergenode: 'feMergeNode',\r\n    femorphology: 'feMorphology',\r\n    feoffset: 'feOffset',\r\n    fepointlight: 'fePointLight',\r\n    fespecularlighting: 'feSpecularLighting',\r\n    fespotlight: 'feSpotLight',\r\n    fetile: 'feTile',\r\n    feturbulence: 'feTurbulence',\r\n    foreignobject: 'foreignObject',\r\n    glyphref: 'glyphRef',\r\n    lineargradient: 'linearGradient',\r\n    radialgradient: 'radialGradient'\r\n};\r\nfunction getTagName(n) {\r\n    var tagName = tagMap[n.tagName] ? tagMap[n.tagName] : n.tagName;\r\n    if (tagName === 'link' && n.attributes._cssText) {\r\n        tagName = 'style';\r\n    }\r\n    return tagName;\r\n}\r\nfunction escapeRegExp(str) {\r\n    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n}\r\nvar HOVER_SELECTOR = /([^\\\\]):hover/;\r\nvar HOVER_SELECTOR_GLOBAL = new RegExp(HOVER_SELECTOR.source, 'g');\r\nfunction addHoverClass(cssText, cache) {\r\n    var cachedStyle = cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.get(cssText);\r\n    if (cachedStyle)\r\n        return cachedStyle;\r\n    var ast = parse(cssText, {\r\n        silent: true\r\n    });\r\n    if (!ast.stylesheet) {\r\n        return cssText;\r\n    }\r\n    var selectors = [];\r\n    ast.stylesheet.rules.forEach(function (rule) {\r\n        if ('selectors' in rule) {\r\n            (rule.selectors || []).forEach(function (selector) {\r\n                if (HOVER_SELECTOR.test(selector)) {\r\n                    selectors.push(selector);\r\n                }\r\n            });\r\n        }\r\n    });\r\n    if (selectors.length === 0) {\r\n        return cssText;\r\n    }\r\n    var selectorMatcher = new RegExp(selectors\r\n        .filter(function (selector, index) { return selectors.indexOf(selector) === index; })\r\n        .sort(function (a, b) { return b.length - a.length; })\r\n        .map(function (selector) {\r\n        return escapeRegExp(selector);\r\n    })\r\n        .join('|'), 'g');\r\n    var result = cssText.replace(selectorMatcher, function (selector) {\r\n        var newSelector = selector.replace(HOVER_SELECTOR_GLOBAL, '$1.\\\\:hover');\r\n        return \"\".concat(selector, \", \").concat(newSelector);\r\n    });\r\n    cache === null || cache === void 0 ? void 0 : cache.stylesWithHoverClass.set(cssText, result);\r\n    return result;\r\n}\r\nfunction createCache() {\r\n    var stylesWithHoverClass = new Map();\r\n    return {\r\n        stylesWithHoverClass: stylesWithHoverClass\r\n    };\r\n}\r\nfunction buildNode(n, options) {\r\n    var doc = options.doc, hackCss = options.hackCss, cache = options.cache;\r\n    switch (n.type) {\r\n        case NodeType.Document:\r\n            return doc.implementation.createDocument(null, '', null);\r\n        case NodeType.DocumentType:\r\n            return doc.implementation.createDocumentType(n.name || 'html', n.publicId, n.systemId);\r\n        case NodeType.Element: {\r\n            var tagName = getTagName(n);\r\n            var node_1;\r\n            if (n.isSVG) {\r\n                node_1 = doc.createElementNS('http://www.w3.org/2000/svg', tagName);\r\n            }\r\n            else {\r\n                node_1 = doc.createElement(tagName);\r\n            }\r\n            var specialAttributes = {};\r\n            for (var name_1 in n.attributes) {\r\n                if (!Object.prototype.hasOwnProperty.call(n.attributes, name_1)) {\r\n                    continue;\r\n                }\r\n                var value = n.attributes[name_1];\r\n                if (tagName === 'option' &&\r\n                    name_1 === 'selected' &&\r\n                    value === false) {\r\n                    continue;\r\n                }\r\n                if (value === true)\r\n                    value = '';\r\n                if (name_1.startsWith('rr_')) {\r\n                    specialAttributes[name_1] = value;\r\n                    continue;\r\n                }\r\n                var isTextarea = tagName === 'textarea' && name_1 === 'value';\r\n                var isRemoteOrDynamicCss = tagName === 'style' && name_1 === '_cssText';\r\n                if (isRemoteOrDynamicCss && hackCss && typeof value === 'string') {\r\n                    value = addHoverClass(value, cache);\r\n                }\r\n                if ((isTextarea || isRemoteOrDynamicCss) && typeof value === 'string') {\r\n                    var child = doc.createTextNode(value);\r\n                    for (var _i = 0, _a = Array.from(node_1.childNodes); _i < _a.length; _i++) {\r\n                        var c = _a[_i];\r\n                        if (c.nodeType === node_1.TEXT_NODE) {\r\n                            node_1.removeChild(c);\r\n                        }\r\n                    }\r\n                    node_1.appendChild(child);\r\n                    continue;\r\n                }\r\n                try {\r\n                    if (n.isSVG && name_1 === 'xlink:href') {\r\n                        node_1.setAttributeNS('http://www.w3.org/1999/xlink', name_1, value.toString());\r\n                    }\r\n                    else if (name_1 === 'onload' ||\r\n                        name_1 === 'onclick' ||\r\n                        name_1.substring(0, 7) === 'onmouse') {\r\n                        node_1.setAttribute('_' + name_1, value.toString());\r\n                    }\r\n                    else if (tagName === 'meta' &&\r\n                        n.attributes['http-equiv'] === 'Content-Security-Policy' &&\r\n                        name_1 === 'content') {\r\n                        node_1.setAttribute('csp-content', value.toString());\r\n                        continue;\r\n                    }\r\n                    else if (tagName === 'link' &&\r\n                        n.attributes.rel === 'preload' &&\r\n                        n.attributes.as === 'script') {\r\n                    }\r\n                    else if (tagName === 'link' &&\r\n                        n.attributes.rel === 'prefetch' &&\r\n                        typeof n.attributes.href === 'string' &&\r\n                        n.attributes.href.endsWith('.js')) {\r\n                    }\r\n                    else if (tagName === 'img' &&\r\n                        n.attributes.srcset &&\r\n                        n.attributes.rr_dataURL) {\r\n                        node_1.setAttribute('rrweb-original-srcset', n.attributes.srcset);\r\n                    }\r\n                    else {\r\n                        node_1.setAttribute(name_1, value.toString());\r\n                    }\r\n                }\r\n                catch (error) {\r\n                }\r\n            }\r\n            var _loop_1 = function (name_2) {\r\n                var value = specialAttributes[name_2];\r\n                if (tagName === 'canvas' && name_2 === 'rr_dataURL') {\r\n                    var image_1 = document.createElement('img');\r\n                    image_1.onload = function () {\r\n                        var ctx = node_1.getContext('2d');\r\n                        if (ctx) {\r\n                            ctx.drawImage(image_1, 0, 0, image_1.width, image_1.height);\r\n                        }\r\n                    };\r\n                    image_1.src = value.toString();\r\n                    if (node_1.RRNodeType)\r\n                        node_1.rr_dataURL = value.toString();\r\n                }\r\n                else if (tagName === 'img' && name_2 === 'rr_dataURL') {\r\n                    var image = node_1;\r\n                    if (!image.currentSrc.startsWith('data:')) {\r\n                        image.setAttribute('rrweb-original-src', n.attributes.src);\r\n                        image.src = value.toString();\r\n                    }\r\n                }\r\n                if (name_2 === 'rr_width') {\r\n                    node_1.style.width = value.toString();\r\n                }\r\n                else if (name_2 === 'rr_height') {\r\n                    node_1.style.height = value.toString();\r\n                }\r\n                else if (name_2 === 'rr_mediaCurrentTime' &&\r\n                    typeof value === 'number') {\r\n                    node_1.currentTime = value;\r\n                }\r\n                else if (name_2 === 'rr_mediaState') {\r\n                    switch (value) {\r\n                        case 'played':\r\n                            node_1\r\n                                .play()[\"catch\"](function (e) { return console.warn('media playback error', e); });\r\n                            break;\r\n                        case 'paused':\r\n                            node_1.pause();\r\n                            break;\r\n                    }\r\n                }\r\n            };\r\n            for (var name_2 in specialAttributes) {\r\n                _loop_1(name_2);\r\n            }\r\n            if (n.isShadowHost) {\r\n                if (!node_1.shadowRoot) {\r\n                    node_1.attachShadow({ mode: 'open' });\r\n                }\r\n                else {\r\n                    while (node_1.shadowRoot.firstChild) {\r\n                        node_1.shadowRoot.removeChild(node_1.shadowRoot.firstChild);\r\n                    }\r\n                }\r\n            }\r\n            return node_1;\r\n        }\r\n        case NodeType.Text:\r\n            return doc.createTextNode(n.isStyle && hackCss\r\n                ? addHoverClass(n.textContent, cache)\r\n                : n.textContent);\r\n        case NodeType.CDATA:\r\n            return doc.createCDATASection(n.textContent);\r\n        case NodeType.Comment:\r\n            return doc.createComment(n.textContent);\r\n        default:\r\n            return null;\r\n    }\r\n}\r\nfunction buildNodeWithSN(n, options) {\r\n    var doc = options.doc, mirror = options.mirror, _a = options.skipChild, skipChild = _a === void 0 ? false : _a, _b = options.hackCss, hackCss = _b === void 0 ? true : _b, afterAppend = options.afterAppend, cache = options.cache;\r\n    var node = buildNode(n, { doc: doc, hackCss: hackCss, cache: cache });\r\n    if (!node) {\r\n        return null;\r\n    }\r\n    if (n.rootId && mirror.getNode(n.rootId) !== doc) {\r\n        mirror.replace(n.rootId, doc);\r\n    }\r\n    if (n.type === NodeType.Document) {\r\n        doc.close();\r\n        doc.open();\r\n        if (n.compatMode === 'BackCompat' &&\r\n            n.childNodes &&\r\n            n.childNodes[0].type !== NodeType.DocumentType) {\r\n            if (n.childNodes[0].type === NodeType.Element &&\r\n                'xmlns' in n.childNodes[0].attributes &&\r\n                n.childNodes[0].attributes.xmlns === 'http://www.w3.org/1999/xhtml') {\r\n                doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"\">');\r\n            }\r\n            else {\r\n                doc.write('<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"\">');\r\n            }\r\n        }\r\n        node = doc;\r\n    }\r\n    mirror.add(node, n);\r\n    if ((n.type === NodeType.Document || n.type === NodeType.Element) &&\r\n        !skipChild) {\r\n        for (var _i = 0, _c = n.childNodes; _i < _c.length; _i++) {\r\n            var childN = _c[_i];\r\n            var childNode = buildNodeWithSN(childN, {\r\n                doc: doc,\r\n                mirror: mirror,\r\n                skipChild: false,\r\n                hackCss: hackCss,\r\n                afterAppend: afterAppend,\r\n                cache: cache\r\n            });\r\n            if (!childNode) {\r\n                console.warn('Failed to rebuild', childN);\r\n                continue;\r\n            }\r\n            if (childN.isShadow && isElement(node) && node.shadowRoot) {\r\n                node.shadowRoot.appendChild(childNode);\r\n            }\r\n            else {\r\n                node.appendChild(childNode);\r\n            }\r\n            if (afterAppend) {\r\n                afterAppend(childNode, childN.id);\r\n            }\r\n        }\r\n    }\r\n    return node;\r\n}\r\nfunction visit(mirror, onVisit) {\r\n    function walk(node) {\r\n        onVisit(node);\r\n    }\r\n    for (var _i = 0, _a = mirror.getIds(); _i < _a.length; _i++) {\r\n        var id = _a[_i];\r\n        if (mirror.has(id)) {\r\n            walk(mirror.getNode(id));\r\n        }\r\n    }\r\n}\r\nfunction handleScroll(node, mirror) {\r\n    var n = mirror.getMeta(node);\r\n    if ((n === null || n === void 0 ? void 0 : n.type) !== NodeType.Element) {\r\n        return;\r\n    }\r\n    var el = node;\r\n    for (var name_3 in n.attributes) {\r\n        if (!(Object.prototype.hasOwnProperty.call(n.attributes, name_3) &&\r\n            name_3.startsWith('rr_'))) {\r\n            continue;\r\n        }\r\n        var value = n.attributes[name_3];\r\n        if (name_3 === 'rr_scrollLeft') {\r\n            el.scrollLeft = value;\r\n        }\r\n        if (name_3 === 'rr_scrollTop') {\r\n            el.scrollTop = value;\r\n        }\r\n    }\r\n}\r\nfunction rebuild(n, options) {\r\n    var doc = options.doc, onVisit = options.onVisit, _a = options.hackCss, hackCss = _a === void 0 ? true : _a, afterAppend = options.afterAppend, cache = options.cache, _b = options.mirror, mirror = _b === void 0 ? new Mirror() : _b;\r\n    var node = buildNodeWithSN(n, {\r\n        doc: doc,\r\n        mirror: mirror,\r\n        skipChild: false,\r\n        hackCss: hackCss,\r\n        afterAppend: afterAppend,\r\n        cache: cache\r\n    });\r\n    visit(mirror, function (visitedNode) {\r\n        if (onVisit) {\r\n            onVisit(visitedNode);\r\n        }\r\n        handleScroll(visitedNode, mirror);\r\n    });\r\n    return node;\r\n}\n\nexport { IGNORED_NODE, Mirror, NodeType, addHoverClass, buildNodeWithSN, classMatchesRegex, createCache, createMirror, genId, getCssRuleString, getCssRulesString, is2DCanvasBlank, isCSSImportRule, isElement, isNativeShadowDom, isShadowRoot, maskInputValue, needMaskingText, rebuild, serializeNodeWithId, snapshot, transformAttribute };\n", "import { classMatchesRegex, IGNORED_NODE, isShadowRoot } from '../../rrweb-snapshot/es/rrweb-snapshot.js';\n\nfunction on(type, fn, target = document) {\r\n    const options = { capture: true, passive: true };\r\n    target.addEventListener(type, fn, options);\r\n    return () => target.removeEventListener(type, fn, options);\r\n}\r\nconst DEPARTED_MIRROR_ACCESS_WARNING = 'Please stop import mirror directly. Instead of that,' +\r\n    '\\r\\n' +\r\n    'now you can use replayer.getMirror() to access the mirror instance of a replayer,' +\r\n    '\\r\\n' +\r\n    'or you can use record.mirror to access the mirror instance during recording.';\r\nlet _mirror = {\r\n    map: {},\r\n    getId() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n        return -1;\r\n    },\r\n    getNode() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n        return null;\r\n    },\r\n    removeNodeFromMap() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n    },\r\n    has() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n        return false;\r\n    },\r\n    reset() {\r\n        console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n    },\r\n};\r\nif (typeof window !== 'undefined' && window.Proxy && window.Reflect) {\r\n    _mirror = new Proxy(_mirror, {\r\n        get(target, prop, receiver) {\r\n            if (prop === 'map') {\r\n                console.error(DEPARTED_MIRROR_ACCESS_WARNING);\r\n            }\r\n            return Reflect.get(target, prop, receiver);\r\n        },\r\n    });\r\n}\r\nfunction throttle(func, wait, options = {}) {\r\n    let timeout = null;\r\n    let previous = 0;\r\n    return function (...args) {\r\n        const now = Date.now();\r\n        if (!previous && options.leading === false) {\r\n            previous = now;\r\n        }\r\n        const remaining = wait - (now - previous);\r\n        const context = this;\r\n        if (remaining <= 0 || remaining > wait) {\r\n            if (timeout) {\r\n                clearTimeout(timeout);\r\n                timeout = null;\r\n            }\r\n            previous = now;\r\n            func.apply(context, args);\r\n        }\r\n        else if (!timeout && options.trailing !== false) {\r\n            timeout = setTimeout(() => {\r\n                previous = options.leading === false ? 0 : Date.now();\r\n                timeout = null;\r\n                func.apply(context, args);\r\n            }, remaining);\r\n        }\r\n    };\r\n}\r\nfunction hookSetter(target, key, d, isRevoked, win = window) {\r\n    const original = win.Object.getOwnPropertyDescriptor(target, key);\r\n    win.Object.defineProperty(target, key, isRevoked\r\n        ? d\r\n        : {\r\n            set(value) {\r\n                setTimeout(() => {\r\n                    d.set.call(this, value);\r\n                }, 0);\r\n                if (original && original.set) {\r\n                    original.set.call(this, value);\r\n                }\r\n            },\r\n        });\r\n    return () => hookSetter(target, key, original || {}, true);\r\n}\r\nfunction patch(source, name, replacement) {\r\n    try {\r\n        if (!(name in source)) {\r\n            return () => {\r\n            };\r\n        }\r\n        const original = source[name];\r\n        const wrapped = replacement(original);\r\n        if (typeof wrapped === 'function') {\r\n            wrapped.prototype = wrapped.prototype || {};\r\n            Object.defineProperties(wrapped, {\r\n                __rrweb_original__: {\r\n                    enumerable: false,\r\n                    value: original,\r\n                },\r\n            });\r\n        }\r\n        source[name] = wrapped;\r\n        return () => {\r\n            source[name] = original;\r\n        };\r\n    }\r\n    catch (_a) {\r\n        return () => {\r\n        };\r\n    }\r\n}\r\nfunction getWindowHeight() {\r\n    return (window.innerHeight ||\r\n        (document.documentElement && document.documentElement.clientHeight) ||\r\n        (document.body && document.body.clientHeight));\r\n}\r\nfunction getWindowWidth() {\r\n    return (window.innerWidth ||\r\n        (document.documentElement && document.documentElement.clientWidth) ||\r\n        (document.body && document.body.clientWidth));\r\n}\r\nfunction isBlocked(node, blockClass, blockSelector, checkAncestors) {\r\n    if (!node) {\r\n        return false;\r\n    }\r\n    const el = node.nodeType === node.ELEMENT_NODE\r\n        ? node\r\n        : node.parentElement;\r\n    if (!el)\r\n        return false;\r\n    if (typeof blockClass === 'string') {\r\n        if (el.classList.contains(blockClass))\r\n            return true;\r\n        if (checkAncestors && el.closest('.' + blockClass) !== null)\r\n            return true;\r\n    }\r\n    else {\r\n        if (classMatchesRegex(el, blockClass, checkAncestors))\r\n            return true;\r\n    }\r\n    if (blockSelector) {\r\n        if (node.matches(blockSelector))\r\n            return true;\r\n        if (checkAncestors && el.closest(blockSelector) !== null)\r\n            return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isSerialized(n, mirror) {\r\n    return mirror.getId(n) !== -1;\r\n}\r\nfunction isIgnored(n, mirror) {\r\n    return mirror.getId(n) === IGNORED_NODE;\r\n}\r\nfunction isAncestorRemoved(target, mirror) {\r\n    if (isShadowRoot(target)) {\r\n        return false;\r\n    }\r\n    const id = mirror.getId(target);\r\n    if (!mirror.has(id)) {\r\n        return true;\r\n    }\r\n    if (target.parentNode &&\r\n        target.parentNode.nodeType === target.DOCUMENT_NODE) {\r\n        return false;\r\n    }\r\n    if (!target.parentNode) {\r\n        return true;\r\n    }\r\n    return isAncestorRemoved(target.parentNode, mirror);\r\n}\r\nfunction isTouchEvent(event) {\r\n    return Boolean(event.changedTouches);\r\n}\r\nfunction polyfill(win = window) {\r\n    if ('NodeList' in win && !win.NodeList.prototype.forEach) {\r\n        win.NodeList.prototype.forEach = Array.prototype\r\n            .forEach;\r\n    }\r\n    if ('DOMTokenList' in win && !win.DOMTokenList.prototype.forEach) {\r\n        win.DOMTokenList.prototype.forEach = Array.prototype\r\n            .forEach;\r\n    }\r\n    if (!Node.prototype.contains) {\r\n        Node.prototype.contains = (...args) => {\r\n            let node = args[0];\r\n            if (!(0 in args)) {\r\n                throw new TypeError('1 argument is required');\r\n            }\r\n            do {\r\n                if (this === node) {\r\n                    return true;\r\n                }\r\n            } while ((node = node && node.parentNode));\r\n            return false;\r\n        };\r\n    }\r\n}\r\nfunction queueToResolveTrees(queue) {\r\n    const queueNodeMap = {};\r\n    const putIntoMap = (m, parent) => {\r\n        const nodeInTree = {\r\n            value: m,\r\n            parent,\r\n            children: [],\r\n        };\r\n        queueNodeMap[m.node.id] = nodeInTree;\r\n        return nodeInTree;\r\n    };\r\n    const queueNodeTrees = [];\r\n    for (const mutation of queue) {\r\n        const { nextId, parentId } = mutation;\r\n        if (nextId && nextId in queueNodeMap) {\r\n            const nextInTree = queueNodeMap[nextId];\r\n            if (nextInTree.parent) {\r\n                const idx = nextInTree.parent.children.indexOf(nextInTree);\r\n                nextInTree.parent.children.splice(idx, 0, putIntoMap(mutation, nextInTree.parent));\r\n            }\r\n            else {\r\n                const idx = queueNodeTrees.indexOf(nextInTree);\r\n                queueNodeTrees.splice(idx, 0, putIntoMap(mutation, null));\r\n            }\r\n            continue;\r\n        }\r\n        if (parentId in queueNodeMap) {\r\n            const parentInTree = queueNodeMap[parentId];\r\n            parentInTree.children.push(putIntoMap(mutation, parentInTree));\r\n            continue;\r\n        }\r\n        queueNodeTrees.push(putIntoMap(mutation, null));\r\n    }\r\n    return queueNodeTrees;\r\n}\r\nfunction iterateResolveTree(tree, cb) {\r\n    cb(tree.value);\r\n    for (let i = tree.children.length - 1; i >= 0; i--) {\r\n        iterateResolveTree(tree.children[i], cb);\r\n    }\r\n}\r\nfunction isSerializedIframe(n, mirror) {\r\n    return Boolean(n.nodeName === 'IFRAME' && mirror.getMeta(n));\r\n}\r\nfunction isSerializedStylesheet(n, mirror) {\r\n    return Boolean(n.nodeName === 'LINK' &&\r\n        n.nodeType === n.ELEMENT_NODE &&\r\n        n.getAttribute &&\r\n        n.getAttribute('rel') === 'stylesheet' &&\r\n        mirror.getMeta(n));\r\n}\r\nfunction getBaseDimension(node, rootIframe) {\r\n    var _a, _b;\r\n    const frameElement = (_b = (_a = node.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) === null || _b === void 0 ? void 0 : _b.frameElement;\r\n    if (!frameElement || frameElement === rootIframe) {\r\n        return {\r\n            x: 0,\r\n            y: 0,\r\n            relativeScale: 1,\r\n            absoluteScale: 1,\r\n        };\r\n    }\r\n    const frameDimension = frameElement.getBoundingClientRect();\r\n    const frameBaseDimension = getBaseDimension(frameElement, rootIframe);\r\n    const relativeScale = frameDimension.height / frameElement.clientHeight;\r\n    return {\r\n        x: frameDimension.x * frameBaseDimension.relativeScale +\r\n            frameBaseDimension.x,\r\n        y: frameDimension.y * frameBaseDimension.relativeScale +\r\n            frameBaseDimension.y,\r\n        relativeScale,\r\n        absoluteScale: frameBaseDimension.absoluteScale * relativeScale,\r\n    };\r\n}\r\nfunction hasShadowRoot(n) {\r\n    return Boolean(n === null || n === void 0 ? void 0 : n.shadowRoot);\r\n}\r\nfunction getNestedRule(rules, position) {\r\n    const rule = rules[position[0]];\r\n    if (position.length === 1) {\r\n        return rule;\r\n    }\r\n    else {\r\n        return getNestedRule(rule.cssRules[position[1]].cssRules, position.slice(2));\r\n    }\r\n}\r\nfunction getPositionsAndIndex(nestedIndex) {\r\n    const positions = [...nestedIndex];\r\n    const index = positions.pop();\r\n    return { positions, index };\r\n}\r\nfunction uniqueTextMutations(mutations) {\r\n    const idSet = new Set();\r\n    const uniqueMutations = [];\r\n    for (let i = mutations.length; i--;) {\r\n        const mutation = mutations[i];\r\n        if (!idSet.has(mutation.id)) {\r\n            uniqueMutations.push(mutation);\r\n            idSet.add(mutation.id);\r\n        }\r\n    }\r\n    return uniqueMutations;\r\n}\r\nclass StyleSheetMirror {\r\n    constructor() {\r\n        this.id = 1;\r\n        this.styleIDMap = new WeakMap();\r\n        this.idStyleMap = new Map();\r\n    }\r\n    getId(stylesheet) {\r\n        var _a;\r\n        return (_a = this.styleIDMap.get(stylesheet)) !== null && _a !== void 0 ? _a : -1;\r\n    }\r\n    has(stylesheet) {\r\n        return this.styleIDMap.has(stylesheet);\r\n    }\r\n    add(stylesheet, id) {\r\n        if (this.has(stylesheet))\r\n            return this.getId(stylesheet);\r\n        let newId;\r\n        if (id === undefined) {\r\n            newId = this.id++;\r\n        }\r\n        else\r\n            newId = id;\r\n        this.styleIDMap.set(stylesheet, newId);\r\n        this.idStyleMap.set(newId, stylesheet);\r\n        return newId;\r\n    }\r\n    getStyle(id) {\r\n        return this.idStyleMap.get(id) || null;\r\n    }\r\n    reset() {\r\n        this.styleIDMap = new WeakMap();\r\n        this.idStyleMap = new Map();\r\n        this.id = 1;\r\n    }\r\n    generateId() {\r\n        return this.id++;\r\n    }\r\n}\n\nexport { StyleSheetMirror, _mirror, getBaseDimension, getNestedRule, getPositionsAndIndex, getWindowHeight, getWindowWidth, hasShadowRoot, hookSetter, isAncestorRemoved, isBlocked, isIgnored, isSerialized, isSerializedIframe, isSerializedStylesheet, isTouchEvent, iterateResolveTree, on, patch, polyfill, queueToResolveTrees, throttle, uniqueTextMutations };\n", "var EventType = /* @__PURE__ */ ((EventType2) => {\n  EventType2[EventType2[\"DomContentLoaded\"] = 0] = \"DomContentLoaded\";\n  EventType2[EventType2[\"Load\"] = 1] = \"Load\";\n  EventType2[EventType2[\"FullSnapshot\"] = 2] = \"FullSnapshot\";\n  EventType2[EventType2[\"IncrementalSnapshot\"] = 3] = \"IncrementalSnapshot\";\n  EventType2[EventType2[\"Meta\"] = 4] = \"Meta\";\n  EventType2[EventType2[\"Custom\"] = 5] = \"Custom\";\n  EventType2[EventType2[\"Plugin\"] = 6] = \"Plugin\";\n  return EventType2;\n})(EventType || {});\nvar IncrementalSource = /* @__PURE__ */ ((IncrementalSource2) => {\n  IncrementalSource2[IncrementalSource2[\"Mutation\"] = 0] = \"Mutation\";\n  IncrementalSource2[IncrementalSource2[\"MouseMove\"] = 1] = \"MouseMove\";\n  IncrementalSource2[IncrementalSource2[\"MouseInteraction\"] = 2] = \"MouseInteraction\";\n  IncrementalSource2[IncrementalSource2[\"Scroll\"] = 3] = \"Scroll\";\n  IncrementalSource2[IncrementalSource2[\"ViewportResize\"] = 4] = \"ViewportResize\";\n  IncrementalSource2[IncrementalSource2[\"Input\"] = 5] = \"Input\";\n  IncrementalSource2[IncrementalSource2[\"TouchMove\"] = 6] = \"TouchMove\";\n  IncrementalSource2[IncrementalSource2[\"MediaInteraction\"] = 7] = \"MediaInteraction\";\n  IncrementalSource2[IncrementalSource2[\"StyleSheetRule\"] = 8] = \"StyleSheetRule\";\n  IncrementalSource2[IncrementalSource2[\"CanvasMutation\"] = 9] = \"CanvasMutation\";\n  IncrementalSource2[IncrementalSource2[\"Font\"] = 10] = \"Font\";\n  IncrementalSource2[IncrementalSource2[\"Log\"] = 11] = \"Log\";\n  IncrementalSource2[IncrementalSource2[\"Drag\"] = 12] = \"Drag\";\n  IncrementalSource2[IncrementalSource2[\"StyleDeclaration\"] = 13] = \"StyleDeclaration\";\n  IncrementalSource2[IncrementalSource2[\"Selection\"] = 14] = \"Selection\";\n  IncrementalSource2[IncrementalSource2[\"AdoptedStyleSheet\"] = 15] = \"AdoptedStyleSheet\";\n  return IncrementalSource2;\n})(IncrementalSource || {});\nvar MouseInteractions = /* @__PURE__ */ ((MouseInteractions2) => {\n  MouseInteractions2[MouseInteractions2[\"MouseUp\"] = 0] = \"MouseUp\";\n  MouseInteractions2[MouseInteractions2[\"MouseDown\"] = 1] = \"MouseDown\";\n  MouseInteractions2[MouseInteractions2[\"Click\"] = 2] = \"Click\";\n  MouseInteractions2[MouseInteractions2[\"ContextMenu\"] = 3] = \"ContextMenu\";\n  MouseInteractions2[MouseInteractions2[\"DblClick\"] = 4] = \"DblClick\";\n  MouseInteractions2[MouseInteractions2[\"Focus\"] = 5] = \"Focus\";\n  MouseInteractions2[MouseInteractions2[\"Blur\"] = 6] = \"Blur\";\n  MouseInteractions2[MouseInteractions2[\"TouchStart\"] = 7] = \"TouchStart\";\n  MouseInteractions2[MouseInteractions2[\"TouchMove_Departed\"] = 8] = \"TouchMove_Departed\";\n  MouseInteractions2[MouseInteractions2[\"TouchEnd\"] = 9] = \"TouchEnd\";\n  MouseInteractions2[MouseInteractions2[\"TouchCancel\"] = 10] = \"TouchCancel\";\n  return MouseInteractions2;\n})(MouseInteractions || {});\nvar CanvasContext = /* @__PURE__ */ ((CanvasContext2) => {\n  CanvasContext2[CanvasContext2[\"2D\"] = 0] = \"2D\";\n  CanvasContext2[CanvasContext2[\"WebGL\"] = 1] = \"WebGL\";\n  CanvasContext2[CanvasContext2[\"WebGL2\"] = 2] = \"WebGL2\";\n  return CanvasContext2;\n})(CanvasContext || {});\nvar ReplayerEvents = /* @__PURE__ */ ((ReplayerEvents2) => {\n  ReplayerEvents2[\"Start\"] = \"start\";\n  ReplayerEvents2[\"Pause\"] = \"pause\";\n  ReplayerEvents2[\"Resume\"] = \"resume\";\n  ReplayerEvents2[\"Resize\"] = \"resize\";\n  ReplayerEvents2[\"Finish\"] = \"finish\";\n  ReplayerEvents2[\"FullsnapshotRebuilded\"] = \"fullsnapshot-rebuilded\";\n  ReplayerEvents2[\"LoadStylesheetStart\"] = \"load-stylesheet-start\";\n  ReplayerEvents2[\"LoadStylesheetEnd\"] = \"load-stylesheet-end\";\n  ReplayerEvents2[\"SkipStart\"] = \"skip-start\";\n  ReplayerEvents2[\"SkipEnd\"] = \"skip-end\";\n  ReplayerEvents2[\"MouseInteraction\"] = \"mouse-interaction\";\n  ReplayerEvents2[\"EventCast\"] = \"event-cast\";\n  ReplayerEvents2[\"CustomEvent\"] = \"custom-event\";\n  ReplayerEvents2[\"Flush\"] = \"flush\";\n  ReplayerEvents2[\"StateChange\"] = \"state-change\";\n  ReplayerEvents2[\"PlayBack\"] = \"play-back\";\n  ReplayerEvents2[\"Destroy\"] = \"destroy\";\n  return ReplayerEvents2;\n})(ReplayerEvents || {});\n\nexport { CanvasContext, EventType, IncrementalSource, MouseInteractions, ReplayerEvents };\n", "import { isShadowRoot, isNativeShadowDom, maskInputValue, transformAttribute, needMaskingText, IGNORED_NODE, serializeNodeWithId } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { isIgnored, isBlocked, isSerialized, isAncestorRemoved, isSerializedIframe, isSerializedStylesheet, hasShadowRoot } from '../utils.js';\n\nfunction isNodeInLinkedList(n) {\r\n    return '__ln' in n;\r\n}\r\nclass DoubleLinkedList {\r\n    constructor() {\r\n        this.length = 0;\r\n        this.head = null;\r\n    }\r\n    get(position) {\r\n        if (position >= this.length) {\r\n            throw new Error('Position outside of list range');\r\n        }\r\n        let current = this.head;\r\n        for (let index = 0; index < position; index++) {\r\n            current = (current === null || current === void 0 ? void 0 : current.next) || null;\r\n        }\r\n        return current;\r\n    }\r\n    addNode(n) {\r\n        const node = {\r\n            value: n,\r\n            previous: null,\r\n            next: null,\r\n        };\r\n        n.__ln = node;\r\n        if (n.previousSibling && isNodeInLinkedList(n.previousSibling)) {\r\n            const current = n.previousSibling.__ln.next;\r\n            node.next = current;\r\n            node.previous = n.previousSibling.__ln;\r\n            n.previousSibling.__ln.next = node;\r\n            if (current) {\r\n                current.previous = node;\r\n            }\r\n        }\r\n        else if (n.nextSibling &&\r\n            isNodeInLinkedList(n.nextSibling) &&\r\n            n.nextSibling.__ln.previous) {\r\n            const current = n.nextSibling.__ln.previous;\r\n            node.previous = current;\r\n            node.next = n.nextSibling.__ln;\r\n            n.nextSibling.__ln.previous = node;\r\n            if (current) {\r\n                current.next = node;\r\n            }\r\n        }\r\n        else {\r\n            if (this.head) {\r\n                this.head.previous = node;\r\n            }\r\n            node.next = this.head;\r\n            this.head = node;\r\n        }\r\n        this.length++;\r\n    }\r\n    removeNode(n) {\r\n        const current = n.__ln;\r\n        if (!this.head) {\r\n            return;\r\n        }\r\n        if (!current.previous) {\r\n            this.head = current.next;\r\n            if (this.head) {\r\n                this.head.previous = null;\r\n            }\r\n        }\r\n        else {\r\n            current.previous.next = current.next;\r\n            if (current.next) {\r\n                current.next.previous = current.previous;\r\n            }\r\n        }\r\n        if (n.__ln) {\r\n            delete n.__ln;\r\n        }\r\n        this.length--;\r\n    }\r\n}\r\nconst moveKey = (id, parentId) => `${id}@${parentId}`;\r\nclass MutationBuffer {\r\n    constructor() {\r\n        this.frozen = false;\r\n        this.locked = false;\r\n        this.texts = [];\r\n        this.attributes = [];\r\n        this.removes = [];\r\n        this.mapRemoves = [];\r\n        this.movedMap = {};\r\n        this.addedSet = new Set();\r\n        this.movedSet = new Set();\r\n        this.droppedSet = new Set();\r\n        this.processMutations = (mutations) => {\r\n            mutations.forEach(this.processMutation);\r\n            this.emit();\r\n        };\r\n        this.emit = () => {\r\n            if (this.frozen || this.locked) {\r\n                return;\r\n            }\r\n            const adds = [];\r\n            const addList = new DoubleLinkedList();\r\n            const getNextId = (n) => {\r\n                let ns = n;\r\n                let nextId = IGNORED_NODE;\r\n                while (nextId === IGNORED_NODE) {\r\n                    ns = ns && ns.nextSibling;\r\n                    nextId = ns && this.mirror.getId(ns);\r\n                }\r\n                return nextId;\r\n            };\r\n            const pushAdd = (n) => {\r\n                var _a, _b, _c, _d;\r\n                let shadowHost = null;\r\n                if (((_b = (_a = n.getRootNode) === null || _a === void 0 ? void 0 : _a.call(n)) === null || _b === void 0 ? void 0 : _b.nodeType) === Node.DOCUMENT_FRAGMENT_NODE &&\r\n                    n.getRootNode().host)\r\n                    shadowHost = n.getRootNode().host;\r\n                let rootShadowHost = shadowHost;\r\n                while (((_d = (_c = rootShadowHost === null || rootShadowHost === void 0 ? void 0 : rootShadowHost.getRootNode) === null || _c === void 0 ? void 0 : _c.call(rootShadowHost)) === null || _d === void 0 ? void 0 : _d.nodeType) ===\r\n                    Node.DOCUMENT_FRAGMENT_NODE &&\r\n                    rootShadowHost.getRootNode().host)\r\n                    rootShadowHost = rootShadowHost.getRootNode().host;\r\n                const notInDoc = !this.doc.contains(n) &&\r\n                    (!rootShadowHost || !this.doc.contains(rootShadowHost));\r\n                if (!n.parentNode || notInDoc) {\r\n                    return;\r\n                }\r\n                const parentId = isShadowRoot(n.parentNode)\r\n                    ? this.mirror.getId(shadowHost)\r\n                    : this.mirror.getId(n.parentNode);\r\n                const nextId = getNextId(n);\r\n                if (parentId === -1 || nextId === -1) {\r\n                    return addList.addNode(n);\r\n                }\r\n                const sn = serializeNodeWithId(n, {\r\n                    doc: this.doc,\r\n                    mirror: this.mirror,\r\n                    blockClass: this.blockClass,\r\n                    blockSelector: this.blockSelector,\r\n                    maskTextClass: this.maskTextClass,\r\n                    maskTextSelector: this.maskTextSelector,\r\n                    skipChild: true,\r\n                    newlyAddedElement: true,\r\n                    inlineStylesheet: this.inlineStylesheet,\r\n                    maskInputOptions: this.maskInputOptions,\r\n                    maskTextFn: this.maskTextFn,\r\n                    maskInputFn: this.maskInputFn,\r\n                    slimDOMOptions: this.slimDOMOptions,\r\n                    dataURLOptions: this.dataURLOptions,\r\n                    recordCanvas: this.recordCanvas,\r\n                    inlineImages: this.inlineImages,\r\n                    onSerialize: (currentN) => {\r\n                        if (isSerializedIframe(currentN, this.mirror)) {\r\n                            this.iframeManager.addIframe(currentN);\r\n                        }\r\n                        if (isSerializedStylesheet(currentN, this.mirror)) {\r\n                            this.stylesheetManager.trackLinkElement(currentN);\r\n                        }\r\n                        if (hasShadowRoot(n)) {\r\n                            this.shadowDomManager.addShadowRoot(n.shadowRoot, this.doc);\r\n                        }\r\n                    },\r\n                    onIframeLoad: (iframe, childSn) => {\r\n                        this.iframeManager.attachIframe(iframe, childSn);\r\n                        this.shadowDomManager.observeAttachShadow(iframe);\r\n                    },\r\n                    onStylesheetLoad: (link, childSn) => {\r\n                        this.stylesheetManager.attachLinkElement(link, childSn);\r\n                    },\r\n                });\r\n                if (sn) {\r\n                    adds.push({\r\n                        parentId,\r\n                        nextId,\r\n                        node: sn,\r\n                    });\r\n                }\r\n            };\r\n            while (this.mapRemoves.length) {\r\n                this.mirror.removeNodeFromMap(this.mapRemoves.shift());\r\n            }\r\n            for (const n of Array.from(this.movedSet.values())) {\r\n                if (isParentRemoved(this.removes, n, this.mirror) &&\r\n                    !this.movedSet.has(n.parentNode)) {\r\n                    continue;\r\n                }\r\n                pushAdd(n);\r\n            }\r\n            for (const n of Array.from(this.addedSet.values())) {\r\n                if (!isAncestorInSet(this.droppedSet, n) &&\r\n                    !isParentRemoved(this.removes, n, this.mirror)) {\r\n                    pushAdd(n);\r\n                }\r\n                else if (isAncestorInSet(this.movedSet, n)) {\r\n                    pushAdd(n);\r\n                }\r\n                else {\r\n                    this.droppedSet.add(n);\r\n                }\r\n            }\r\n            let candidate = null;\r\n            while (addList.length) {\r\n                let node = null;\r\n                if (candidate) {\r\n                    const parentId = this.mirror.getId(candidate.value.parentNode);\r\n                    const nextId = getNextId(candidate.value);\r\n                    if (parentId !== -1 && nextId !== -1) {\r\n                        node = candidate;\r\n                    }\r\n                }\r\n                if (!node) {\r\n                    for (let index = addList.length - 1; index >= 0; index--) {\r\n                        const _node = addList.get(index);\r\n                        if (_node) {\r\n                            const parentId = this.mirror.getId(_node.value.parentNode);\r\n                            const nextId = getNextId(_node.value);\r\n                            if (nextId === -1)\r\n                                continue;\r\n                            else if (parentId !== -1) {\r\n                                node = _node;\r\n                                break;\r\n                            }\r\n                            else {\r\n                                const unhandledNode = _node.value;\r\n                                if (unhandledNode.parentNode &&\r\n                                    unhandledNode.parentNode.nodeType ===\r\n                                        Node.DOCUMENT_FRAGMENT_NODE) {\r\n                                    const shadowHost = unhandledNode.parentNode\r\n                                        .host;\r\n                                    const parentId = this.mirror.getId(shadowHost);\r\n                                    if (parentId !== -1) {\r\n                                        node = _node;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if (!node) {\r\n                    while (addList.head) {\r\n                        addList.removeNode(addList.head.value);\r\n                    }\r\n                    break;\r\n                }\r\n                candidate = node.previous;\r\n                addList.removeNode(node.value);\r\n                pushAdd(node.value);\r\n            }\r\n            const payload = {\r\n                texts: this.texts\r\n                    .map((text) => ({\r\n                    id: this.mirror.getId(text.node),\r\n                    value: text.value,\r\n                }))\r\n                    .filter((text) => this.mirror.has(text.id)),\r\n                attributes: this.attributes\r\n                    .map((attribute) => ({\r\n                    id: this.mirror.getId(attribute.node),\r\n                    attributes: attribute.attributes,\r\n                }))\r\n                    .filter((attribute) => this.mirror.has(attribute.id)),\r\n                removes: this.removes,\r\n                adds,\r\n            };\r\n            if (!payload.texts.length &&\r\n                !payload.attributes.length &&\r\n                !payload.removes.length &&\r\n                !payload.adds.length) {\r\n                return;\r\n            }\r\n            this.texts = [];\r\n            this.attributes = [];\r\n            this.removes = [];\r\n            this.addedSet = new Set();\r\n            this.movedSet = new Set();\r\n            this.droppedSet = new Set();\r\n            this.movedMap = {};\r\n            this.mutationCb(payload);\r\n        };\r\n        this.processMutation = (m) => {\r\n            if (isIgnored(m.target, this.mirror)) {\r\n                return;\r\n            }\r\n            switch (m.type) {\r\n                case 'characterData': {\r\n                    const value = m.target.textContent;\r\n                    if (!isBlocked(m.target, this.blockClass, this.blockSelector, false) &&\r\n                        value !== m.oldValue) {\r\n                        this.texts.push({\r\n                            value: needMaskingText(m.target, this.maskTextClass, this.maskTextSelector) && value\r\n                                ? this.maskTextFn\r\n                                    ? this.maskTextFn(value)\r\n                                    : value.replace(/[\\S]/g, '*')\r\n                                : value,\r\n                            node: m.target,\r\n                        });\r\n                    }\r\n                    break;\r\n                }\r\n                case 'attributes': {\r\n                    const target = m.target;\r\n                    let value = m.target.getAttribute(m.attributeName);\r\n                    if (m.attributeName === 'value') {\r\n                        value = maskInputValue({\r\n                            maskInputOptions: this.maskInputOptions,\r\n                            tagName: m.target.tagName,\r\n                            type: m.target.getAttribute('type'),\r\n                            value,\r\n                            maskInputFn: this.maskInputFn,\r\n                        });\r\n                    }\r\n                    if (isBlocked(m.target, this.blockClass, this.blockSelector, false) ||\r\n                        value === m.oldValue) {\r\n                        return;\r\n                    }\r\n                    let item = this.attributes.find((a) => a.node === m.target);\r\n                    if (target.tagName === 'IFRAME' &&\r\n                        m.attributeName === 'src' &&\r\n                        !this.keepIframeSrcFn(value)) {\r\n                        if (!target.contentDocument) {\r\n                            m.attributeName = 'rr_src';\r\n                        }\r\n                        else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    if (!item) {\r\n                        item = {\r\n                            node: m.target,\r\n                            attributes: {},\r\n                        };\r\n                        this.attributes.push(item);\r\n                    }\r\n                    if (m.attributeName === 'style') {\r\n                        const old = this.doc.createElement('span');\r\n                        if (m.oldValue) {\r\n                            old.setAttribute('style', m.oldValue);\r\n                        }\r\n                        if (item.attributes.style === undefined ||\r\n                            item.attributes.style === null) {\r\n                            item.attributes.style = {};\r\n                        }\r\n                        const styleObj = item.attributes.style;\r\n                        for (const pname of Array.from(target.style)) {\r\n                            const newValue = target.style.getPropertyValue(pname);\r\n                            const newPriority = target.style.getPropertyPriority(pname);\r\n                            if (newValue !== old.style.getPropertyValue(pname) ||\r\n                                newPriority !== old.style.getPropertyPriority(pname)) {\r\n                                if (newPriority === '') {\r\n                                    styleObj[pname] = newValue;\r\n                                }\r\n                                else {\r\n                                    styleObj[pname] = [newValue, newPriority];\r\n                                }\r\n                            }\r\n                        }\r\n                        for (const pname of Array.from(old.style)) {\r\n                            if (target.style.getPropertyValue(pname) === '') {\r\n                                styleObj[pname] = false;\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        item.attributes[m.attributeName] = transformAttribute(this.doc, target.tagName, m.attributeName, value);\r\n                    }\r\n                    break;\r\n                }\r\n                case 'childList': {\r\n                    if (isBlocked(m.target, this.blockClass, this.blockSelector, true))\r\n                        return;\r\n                    m.addedNodes.forEach((n) => this.genAdds(n, m.target));\r\n                    m.removedNodes.forEach((n) => {\r\n                        const nodeId = this.mirror.getId(n);\r\n                        const parentId = isShadowRoot(m.target)\r\n                            ? this.mirror.getId(m.target.host)\r\n                            : this.mirror.getId(m.target);\r\n                        if (isBlocked(m.target, this.blockClass, this.blockSelector, false) ||\r\n                            isIgnored(n, this.mirror) ||\r\n                            !isSerialized(n, this.mirror)) {\r\n                            return;\r\n                        }\r\n                        if (this.addedSet.has(n)) {\r\n                            deepDelete(this.addedSet, n);\r\n                            this.droppedSet.add(n);\r\n                        }\r\n                        else if (this.addedSet.has(m.target) && nodeId === -1) ;\r\n                        else if (isAncestorRemoved(m.target, this.mirror)) ;\r\n                        else if (this.movedSet.has(n) &&\r\n                            this.movedMap[moveKey(nodeId, parentId)]) {\r\n                            deepDelete(this.movedSet, n);\r\n                        }\r\n                        else {\r\n                            this.removes.push({\r\n                                parentId,\r\n                                id: nodeId,\r\n                                isShadow: isShadowRoot(m.target) && isNativeShadowDom(m.target)\r\n                                    ? true\r\n                                    : undefined,\r\n                            });\r\n                        }\r\n                        this.mapRemoves.push(n);\r\n                    });\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n        this.genAdds = (n, target) => {\r\n            if (this.mirror.hasNode(n)) {\r\n                if (isIgnored(n, this.mirror)) {\r\n                    return;\r\n                }\r\n                this.movedSet.add(n);\r\n                let targetId = null;\r\n                if (target && this.mirror.hasNode(target)) {\r\n                    targetId = this.mirror.getId(target);\r\n                }\r\n                if (targetId && targetId !== -1) {\r\n                    this.movedMap[moveKey(this.mirror.getId(n), targetId)] = true;\r\n                }\r\n            }\r\n            else {\r\n                this.addedSet.add(n);\r\n                this.droppedSet.delete(n);\r\n            }\r\n            if (!isBlocked(n, this.blockClass, this.blockSelector, false))\r\n                n.childNodes.forEach((childN) => this.genAdds(childN));\r\n        };\r\n    }\r\n    init(options) {\r\n        [\r\n            'mutationCb',\r\n            'blockClass',\r\n            'blockSelector',\r\n            'maskTextClass',\r\n            'maskTextSelector',\r\n            'inlineStylesheet',\r\n            'maskInputOptions',\r\n            'maskTextFn',\r\n            'maskInputFn',\r\n            'keepIframeSrcFn',\r\n            'recordCanvas',\r\n            'inlineImages',\r\n            'slimDOMOptions',\r\n            'dataURLOptions',\r\n            'doc',\r\n            'mirror',\r\n            'iframeManager',\r\n            'stylesheetManager',\r\n            'shadowDomManager',\r\n            'canvasManager',\r\n        ].forEach((key) => {\r\n            this[key] = options[key];\r\n        });\r\n    }\r\n    freeze() {\r\n        this.frozen = true;\r\n        this.canvasManager.freeze();\r\n    }\r\n    unfreeze() {\r\n        this.frozen = false;\r\n        this.canvasManager.unfreeze();\r\n        this.emit();\r\n    }\r\n    isFrozen() {\r\n        return this.frozen;\r\n    }\r\n    lock() {\r\n        this.locked = true;\r\n        this.canvasManager.lock();\r\n    }\r\n    unlock() {\r\n        this.locked = false;\r\n        this.canvasManager.unlock();\r\n        this.emit();\r\n    }\r\n    reset() {\r\n        this.shadowDomManager.reset();\r\n        this.canvasManager.reset();\r\n    }\r\n}\r\nfunction deepDelete(addsSet, n) {\r\n    addsSet.delete(n);\r\n    n.childNodes.forEach((childN) => deepDelete(addsSet, childN));\r\n}\r\nfunction isParentRemoved(removes, n, mirror) {\r\n    if (removes.length === 0)\r\n        return false;\r\n    return _isParentRemoved(removes, n, mirror);\r\n}\r\nfunction _isParentRemoved(removes, n, mirror) {\r\n    const { parentNode } = n;\r\n    if (!parentNode) {\r\n        return false;\r\n    }\r\n    const parentId = mirror.getId(parentNode);\r\n    if (removes.some((r) => r.id === parentId)) {\r\n        return true;\r\n    }\r\n    return _isParentRemoved(removes, parentNode, mirror);\r\n}\r\nfunction isAncestorInSet(set, n) {\r\n    if (set.size === 0)\r\n        return false;\r\n    return _isAncestorInSet(set, n);\r\n}\r\nfunction _isAncestorInSet(set, n) {\r\n    const { parentNode } = n;\r\n    if (!parentNode) {\r\n        return false;\r\n    }\r\n    if (set.has(parentNode)) {\r\n        return true;\r\n    }\r\n    return _isAncestorInSet(set, parentNode);\r\n}\n\nexport { MutationBuffer as default };\n", "import { maskInputValue } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { on, throttle, isBlocked, getWindowHeight, getWindowWidth, hookSetter, patch, isTouchEvent } from '../utils.js';\nimport { MouseInteractions, IncrementalSource } from '../../../types/dist/types.js';\nimport MutationBuffer from './mutation.js';\n\nconst mutationBuffers = [];\r\nconst isCSSGroupingRuleSupported = typeof CSSGroupingRule !== 'undefined';\r\nconst isCSSMediaRuleSupported = typeof CSSMediaRule !== 'undefined';\r\nconst isCSSSupportsRuleSupported = typeof CSSSupportsRule !== 'undefined';\r\nconst isCSSConditionRuleSupported = typeof CSSConditionRule !== 'undefined';\r\nfunction getEventTarget(event) {\r\n    try {\r\n        if ('composedPath' in event) {\r\n            const path = event.composedPath();\r\n            if (path.length) {\r\n                return path[0];\r\n            }\r\n        }\r\n        else if ('path' in event && event.path.length) {\r\n            return event.path[0];\r\n        }\r\n        return event.target;\r\n    }\r\n    catch (_a) {\r\n        return event.target;\r\n    }\r\n}\r\nfunction initMutationObserver(options, rootEl) {\r\n    var _a, _b;\r\n    const mutationBuffer = new MutationBuffer();\r\n    mutationBuffers.push(mutationBuffer);\r\n    mutationBuffer.init(options);\r\n    let mutationObserverCtor = window.MutationObserver ||\r\n        window.__rrMutationObserver;\r\n    const angularZoneSymbol = (_b = (_a = window === null || window === void 0 ? void 0 : window.Zone) === null || _a === void 0 ? void 0 : _a.__symbol__) === null || _b === void 0 ? void 0 : _b.call(_a, 'MutationObserver');\r\n    if (angularZoneSymbol &&\r\n        window[angularZoneSymbol]) {\r\n        mutationObserverCtor = window[angularZoneSymbol];\r\n    }\r\n    const observer = new mutationObserverCtor(mutationBuffer.processMutations.bind(mutationBuffer));\r\n    observer.observe(rootEl, {\r\n        attributes: true,\r\n        attributeOldValue: true,\r\n        characterData: true,\r\n        characterDataOldValue: true,\r\n        childList: true,\r\n        subtree: true,\r\n    });\r\n    return observer;\r\n}\r\nfunction initMoveObserver({ mousemoveCb, sampling, doc, mirror, }) {\r\n    if (sampling.mousemove === false) {\r\n        return () => {\r\n        };\r\n    }\r\n    const threshold = typeof sampling.mousemove === 'number' ? sampling.mousemove : 50;\r\n    const callbackThreshold = typeof sampling.mousemoveCallback === 'number'\r\n        ? sampling.mousemoveCallback\r\n        : 500;\r\n    let positions = [];\r\n    let timeBaseline;\r\n    const wrappedCb = throttle((source) => {\r\n        const totalOffset = Date.now() - timeBaseline;\r\n        mousemoveCb(positions.map((p) => {\r\n            p.timeOffset -= totalOffset;\r\n            return p;\r\n        }), source);\r\n        positions = [];\r\n        timeBaseline = null;\r\n    }, callbackThreshold);\r\n    const updatePosition = throttle((evt) => {\r\n        const target = getEventTarget(evt);\r\n        const { clientX, clientY } = isTouchEvent(evt)\r\n            ? evt.changedTouches[0]\r\n            : evt;\r\n        if (!timeBaseline) {\r\n            timeBaseline = Date.now();\r\n        }\r\n        positions.push({\r\n            x: clientX,\r\n            y: clientY,\r\n            id: mirror.getId(target),\r\n            timeOffset: Date.now() - timeBaseline,\r\n        });\r\n        wrappedCb(typeof DragEvent !== 'undefined' && evt instanceof DragEvent\r\n            ? IncrementalSource.Drag\r\n            : evt instanceof MouseEvent\r\n                ? IncrementalSource.MouseMove\r\n                : IncrementalSource.TouchMove);\r\n    }, threshold, {\r\n        trailing: false,\r\n    });\r\n    const handlers = [\r\n        on('mousemove', updatePosition, doc),\r\n        on('touchmove', updatePosition, doc),\r\n        on('drag', updatePosition, doc),\r\n    ];\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initMouseInteractionObserver({ mouseInteractionCb, doc, mirror, blockClass, blockSelector, sampling, }) {\r\n    if (sampling.mouseInteraction === false) {\r\n        return () => {\r\n        };\r\n    }\r\n    const disableMap = sampling.mouseInteraction === true ||\r\n        sampling.mouseInteraction === undefined\r\n        ? {}\r\n        : sampling.mouseInteraction;\r\n    const handlers = [];\r\n    const getHandler = (eventKey) => {\r\n        return (event) => {\r\n            const target = getEventTarget(event);\r\n            if (isBlocked(target, blockClass, blockSelector, true)) {\r\n                return;\r\n            }\r\n            const e = isTouchEvent(event) ? event.changedTouches[0] : event;\r\n            if (!e) {\r\n                return;\r\n            }\r\n            const id = mirror.getId(target);\r\n            const { clientX, clientY } = e;\r\n            mouseInteractionCb({\r\n                type: MouseInteractions[eventKey],\r\n                id,\r\n                x: clientX,\r\n                y: clientY,\r\n            });\r\n        };\r\n    };\r\n    Object.keys(MouseInteractions)\r\n        .filter((key) => Number.isNaN(Number(key)) &&\r\n        !key.endsWith('_Departed') &&\r\n        disableMap[key] !== false)\r\n        .forEach((eventKey) => {\r\n        const eventName = eventKey.toLowerCase();\r\n        const handler = getHandler(eventKey);\r\n        handlers.push(on(eventName, handler, doc));\r\n    });\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initScrollObserver({ scrollCb, doc, mirror, blockClass, blockSelector, sampling, }) {\r\n    const updatePosition = throttle((evt) => {\r\n        const target = getEventTarget(evt);\r\n        if (!target || isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const id = mirror.getId(target);\r\n        if (target === doc) {\r\n            const scrollEl = (doc.scrollingElement || doc.documentElement);\r\n            scrollCb({\r\n                id,\r\n                x: scrollEl.scrollLeft,\r\n                y: scrollEl.scrollTop,\r\n            });\r\n        }\r\n        else {\r\n            scrollCb({\r\n                id,\r\n                x: target.scrollLeft,\r\n                y: target.scrollTop,\r\n            });\r\n        }\r\n    }, sampling.scroll || 100);\r\n    return on('scroll', updatePosition, doc);\r\n}\r\nfunction initViewportResizeObserver({ viewportResizeCb, }) {\r\n    let lastH = -1;\r\n    let lastW = -1;\r\n    const updateDimension = throttle(() => {\r\n        const height = getWindowHeight();\r\n        const width = getWindowWidth();\r\n        if (lastH !== height || lastW !== width) {\r\n            viewportResizeCb({\r\n                width: Number(width),\r\n                height: Number(height),\r\n            });\r\n            lastH = height;\r\n            lastW = width;\r\n        }\r\n    }, 200);\r\n    return on('resize', updateDimension, window);\r\n}\r\nfunction wrapEventWithUserTriggeredFlag(v, enable) {\r\n    const value = Object.assign({}, v);\r\n    if (!enable)\r\n        delete value.userTriggered;\r\n    return value;\r\n}\r\nconst INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\r\nconst lastInputValueMap = new WeakMap();\r\nfunction initInputObserver({ inputCb, doc, mirror, blockClass, blockSelector, ignoreClass, maskInputOptions, maskInputFn, sampling, userTriggeredOnInput, }) {\r\n    function eventHandler(event) {\r\n        let target = getEventTarget(event);\r\n        const userTriggered = event.isTrusted;\r\n        if (target && target.tagName === 'OPTION')\r\n            target = target.parentElement;\r\n        if (!target ||\r\n            !target.tagName ||\r\n            INPUT_TAGS.indexOf(target.tagName) < 0 ||\r\n            isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const type = target.type;\r\n        if (target.classList.contains(ignoreClass)) {\r\n            return;\r\n        }\r\n        let text = target.value;\r\n        let isChecked = false;\r\n        if (type === 'radio' || type === 'checkbox') {\r\n            isChecked = target.checked;\r\n        }\r\n        else if (maskInputOptions[target.tagName.toLowerCase()] ||\r\n            maskInputOptions[type]) {\r\n            text = maskInputValue({\r\n                maskInputOptions,\r\n                tagName: target.tagName,\r\n                type,\r\n                value: text,\r\n                maskInputFn,\r\n            });\r\n        }\r\n        cbWithDedup(target, wrapEventWithUserTriggeredFlag({ text, isChecked, userTriggered }, userTriggeredOnInput));\r\n        const name = target.name;\r\n        if (type === 'radio' && name && isChecked) {\r\n            doc\r\n                .querySelectorAll(`input[type=\"radio\"][name=\"${name}\"]`)\r\n                .forEach((el) => {\r\n                if (el !== target) {\r\n                    cbWithDedup(el, wrapEventWithUserTriggeredFlag({\r\n                        text: el.value,\r\n                        isChecked: !isChecked,\r\n                        userTriggered: false,\r\n                    }, userTriggeredOnInput));\r\n                }\r\n            });\r\n        }\r\n    }\r\n    function cbWithDedup(target, v) {\r\n        const lastInputValue = lastInputValueMap.get(target);\r\n        if (!lastInputValue ||\r\n            lastInputValue.text !== v.text ||\r\n            lastInputValue.isChecked !== v.isChecked) {\r\n            lastInputValueMap.set(target, v);\r\n            const id = mirror.getId(target);\r\n            inputCb(Object.assign(Object.assign({}, v), { id }));\r\n        }\r\n    }\r\n    const events = sampling.input === 'last' ? ['change'] : ['input', 'change'];\r\n    const handlers = events.map((eventName) => on(eventName, eventHandler, doc));\r\n    const currentWindow = doc.defaultView;\r\n    if (!currentWindow) {\r\n        return () => {\r\n            handlers.forEach((h) => h());\r\n        };\r\n    }\r\n    const propertyDescriptor = currentWindow.Object.getOwnPropertyDescriptor(currentWindow.HTMLInputElement.prototype, 'value');\r\n    const hookProperties = [\r\n        [currentWindow.HTMLInputElement.prototype, 'value'],\r\n        [currentWindow.HTMLInputElement.prototype, 'checked'],\r\n        [currentWindow.HTMLSelectElement.prototype, 'value'],\r\n        [currentWindow.HTMLTextAreaElement.prototype, 'value'],\r\n        [currentWindow.HTMLSelectElement.prototype, 'selectedIndex'],\r\n        [currentWindow.HTMLOptionElement.prototype, 'selected'],\r\n    ];\r\n    if (propertyDescriptor && propertyDescriptor.set) {\r\n        handlers.push(...hookProperties.map((p) => hookSetter(p[0], p[1], {\r\n            set() {\r\n                eventHandler({ target: this });\r\n            },\r\n        }, false, currentWindow)));\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction getNestedCSSRulePositions(rule) {\r\n    const positions = [];\r\n    function recurse(childRule, pos) {\r\n        if ((isCSSGroupingRuleSupported &&\r\n            childRule.parentRule instanceof CSSGroupingRule) ||\r\n            (isCSSMediaRuleSupported &&\r\n                childRule.parentRule instanceof CSSMediaRule) ||\r\n            (isCSSSupportsRuleSupported &&\r\n                childRule.parentRule instanceof CSSSupportsRule) ||\r\n            (isCSSConditionRuleSupported &&\r\n                childRule.parentRule instanceof CSSConditionRule)) {\r\n            const rules = Array.from(childRule.parentRule.cssRules);\r\n            const index = rules.indexOf(childRule);\r\n            pos.unshift(index);\r\n        }\r\n        else if (childRule.parentStyleSheet) {\r\n            const rules = Array.from(childRule.parentStyleSheet.cssRules);\r\n            const index = rules.indexOf(childRule);\r\n            pos.unshift(index);\r\n        }\r\n        return pos;\r\n    }\r\n    return recurse(rule, positions);\r\n}\r\nfunction getIdAndStyleId(sheet, mirror, styleMirror) {\r\n    let id, styleId;\r\n    if (!sheet)\r\n        return {};\r\n    if (sheet.ownerNode)\r\n        id = mirror.getId(sheet.ownerNode);\r\n    else\r\n        styleId = styleMirror.getId(sheet);\r\n    return {\r\n        styleId,\r\n        id,\r\n    };\r\n}\r\nfunction initStyleSheetObserver({ styleSheetRuleCb, mirror, stylesheetManager }, { win }) {\r\n    const insertRule = win.CSSStyleSheet.prototype.insertRule;\r\n    win.CSSStyleSheet.prototype.insertRule = function (rule, index) {\r\n        const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleSheetRuleCb({\r\n                id,\r\n                styleId,\r\n                adds: [{ rule, index }],\r\n            });\r\n        }\r\n        return insertRule.apply(this, [rule, index]);\r\n    };\r\n    const deleteRule = win.CSSStyleSheet.prototype.deleteRule;\r\n    win.CSSStyleSheet.prototype.deleteRule = function (index) {\r\n        const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleSheetRuleCb({\r\n                id,\r\n                styleId,\r\n                removes: [{ index }],\r\n            });\r\n        }\r\n        return deleteRule.apply(this, [index]);\r\n    };\r\n    let replace;\r\n    if (win.CSSStyleSheet.prototype.replace) {\r\n        replace = win.CSSStyleSheet.prototype.replace;\r\n        win.CSSStyleSheet.prototype.replace = function (text) {\r\n            const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    replace: text,\r\n                });\r\n            }\r\n            return replace.apply(this, [text]);\r\n        };\r\n    }\r\n    let replaceSync;\r\n    if (win.CSSStyleSheet.prototype.replaceSync) {\r\n        replaceSync = win.CSSStyleSheet.prototype.replaceSync;\r\n        win.CSSStyleSheet.prototype.replaceSync = function (text) {\r\n            const { id, styleId } = getIdAndStyleId(this, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    replaceSync: text,\r\n                });\r\n            }\r\n            return replaceSync.apply(this, [text]);\r\n        };\r\n    }\r\n    const supportedNestedCSSRuleTypes = {};\r\n    if (isCSSGroupingRuleSupported) {\r\n        supportedNestedCSSRuleTypes.CSSGroupingRule = win.CSSGroupingRule;\r\n    }\r\n    else {\r\n        if (isCSSMediaRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSMediaRule = win.CSSMediaRule;\r\n        }\r\n        if (isCSSConditionRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSConditionRule = win.CSSConditionRule;\r\n        }\r\n        if (isCSSSupportsRuleSupported) {\r\n            supportedNestedCSSRuleTypes.CSSSupportsRule = win.CSSSupportsRule;\r\n        }\r\n    }\r\n    const unmodifiedFunctions = {};\r\n    Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\r\n        unmodifiedFunctions[typeKey] = {\r\n            insertRule: type.prototype.insertRule,\r\n            deleteRule: type.prototype.deleteRule,\r\n        };\r\n        type.prototype.insertRule = function (rule, index) {\r\n            const { id, styleId } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    adds: [\r\n                        {\r\n                            rule,\r\n                            index: [\r\n                                ...getNestedCSSRulePositions(this),\r\n                                index || 0,\r\n                            ],\r\n                        },\r\n                    ],\r\n                });\r\n            }\r\n            return unmodifiedFunctions[typeKey].insertRule.apply(this, [rule, index]);\r\n        };\r\n        type.prototype.deleteRule = function (index) {\r\n            const { id, styleId } = getIdAndStyleId(this.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n            if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n                styleSheetRuleCb({\r\n                    id,\r\n                    styleId,\r\n                    removes: [\r\n                        { index: [...getNestedCSSRulePositions(this), index] },\r\n                    ],\r\n                });\r\n            }\r\n            return unmodifiedFunctions[typeKey].deleteRule.apply(this, [index]);\r\n        };\r\n    });\r\n    return () => {\r\n        win.CSSStyleSheet.prototype.insertRule = insertRule;\r\n        win.CSSStyleSheet.prototype.deleteRule = deleteRule;\r\n        replace && (win.CSSStyleSheet.prototype.replace = replace);\r\n        replaceSync && (win.CSSStyleSheet.prototype.replaceSync = replaceSync);\r\n        Object.entries(supportedNestedCSSRuleTypes).forEach(([typeKey, type]) => {\r\n            type.prototype.insertRule = unmodifiedFunctions[typeKey].insertRule;\r\n            type.prototype.deleteRule = unmodifiedFunctions[typeKey].deleteRule;\r\n        });\r\n    };\r\n}\r\nfunction initAdoptedStyleSheetObserver({ mirror, stylesheetManager, }, host) {\r\n    var _a, _b, _c;\r\n    let hostId = null;\r\n    if (host.nodeName === '#document')\r\n        hostId = mirror.getId(host);\r\n    else\r\n        hostId = mirror.getId(host.host);\r\n    const patchTarget = host.nodeName === '#document'\r\n        ? (_a = host.defaultView) === null || _a === void 0 ? void 0 : _a.Document\r\n        : (_c = (_b = host.ownerDocument) === null || _b === void 0 ? void 0 : _b.defaultView) === null || _c === void 0 ? void 0 : _c.ShadowRoot;\r\n    const originalPropertyDescriptor = Object.getOwnPropertyDescriptor(patchTarget === null || patchTarget === void 0 ? void 0 : patchTarget.prototype, 'adoptedStyleSheets');\r\n    if (hostId === null ||\r\n        hostId === -1 ||\r\n        !patchTarget ||\r\n        !originalPropertyDescriptor)\r\n        return () => {\r\n        };\r\n    Object.defineProperty(host, 'adoptedStyleSheets', {\r\n        configurable: originalPropertyDescriptor.configurable,\r\n        enumerable: originalPropertyDescriptor.enumerable,\r\n        get() {\r\n            var _a;\r\n            return (_a = originalPropertyDescriptor.get) === null || _a === void 0 ? void 0 : _a.call(this);\r\n        },\r\n        set(sheets) {\r\n            var _a;\r\n            const result = (_a = originalPropertyDescriptor.set) === null || _a === void 0 ? void 0 : _a.call(this, sheets);\r\n            if (hostId !== null && hostId !== -1) {\r\n                try {\r\n                    stylesheetManager.adoptStyleSheets(sheets, hostId);\r\n                }\r\n                catch (e) {\r\n                }\r\n            }\r\n            return result;\r\n        },\r\n    });\r\n    return () => {\r\n        Object.defineProperty(host, 'adoptedStyleSheets', {\r\n            configurable: originalPropertyDescriptor.configurable,\r\n            enumerable: originalPropertyDescriptor.enumerable,\r\n            get: originalPropertyDescriptor.get,\r\n            set: originalPropertyDescriptor.set,\r\n        });\r\n    };\r\n}\r\nfunction initStyleDeclarationObserver({ styleDeclarationCb, mirror, ignoreCSSAttributes, stylesheetManager, }, { win }) {\r\n    const setProperty = win.CSSStyleDeclaration.prototype.setProperty;\r\n    win.CSSStyleDeclaration.prototype.setProperty = function (property, value, priority) {\r\n        var _a;\r\n        if (ignoreCSSAttributes.has(property)) {\r\n            return setProperty.apply(this, [property, value, priority]);\r\n        }\r\n        const { id, styleId } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleDeclarationCb({\r\n                id,\r\n                styleId,\r\n                set: {\r\n                    property,\r\n                    value,\r\n                    priority,\r\n                },\r\n                index: getNestedCSSRulePositions(this.parentRule),\r\n            });\r\n        }\r\n        return setProperty.apply(this, [property, value, priority]);\r\n    };\r\n    const removeProperty = win.CSSStyleDeclaration.prototype.removeProperty;\r\n    win.CSSStyleDeclaration.prototype.removeProperty = function (property) {\r\n        var _a;\r\n        if (ignoreCSSAttributes.has(property)) {\r\n            return removeProperty.apply(this, [property]);\r\n        }\r\n        const { id, styleId } = getIdAndStyleId((_a = this.parentRule) === null || _a === void 0 ? void 0 : _a.parentStyleSheet, mirror, stylesheetManager.styleMirror);\r\n        if ((id && id !== -1) || (styleId && styleId !== -1)) {\r\n            styleDeclarationCb({\r\n                id,\r\n                styleId,\r\n                remove: {\r\n                    property,\r\n                },\r\n                index: getNestedCSSRulePositions(this.parentRule),\r\n            });\r\n        }\r\n        return removeProperty.apply(this, [property]);\r\n    };\r\n    return () => {\r\n        win.CSSStyleDeclaration.prototype.setProperty = setProperty;\r\n        win.CSSStyleDeclaration.prototype.removeProperty = removeProperty;\r\n    };\r\n}\r\nfunction initMediaInteractionObserver({ mediaInteractionCb, blockClass, blockSelector, mirror, sampling, }) {\r\n    const handler = (type) => throttle((event) => {\r\n        const target = getEventTarget(event);\r\n        if (!target ||\r\n            isBlocked(target, blockClass, blockSelector, true)) {\r\n            return;\r\n        }\r\n        const { currentTime, volume, muted, playbackRate, } = target;\r\n        mediaInteractionCb({\r\n            type,\r\n            id: mirror.getId(target),\r\n            currentTime,\r\n            volume,\r\n            muted,\r\n            playbackRate,\r\n        });\r\n    }, sampling.media || 500);\r\n    const handlers = [\r\n        on('play', handler(0)),\r\n        on('pause', handler(1)),\r\n        on('seeked', handler(2)),\r\n        on('volumechange', handler(3)),\r\n        on('ratechange', handler(4)),\r\n    ];\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initFontObserver({ fontCb, doc }) {\r\n    const win = doc.defaultView;\r\n    if (!win) {\r\n        return () => {\r\n        };\r\n    }\r\n    const handlers = [];\r\n    const fontMap = new WeakMap();\r\n    const originalFontFace = win.FontFace;\r\n    win.FontFace = function FontFace(family, source, descriptors) {\r\n        const fontFace = new originalFontFace(family, source, descriptors);\r\n        fontMap.set(fontFace, {\r\n            family,\r\n            buffer: typeof source !== 'string',\r\n            descriptors,\r\n            fontSource: typeof source === 'string'\r\n                ? source\r\n                : JSON.stringify(Array.from(new Uint8Array(source))),\r\n        });\r\n        return fontFace;\r\n    };\r\n    const restoreHandler = patch(doc.fonts, 'add', function (original) {\r\n        return function (fontFace) {\r\n            setTimeout(() => {\r\n                const p = fontMap.get(fontFace);\r\n                if (p) {\r\n                    fontCb(p);\r\n                    fontMap.delete(fontFace);\r\n                }\r\n            }, 0);\r\n            return original.apply(this, [fontFace]);\r\n        };\r\n    });\r\n    handlers.push(() => {\r\n        win.FontFace = originalFontFace;\r\n    });\r\n    handlers.push(restoreHandler);\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\r\nfunction initSelectionObserver(param) {\r\n    const { doc, mirror, blockClass, blockSelector, selectionCb } = param;\r\n    let collapsed = true;\r\n    const updateSelection = () => {\r\n        const selection = doc.getSelection();\r\n        if (!selection || (collapsed && (selection === null || selection === void 0 ? void 0 : selection.isCollapsed)))\r\n            return;\r\n        collapsed = selection.isCollapsed || false;\r\n        const ranges = [];\r\n        const count = selection.rangeCount || 0;\r\n        for (let i = 0; i < count; i++) {\r\n            const range = selection.getRangeAt(i);\r\n            const { startContainer, startOffset, endContainer, endOffset } = range;\r\n            const blocked = isBlocked(startContainer, blockClass, blockSelector, true) ||\r\n                isBlocked(endContainer, blockClass, blockSelector, true);\r\n            if (blocked)\r\n                continue;\r\n            ranges.push({\r\n                start: mirror.getId(startContainer),\r\n                startOffset,\r\n                end: mirror.getId(endContainer),\r\n                endOffset,\r\n            });\r\n        }\r\n        selectionCb({ ranges });\r\n    };\r\n    updateSelection();\r\n    return on('selectionchange', updateSelection);\r\n}\r\nfunction mergeHooks(o, hooks) {\r\n    const { mutationCb, mousemoveCb, mouseInteractionCb, scrollCb, viewportResizeCb, inputCb, mediaInteractionCb, styleSheetRuleCb, styleDeclarationCb, canvasMutationCb, fontCb, selectionCb, } = o;\r\n    o.mutationCb = (...p) => {\r\n        if (hooks.mutation) {\r\n            hooks.mutation(...p);\r\n        }\r\n        mutationCb(...p);\r\n    };\r\n    o.mousemoveCb = (...p) => {\r\n        if (hooks.mousemove) {\r\n            hooks.mousemove(...p);\r\n        }\r\n        mousemoveCb(...p);\r\n    };\r\n    o.mouseInteractionCb = (...p) => {\r\n        if (hooks.mouseInteraction) {\r\n            hooks.mouseInteraction(...p);\r\n        }\r\n        mouseInteractionCb(...p);\r\n    };\r\n    o.scrollCb = (...p) => {\r\n        if (hooks.scroll) {\r\n            hooks.scroll(...p);\r\n        }\r\n        scrollCb(...p);\r\n    };\r\n    o.viewportResizeCb = (...p) => {\r\n        if (hooks.viewportResize) {\r\n            hooks.viewportResize(...p);\r\n        }\r\n        viewportResizeCb(...p);\r\n    };\r\n    o.inputCb = (...p) => {\r\n        if (hooks.input) {\r\n            hooks.input(...p);\r\n        }\r\n        inputCb(...p);\r\n    };\r\n    o.mediaInteractionCb = (...p) => {\r\n        if (hooks.mediaInteaction) {\r\n            hooks.mediaInteaction(...p);\r\n        }\r\n        mediaInteractionCb(...p);\r\n    };\r\n    o.styleSheetRuleCb = (...p) => {\r\n        if (hooks.styleSheetRule) {\r\n            hooks.styleSheetRule(...p);\r\n        }\r\n        styleSheetRuleCb(...p);\r\n    };\r\n    o.styleDeclarationCb = (...p) => {\r\n        if (hooks.styleDeclaration) {\r\n            hooks.styleDeclaration(...p);\r\n        }\r\n        styleDeclarationCb(...p);\r\n    };\r\n    o.canvasMutationCb = (...p) => {\r\n        if (hooks.canvasMutation) {\r\n            hooks.canvasMutation(...p);\r\n        }\r\n        canvasMutationCb(...p);\r\n    };\r\n    o.fontCb = (...p) => {\r\n        if (hooks.font) {\r\n            hooks.font(...p);\r\n        }\r\n        fontCb(...p);\r\n    };\r\n    o.selectionCb = (...p) => {\r\n        if (hooks.selection) {\r\n            hooks.selection(...p);\r\n        }\r\n        selectionCb(...p);\r\n    };\r\n}\r\nfunction initObservers(o, hooks = {}) {\r\n    const currentWindow = o.doc.defaultView;\r\n    if (!currentWindow) {\r\n        return () => {\r\n        };\r\n    }\r\n    mergeHooks(o, hooks);\r\n    const mutationObserver = initMutationObserver(o, o.doc);\r\n    const mousemoveHandler = initMoveObserver(o);\r\n    const mouseInteractionHandler = initMouseInteractionObserver(o);\r\n    const scrollHandler = initScrollObserver(o);\r\n    const viewportResizeHandler = initViewportResizeObserver(o);\r\n    const inputHandler = initInputObserver(o);\r\n    const mediaInteractionHandler = initMediaInteractionObserver(o);\r\n    const styleSheetObserver = initStyleSheetObserver(o, { win: currentWindow });\r\n    const adoptedStyleSheetObserver = initAdoptedStyleSheetObserver(o, o.doc);\r\n    const styleDeclarationObserver = initStyleDeclarationObserver(o, {\r\n        win: currentWindow,\r\n    });\r\n    const fontObserver = o.collectFonts\r\n        ? initFontObserver(o)\r\n        : () => {\r\n        };\r\n    const selectionObserver = initSelectionObserver(o);\r\n    const pluginHandlers = [];\r\n    for (const plugin of o.plugins) {\r\n        pluginHandlers.push(plugin.observer(plugin.callback, currentWindow, plugin.options));\r\n    }\r\n    return () => {\r\n        mutationBuffers.forEach((b) => b.reset());\r\n        mutationObserver.disconnect();\r\n        mousemoveHandler();\r\n        mouseInteractionHandler();\r\n        scrollHandler();\r\n        viewportResizeHandler();\r\n        inputHandler();\r\n        mediaInteractionHandler();\r\n        styleSheetObserver();\r\n        adoptedStyleSheetObserver();\r\n        styleDeclarationObserver();\r\n        fontObserver();\r\n        selectionObserver();\r\n        pluginHandlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { INPUT_TAGS, initAdoptedStyleSheetObserver, initMutationObserver, initObservers, initScrollObserver, mutationBuffers };\n", "class CrossOriginIframeMirror {\r\n    constructor(generateIdFn) {\r\n        this.generateIdFn = generateIdFn;\r\n        this.iframeIdToRemoteIdMap = new WeakMap();\r\n        this.iframeRemoteIdToIdMap = new WeakMap();\r\n    }\r\n    getId(iframe, remoteId, idToRemoteMap, remoteToIdMap) {\r\n        const idToRemoteIdMap = idToRemoteMap || this.getIdToRemoteIdMap(iframe);\r\n        const remoteIdToIdMap = remoteToIdMap || this.getRemoteIdToIdMap(iframe);\r\n        let id = idToRemoteIdMap.get(remoteId);\r\n        if (!id) {\r\n            id = this.generateIdFn();\r\n            idToRemoteIdMap.set(remoteId, id);\r\n            remoteIdToIdMap.set(id, remoteId);\r\n        }\r\n        return id;\r\n    }\r\n    getIds(iframe, remoteId) {\r\n        const idToRemoteIdMap = this.getIdToRemoteIdMap(iframe);\r\n        const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\r\n        return remoteId.map((id) => this.getId(iframe, id, idToRemoteIdMap, remoteIdToIdMap));\r\n    }\r\n    getRemoteId(iframe, id, map) {\r\n        const remoteIdToIdMap = map || this.getRemoteIdToIdMap(iframe);\r\n        if (typeof id !== 'number')\r\n            return id;\r\n        const remoteId = remoteIdToIdMap.get(id);\r\n        if (!remoteId)\r\n            return -1;\r\n        return remoteId;\r\n    }\r\n    getRemoteIds(iframe, ids) {\r\n        const remoteIdToIdMap = this.getRemoteIdToIdMap(iframe);\r\n        return ids.map((id) => this.getRemoteId(iframe, id, remoteIdToIdMap));\r\n    }\r\n    reset(iframe) {\r\n        if (!iframe) {\r\n            this.iframeIdToRemoteIdMap = new WeakMap();\r\n            this.iframeRemoteIdToIdMap = new WeakMap();\r\n            return;\r\n        }\r\n        this.iframeIdToRemoteIdMap.delete(iframe);\r\n        this.iframeRemoteIdToIdMap.delete(iframe);\r\n    }\r\n    getIdToRemoteIdMap(iframe) {\r\n        let idToRemoteIdMap = this.iframeIdToRemoteIdMap.get(iframe);\r\n        if (!idToRemoteIdMap) {\r\n            idToRemoteIdMap = new Map();\r\n            this.iframeIdToRemoteIdMap.set(iframe, idToRemoteIdMap);\r\n        }\r\n        return idToRemoteIdMap;\r\n    }\r\n    getRemoteIdToIdMap(iframe) {\r\n        let remoteIdToIdMap = this.iframeRemoteIdToIdMap.get(iframe);\r\n        if (!remoteIdToIdMap) {\r\n            remoteIdToIdMap = new Map();\r\n            this.iframeRemoteIdToIdMap.set(iframe, remoteIdToIdMap);\r\n        }\r\n        return remoteIdToIdMap;\r\n    }\r\n}\n\nexport { CrossOriginIframeMirror as default };\n", "import { genId } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport CrossOriginIframeMirror from './cross-origin-iframe-mirror.js';\nimport { EventType, IncrementalSource } from '../../../types/dist/types.js';\n\nclass IframeManager {\r\n    constructor(options) {\r\n        this.iframes = new WeakMap();\r\n        this.crossOriginIframeMap = new WeakMap();\r\n        this.crossOriginIframeMirror = new CrossOriginIframeMirror(genId);\r\n        this.mutationCb = options.mutationCb;\r\n        this.wrappedEmit = options.wrappedEmit;\r\n        this.stylesheetManager = options.stylesheetManager;\r\n        this.recordCrossOriginIframes = options.recordCrossOriginIframes;\r\n        this.crossOriginIframeStyleMirror = new CrossOriginIframeMirror(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror));\r\n        this.mirror = options.mirror;\r\n        if (this.recordCrossOriginIframes) {\r\n            window.addEventListener('message', this.handleMessage.bind(this));\r\n        }\r\n    }\r\n    addIframe(iframeEl) {\r\n        this.iframes.set(iframeEl, true);\r\n        if (iframeEl.contentWindow)\r\n            this.crossOriginIframeMap.set(iframeEl.contentWindow, iframeEl);\r\n    }\r\n    addLoadListener(cb) {\r\n        this.loadListener = cb;\r\n    }\r\n    attachIframe(iframeEl, childSn) {\r\n        var _a;\r\n        this.mutationCb({\r\n            adds: [\r\n                {\r\n                    parentId: this.mirror.getId(iframeEl),\r\n                    nextId: null,\r\n                    node: childSn,\r\n                },\r\n            ],\r\n            removes: [],\r\n            texts: [],\r\n            attributes: [],\r\n            isAttachIframe: true,\r\n        });\r\n        (_a = this.loadListener) === null || _a === void 0 ? void 0 : _a.call(this, iframeEl);\r\n        if (iframeEl.contentDocument &&\r\n            iframeEl.contentDocument.adoptedStyleSheets &&\r\n            iframeEl.contentDocument.adoptedStyleSheets.length > 0)\r\n            this.stylesheetManager.adoptStyleSheets(iframeEl.contentDocument.adoptedStyleSheets, this.mirror.getId(iframeEl.contentDocument));\r\n    }\r\n    handleMessage(message) {\r\n        if (message.data.type === 'rrweb') {\r\n            const iframeSourceWindow = message.source;\r\n            if (!iframeSourceWindow)\r\n                return;\r\n            const iframeEl = this.crossOriginIframeMap.get(message.source);\r\n            if (!iframeEl)\r\n                return;\r\n            const transformedEvent = this.transformCrossOriginEvent(iframeEl, message.data.event);\r\n            if (transformedEvent)\r\n                this.wrappedEmit(transformedEvent, message.data.isCheckout);\r\n        }\r\n    }\r\n    transformCrossOriginEvent(iframeEl, e) {\r\n        var _a;\r\n        switch (e.type) {\r\n            case EventType.FullSnapshot: {\r\n                this.crossOriginIframeMirror.reset(iframeEl);\r\n                this.crossOriginIframeStyleMirror.reset(iframeEl);\r\n                this.replaceIdOnNode(e.data.node, iframeEl);\r\n                return {\r\n                    timestamp: e.timestamp,\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: {\r\n                        source: IncrementalSource.Mutation,\r\n                        adds: [\r\n                            {\r\n                                parentId: this.mirror.getId(iframeEl),\r\n                                nextId: null,\r\n                                node: e.data.node,\r\n                            },\r\n                        ],\r\n                        removes: [],\r\n                        texts: [],\r\n                        attributes: [],\r\n                        isAttachIframe: true,\r\n                    },\r\n                };\r\n            }\r\n            case EventType.Meta:\r\n            case EventType.Load:\r\n            case EventType.DomContentLoaded: {\r\n                return false;\r\n            }\r\n            case EventType.Plugin: {\r\n                return e;\r\n            }\r\n            case EventType.Custom: {\r\n                this.replaceIds(e.data.payload, iframeEl, ['id', 'parentId', 'previousId', 'nextId']);\r\n                return e;\r\n            }\r\n            case EventType.IncrementalSnapshot: {\r\n                switch (e.data.source) {\r\n                    case IncrementalSource.Mutation: {\r\n                        e.data.adds.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, [\r\n                                'parentId',\r\n                                'nextId',\r\n                                'previousId',\r\n                            ]);\r\n                            this.replaceIdOnNode(n.node, iframeEl);\r\n                        });\r\n                        e.data.removes.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, ['parentId', 'id']);\r\n                        });\r\n                        e.data.attributes.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, ['id']);\r\n                        });\r\n                        e.data.texts.forEach((n) => {\r\n                            this.replaceIds(n, iframeEl, ['id']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.Drag:\r\n                    case IncrementalSource.TouchMove:\r\n                    case IncrementalSource.MouseMove: {\r\n                        e.data.positions.forEach((p) => {\r\n                            this.replaceIds(p, iframeEl, ['id']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.ViewportResize: {\r\n                        return false;\r\n                    }\r\n                    case IncrementalSource.MediaInteraction:\r\n                    case IncrementalSource.MouseInteraction:\r\n                    case IncrementalSource.Scroll:\r\n                    case IncrementalSource.CanvasMutation:\r\n                    case IncrementalSource.Input: {\r\n                        this.replaceIds(e.data, iframeEl, ['id']);\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.StyleSheetRule:\r\n                    case IncrementalSource.StyleDeclaration: {\r\n                        this.replaceIds(e.data, iframeEl, ['id']);\r\n                        this.replaceStyleIds(e.data, iframeEl, ['styleId']);\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.Font: {\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.Selection: {\r\n                        e.data.ranges.forEach((range) => {\r\n                            this.replaceIds(range, iframeEl, ['start', 'end']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                    case IncrementalSource.AdoptedStyleSheet: {\r\n                        this.replaceIds(e.data, iframeEl, ['id']);\r\n                        this.replaceStyleIds(e.data, iframeEl, ['styleIds']);\r\n                        (_a = e.data.styles) === null || _a === void 0 ? void 0 : _a.forEach((style) => {\r\n                            this.replaceStyleIds(style, iframeEl, ['styleId']);\r\n                        });\r\n                        return e;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    replace(iframeMirror, obj, iframeEl, keys) {\r\n        for (const key of keys) {\r\n            if (!Array.isArray(obj[key]) && typeof obj[key] !== 'number')\r\n                continue;\r\n            if (Array.isArray(obj[key])) {\r\n                obj[key] = iframeMirror.getIds(iframeEl, obj[key]);\r\n            }\r\n            else {\r\n                obj[key] = iframeMirror.getId(iframeEl, obj[key]);\r\n            }\r\n        }\r\n        return obj;\r\n    }\r\n    replaceIds(obj, iframeEl, keys) {\r\n        return this.replace(this.crossOriginIframeMirror, obj, iframeEl, keys);\r\n    }\r\n    replaceStyleIds(obj, iframeEl, keys) {\r\n        return this.replace(this.crossOriginIframeStyleMirror, obj, iframeEl, keys);\r\n    }\r\n    replaceIdOnNode(node, iframeEl) {\r\n        this.replaceIds(node, iframeEl, ['id']);\r\n        if ('childNodes' in node) {\r\n            node.childNodes.forEach((child) => {\r\n                this.replaceIdOnNode(child, iframeEl);\r\n            });\r\n        }\r\n    }\r\n}\n\nexport { IframeManager };\n", "import { initMutationObserver, initScrollObserver, initAdoptedStyleSheetObserver } from './observer.js';\nimport { patch } from '../utils.js';\nimport { isNativeShadowDom } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\n\nclass ShadowDomManager {\r\n    constructor(options) {\r\n        this.shadowDoms = new WeakSet();\r\n        this.restorePatches = [];\r\n        this.mutationCb = options.mutationCb;\r\n        this.scrollCb = options.scrollCb;\r\n        this.bypassOptions = options.bypassOptions;\r\n        this.mirror = options.mirror;\r\n        const manager = this;\r\n        this.restorePatches.push(patch(Element.prototype, 'attachShadow', function (original) {\r\n            return function (option) {\r\n                const shadowRoot = original.call(this, option);\r\n                if (this.shadowRoot)\r\n                    manager.addShadowRoot(this.shadowRoot, this.ownerDocument);\r\n                return shadowRoot;\r\n            };\r\n        }));\r\n    }\r\n    addShadowRoot(shadowRoot, doc) {\r\n        if (!isNativeShadowDom(shadowRoot))\r\n            return;\r\n        if (this.shadowDoms.has(shadowRoot))\r\n            return;\r\n        this.shadowDoms.add(shadowRoot);\r\n        initMutationObserver(Object.assign(Object.assign({}, this.bypassOptions), { doc, mutationCb: this.mutationCb, mirror: this.mirror, shadowDomManager: this }), shadowRoot);\r\n        initScrollObserver(Object.assign(Object.assign({}, this.bypassOptions), { scrollCb: this.scrollCb, doc: shadowRoot, mirror: this.mirror }));\r\n        setTimeout(() => {\r\n            if (shadowRoot.adoptedStyleSheets &&\r\n                shadowRoot.adoptedStyleSheets.length > 0)\r\n                this.bypassOptions.stylesheetManager.adoptStyleSheets(shadowRoot.adoptedStyleSheets, this.mirror.getId(shadowRoot.host));\r\n            initAdoptedStyleSheetObserver({\r\n                mirror: this.mirror,\r\n                stylesheetManager: this.bypassOptions.stylesheetManager,\r\n            }, shadowRoot);\r\n        }, 0);\r\n    }\r\n    observeAttachShadow(iframeElement) {\r\n        if (iframeElement.contentWindow) {\r\n            const manager = this;\r\n            this.restorePatches.push(patch(iframeElement.contentWindow.HTMLElement.prototype, 'attachShadow', function (original) {\r\n                return function (option) {\r\n                    const shadowRoot = original.call(this, option);\r\n                    if (this.shadowRoot)\r\n                        manager.addShadowRoot(this.shadowRoot, iframeElement.contentDocument);\r\n                    return shadowRoot;\r\n                };\r\n            }));\r\n        }\r\n    }\r\n    reset() {\r\n        this.restorePatches.forEach((restorePatch) => restorePatch());\r\n        this.shadowDoms = new WeakSet();\r\n    }\r\n}\n\nexport { ShadowDomManager };\n", "/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\n\nexport { __awaiter, __rest };\n", "/*\n * base64-arraybuffer 1.0.1 <https://github.com/niklasvh/base64-arraybuffer>\n * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>\n * Released under MIT License\n */\nvar chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n// Use a lookup table to find the index.\nvar lookup = typeof Uint8Array === 'undefined' ? [] : new Uint8Array(256);\nfor (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n}\nvar encode = function (arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer), i, len = bytes.length, base64 = '';\n    for (i = 0; i < len; i += 3) {\n        base64 += chars[bytes[i] >> 2];\n        base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n        base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n        base64 += chars[bytes[i + 2] & 63];\n    }\n    if (len % 3 === 2) {\n        base64 = base64.substring(0, base64.length - 1) + '=';\n    }\n    else if (len % 3 === 1) {\n        base64 = base64.substring(0, base64.length - 2) + '==';\n    }\n    return base64;\n};\nvar decode = function (base64) {\n    var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n    if (base64[base64.length - 1] === '=') {\n        bufferLength--;\n        if (base64[base64.length - 2] === '=') {\n            bufferLength--;\n        }\n    }\n    var arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);\n    for (i = 0; i < len; i += 4) {\n        encoded1 = lookup[base64.charCodeAt(i)];\n        encoded2 = lookup[base64.charCodeAt(i + 1)];\n        encoded3 = lookup[base64.charCodeAt(i + 2)];\n        encoded4 = lookup[base64.charCodeAt(i + 3)];\n        bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n        bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n        bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n    return arraybuffer;\n};\n\nexport { decode, encode };\n", "import { encode } from './../../../../../../ext/base64-arraybuffer/dist/base64-arraybuffer.es5.js';\n\nconst canvasVarMap = new Map();\r\nfunction variableListFor(ctx, ctor) {\r\n    let contextMap = canvasVarMap.get(ctx);\r\n    if (!contextMap) {\r\n        contextMap = new Map();\r\n        canvasVarMap.set(ctx, contextMap);\r\n    }\r\n    if (!contextMap.has(ctor)) {\r\n        contextMap.set(ctor, []);\r\n    }\r\n    return contextMap.get(ctor);\r\n}\r\nconst saveWebGLVar = (value, win, ctx) => {\r\n    if (!value ||\r\n        !(isInstanceOfWebGLObject(value, win) || typeof value === 'object'))\r\n        return;\r\n    const name = value.constructor.name;\r\n    const list = variableListFor(ctx, name);\r\n    let index = list.indexOf(value);\r\n    if (index === -1) {\r\n        index = list.length;\r\n        list.push(value);\r\n    }\r\n    return index;\r\n};\r\nfunction serializeArg(value, win, ctx) {\r\n    if (value instanceof Array) {\r\n        return value.map((arg) => serializeArg(arg, win, ctx));\r\n    }\r\n    else if (value === null) {\r\n        return value;\r\n    }\r\n    else if (value instanceof Float32Array ||\r\n        value instanceof Float64Array ||\r\n        value instanceof Int32Array ||\r\n        value instanceof Uint32Array ||\r\n        value instanceof Uint8Array ||\r\n        value instanceof Uint16Array ||\r\n        value instanceof Int16Array ||\r\n        value instanceof Int8Array ||\r\n        value instanceof Uint8ClampedArray) {\r\n        const name = value.constructor.name;\r\n        return {\r\n            rr_type: name,\r\n            args: [Object.values(value)],\r\n        };\r\n    }\r\n    else if (value instanceof ArrayBuffer) {\r\n        const name = value.constructor.name;\r\n        const base64 = encode(value);\r\n        return {\r\n            rr_type: name,\r\n            base64,\r\n        };\r\n    }\r\n    else if (value instanceof DataView) {\r\n        const name = value.constructor.name;\r\n        return {\r\n            rr_type: name,\r\n            args: [\r\n                serializeArg(value.buffer, win, ctx),\r\n                value.byteOffset,\r\n                value.byteLength,\r\n            ],\r\n        };\r\n    }\r\n    else if (value instanceof HTMLImageElement) {\r\n        const name = value.constructor.name;\r\n        const { src } = value;\r\n        return {\r\n            rr_type: name,\r\n            src,\r\n        };\r\n    }\r\n    else if (value instanceof HTMLCanvasElement) {\r\n        const name = 'HTMLImageElement';\r\n        const src = value.toDataURL();\r\n        return {\r\n            rr_type: name,\r\n            src,\r\n        };\r\n    }\r\n    else if (value instanceof ImageData) {\r\n        const name = value.constructor.name;\r\n        return {\r\n            rr_type: name,\r\n            args: [serializeArg(value.data, win, ctx), value.width, value.height],\r\n        };\r\n    }\r\n    else if (isInstanceOfWebGLObject(value, win) || typeof value === 'object') {\r\n        const name = value.constructor.name;\r\n        const index = saveWebGLVar(value, win, ctx);\r\n        return {\r\n            rr_type: name,\r\n            index: index,\r\n        };\r\n    }\r\n    return value;\r\n}\r\nconst serializeArgs = (args, win, ctx) => {\r\n    return [...args].map((arg) => serializeArg(arg, win, ctx));\r\n};\r\nconst isInstanceOfWebGLObject = (value, win) => {\r\n    const webGLConstructorNames = [\r\n        'WebGLActiveInfo',\r\n        'WebGLBuffer',\r\n        'WebGLFramebuffer',\r\n        'WebGLProgram',\r\n        'WebGLRenderbuffer',\r\n        'WebGLShader',\r\n        'WebGLShaderPrecisionFormat',\r\n        'WebGLTexture',\r\n        'WebGLUniformLocation',\r\n        'WebGLVertexArrayObject',\r\n        'WebGLVertexArrayObjectOES',\r\n    ];\r\n    const supportedWebGLConstructorNames = webGLConstructorNames.filter((name) => typeof win[name] === 'function');\r\n    return Boolean(supportedWebGLConstructorNames.find((name) => value instanceof win[name]));\r\n};\n\nexport { isInstanceOfWebGLObject, saveWebGLVar, serializeArg, serializeArgs, variableListFor };\n", "import { patch, isBlocked } from '../../../utils.js';\n\nfunction initCanvasContextObserver(win, blockClass, blockSelector) {\r\n    const handlers = [];\r\n    try {\r\n        const restoreHandler = patch(win.HTMLCanvasElement.prototype, 'getContext', function (original) {\r\n            return function (contextType, ...args) {\r\n                if (!isBlocked(this, blockClass, blockSelector, true)) {\r\n                    if (!('__context' in this))\r\n                        this.__context = contextType;\r\n                }\r\n                return original.apply(this, [contextType, ...args]);\r\n            };\r\n        });\r\n        handlers.push(restoreHandler);\r\n    }\r\n    catch (_a) {\r\n        console.error('failed to patch HTMLCanvasElement.prototype.getContext');\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { initCanvasContextObserver as default };\n", "import { CanvasContext } from '../../../../../types/dist/types.js';\nimport { patch, isBlocked, hookSetter } from '../../../utils.js';\nimport { saveWebGLVar, serializeArgs } from './serialize-args.js';\n\nfunction patchGLPrototype(prototype, type, cb, blockClass, blockSelector, mirror, win) {\r\n    const handlers = [];\r\n    const props = Object.getOwnPropertyNames(prototype);\r\n    for (const prop of props) {\r\n        if ([\r\n            'isContextLost',\r\n            'canvas',\r\n            'drawingBufferWidth',\r\n            'drawingBufferHeight',\r\n        ].includes(prop)) {\r\n            continue;\r\n        }\r\n        try {\r\n            if (typeof prototype[prop] !== 'function') {\r\n                continue;\r\n            }\r\n            const restoreHandler = patch(prototype, prop, function (original) {\r\n                return function (...args) {\r\n                    const result = original.apply(this, args);\r\n                    saveWebGLVar(result, win, this);\r\n                    if (!isBlocked(this.canvas, blockClass, blockSelector, true)) {\r\n                        const recordArgs = serializeArgs([...args], win, this);\r\n                        const mutation = {\r\n                            type,\r\n                            property: prop,\r\n                            args: recordArgs,\r\n                        };\r\n                        cb(this.canvas, mutation);\r\n                    }\r\n                    return result;\r\n                };\r\n            });\r\n            handlers.push(restoreHandler);\r\n        }\r\n        catch (_a) {\r\n            const hookHandler = hookSetter(prototype, prop, {\r\n                set(v) {\r\n                    cb(this.canvas, {\r\n                        type,\r\n                        property: prop,\r\n                        args: [v],\r\n                        setter: true,\r\n                    });\r\n                },\r\n            });\r\n            handlers.push(hookHandler);\r\n        }\r\n    }\r\n    return handlers;\r\n}\r\nfunction initCanvasWebGLMutationObserver(cb, win, blockClass, blockSelector, mirror) {\r\n    const handlers = [];\r\n    handlers.push(...patchGLPrototype(win.WebGLRenderingContext.prototype, CanvasContext.WebGL, cb, blockClass, blockSelector, mirror, win));\r\n    if (typeof win.WebGL2RenderingContext !== 'undefined') {\r\n        handlers.push(...patchGLPrototype(win.WebGL2RenderingContext.prototype, CanvasContext.WebGL2, cb, blockClass, blockSelector, mirror, win));\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { initCanvasWebGLMutationObserver as default };\n", "var WorkerClass = null;\n\ntry {\n    var WorkerThreads =\n        typeof module !== 'undefined' && typeof module.require === 'function' && module.require('worker_threads') ||\n        typeof __non_webpack_require__ === 'function' && __non_webpack_require__('worker_threads') ||\n        typeof require === 'function' && require('worker_threads');\n    WorkerClass = WorkerThreads.Worker;\n} catch(e) {} // eslint-disable-line\n\nexport { WorkerClass };\n", "import { WorkerClass } from './_rollup-plugin-web-worker-loader__helper__node__WorkerClass.js';\n\nfunction decodeBase64(base64, enableUnicode) {\n    return Buffer.from(base64, 'base64').toString(enableUnicode ? 'utf16' : 'utf8');\n}\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    var sourcemap = sourcemapArg === undefined ? null : sourcemapArg;\n    var enableUnicode = enableUnicodeArg === undefined ? false : enableUnicodeArg;\n    var source = decodeBase64(base64, enableUnicode);\n    var start = source.indexOf('\\n', 10) + 1;\n    var body = source.substring(start) + (sourcemap ? '\\/\\/# sourceMappingURL=' + sourcemap : '');\n    return function WorkerFactory(options) {\n        return new WorkerClass(body, Object.assign({}, options, { eval: true }));\n    };\n}\n\nexport { createBase64WorkerFactory };\n", "function decodeBase64(base64, enableUnicode) {\n    var binaryString = atob(base64);\n    if (enableUnicode) {\n        var binaryView = new Uint8Array(binaryString.length);\n        for (var i = 0, n = binaryString.length; i < n; ++i) {\n            binaryView[i] = binaryString.charCodeAt(i);\n        }\n        return String.fromCharCode.apply(null, new Uint16Array(binaryView.buffer));\n    }\n    return binaryString;\n}\n\nfunction createURL(base64, sourcemapArg, enableUnicodeArg) {\n    var sourcemap = sourcemapArg === undefined ? null : sourcemapArg;\n    var enableUnicode = enableUnicodeArg === undefined ? false : enableUnicodeArg;\n    var source = decodeBase64(base64, enableUnicode);\n    var start = source.indexOf('\\n', 10) + 1;\n    var body = source.substring(start) + (sourcemap ? '\\/\\/# sourceMappingURL=' + sourcemap : '');\n    var blob = new Blob([body], { type: 'application/javascript' });\n    return URL.createObjectURL(blob);\n}\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    var url;\n    return function WorkerFactory(options) {\n        url = url || createURL(base64, sourcemapArg, enableUnicodeArg);\n        return new Worker(url, options);\n    };\n}\n\nexport { createBase64WorkerFactory };\n", "var kIsNodeJS = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\n\nfunction isNodeJS() {\n    return kIsNodeJS;\n}\n\nexport { isNodeJS };\n", "import { createBase64WorkerFactory } from './_rollup-plugin-web-worker-loader__helper__auto__createBase64WorkerFactory.js';\n\nvar WorkerFactory = createBase64WorkerFactory('Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=', null, false);\n/* eslint-enable */\n\nexport { WorkerFactory as default };\n", "import { createBase64WorkerFactory as createBase64WorkerFactory$1 } from './_rollup-plugin-web-worker-loader__helper__node__createBase64WorkerFactory.js';\nimport { createBase64WorkerFactory as createBase64WorkerFactory$2 } from './_rollup-plugin-web-worker-loader__helper__browser__createBase64WorkerFactory.js';\nimport { isNodeJS } from './_rollup-plugin-web-worker-loader__helper__auto__isNodeJS.js';\n\nfunction createBase64WorkerFactory(base64, sourcemapArg, enableUnicodeArg) {\n    if (isNodeJS()) {\n        return createBase64WorkerFactory$1(base64, sourcemapArg, enableUnicodeArg);\n    }\n    return createBase64WorkerFactory$2(base64, sourcemapArg, enableUnicodeArg);\n}\n\nexport { createBase64WorkerFactory };\n", "import { __rest, __awaiter } from './../../../../../../ext/tslib/tslib.es6.js';\nimport { isBlocked } from '../../../utils.js';\nimport { CanvasContext } from '../../../../../types/dist/types.js';\nimport initCanvas2DMutationObserver from './2d.js';\nimport initCanvasContextObserver from './canvas.js';\nimport initCanvasWebGLMutationObserver from './webgl.js';\nimport WorkerFactory from '../../../../../../_virtual/image-bitmap-data-url-worker.js';\n\nclass CanvasManager {\r\n    constructor(options) {\r\n        this.pendingCanvasMutations = new Map();\r\n        this.rafStamps = { latestId: 0, invokeId: null };\r\n        this.frozen = false;\r\n        this.locked = false;\r\n        this.processMutation = (target, mutation) => {\r\n            const newFrame = this.rafStamps.invokeId &&\r\n                this.rafStamps.latestId !== this.rafStamps.invokeId;\r\n            if (newFrame || !this.rafStamps.invokeId)\r\n                this.rafStamps.invokeId = this.rafStamps.latestId;\r\n            if (!this.pendingCanvasMutations.has(target)) {\r\n                this.pendingCanvasMutations.set(target, []);\r\n            }\r\n            this.pendingCanvasMutations.get(target).push(mutation);\r\n        };\r\n        const { sampling = 'all', win, blockClass, blockSelector, recordCanvas, dataURLOptions, } = options;\r\n        this.mutationCb = options.mutationCb;\r\n        this.mirror = options.mirror;\r\n        if (recordCanvas && sampling === 'all')\r\n            this.initCanvasMutationObserver(win, blockClass, blockSelector);\r\n        if (recordCanvas && typeof sampling === 'number')\r\n            this.initCanvasFPSObserver(sampling, win, blockClass, blockSelector, {\r\n                dataURLOptions,\r\n            });\r\n    }\r\n    reset() {\r\n        this.pendingCanvasMutations.clear();\r\n        this.resetObservers && this.resetObservers();\r\n    }\r\n    freeze() {\r\n        this.frozen = true;\r\n    }\r\n    unfreeze() {\r\n        this.frozen = false;\r\n    }\r\n    lock() {\r\n        this.locked = true;\r\n    }\r\n    unlock() {\r\n        this.locked = false;\r\n    }\r\n    initCanvasFPSObserver(fps, win, blockClass, blockSelector, options) {\r\n        const canvasContextReset = initCanvasContextObserver(win, blockClass, blockSelector);\r\n        const snapshotInProgressMap = new Map();\r\n        const worker = new WorkerFactory();\r\n        worker.onmessage = (e) => {\r\n            const { id } = e.data;\r\n            snapshotInProgressMap.set(id, false);\r\n            if (!('base64' in e.data))\r\n                return;\r\n            const { base64, type, width, height } = e.data;\r\n            this.mutationCb({\r\n                id,\r\n                type: CanvasContext['2D'],\r\n                commands: [\r\n                    {\r\n                        property: 'clearRect',\r\n                        args: [0, 0, width, height],\r\n                    },\r\n                    {\r\n                        property: 'drawImage',\r\n                        args: [\r\n                            {\r\n                                rr_type: 'ImageBitmap',\r\n                                args: [\r\n                                    {\r\n                                        rr_type: 'Blob',\r\n                                        data: [{ rr_type: 'ArrayBuffer', base64 }],\r\n                                        type,\r\n                                    },\r\n                                ],\r\n                            },\r\n                            0,\r\n                            0,\r\n                        ],\r\n                    },\r\n                ],\r\n            });\r\n        };\r\n        const timeBetweenSnapshots = 1000 / fps;\r\n        let lastSnapshotTime = 0;\r\n        let rafId;\r\n        const getCanvas = () => {\r\n            const matchedCanvas = [];\r\n            win.document.querySelectorAll('canvas').forEach((canvas) => {\r\n                if (!isBlocked(canvas, blockClass, blockSelector, true)) {\r\n                    matchedCanvas.push(canvas);\r\n                }\r\n            });\r\n            return matchedCanvas;\r\n        };\r\n        const takeCanvasSnapshots = (timestamp) => {\r\n            if (lastSnapshotTime &&\r\n                timestamp - lastSnapshotTime < timeBetweenSnapshots) {\r\n                rafId = requestAnimationFrame(takeCanvasSnapshots);\r\n                return;\r\n            }\r\n            lastSnapshotTime = timestamp;\r\n            getCanvas()\r\n                .forEach((canvas) => __awaiter(this, void 0, void 0, function* () {\r\n                var _a;\r\n                const id = this.mirror.getId(canvas);\r\n                if (snapshotInProgressMap.get(id))\r\n                    return;\r\n                snapshotInProgressMap.set(id, true);\r\n                if (['webgl', 'webgl2'].includes(canvas.__context)) {\r\n                    const context = canvas.getContext(canvas.__context);\r\n                    if (((_a = context === null || context === void 0 ? void 0 : context.getContextAttributes()) === null || _a === void 0 ? void 0 : _a.preserveDrawingBuffer) === false) {\r\n                        context === null || context === void 0 ? void 0 : context.clear(context.COLOR_BUFFER_BIT);\r\n                    }\r\n                }\r\n                const bitmap = yield createImageBitmap(canvas);\r\n                worker.postMessage({\r\n                    id,\r\n                    bitmap,\r\n                    width: canvas.width,\r\n                    height: canvas.height,\r\n                    dataURLOptions: options.dataURLOptions,\r\n                }, [bitmap]);\r\n            }));\r\n            rafId = requestAnimationFrame(takeCanvasSnapshots);\r\n        };\r\n        rafId = requestAnimationFrame(takeCanvasSnapshots);\r\n        this.resetObservers = () => {\r\n            canvasContextReset();\r\n            cancelAnimationFrame(rafId);\r\n        };\r\n    }\r\n    initCanvasMutationObserver(win, blockClass, blockSelector) {\r\n        this.startRAFTimestamping();\r\n        this.startPendingCanvasMutationFlusher();\r\n        const canvasContextReset = initCanvasContextObserver(win, blockClass, blockSelector);\r\n        const canvas2DReset = initCanvas2DMutationObserver(this.processMutation.bind(this), win, blockClass, blockSelector);\r\n        const canvasWebGL1and2Reset = initCanvasWebGLMutationObserver(this.processMutation.bind(this), win, blockClass, blockSelector, this.mirror);\r\n        this.resetObservers = () => {\r\n            canvasContextReset();\r\n            canvas2DReset();\r\n            canvasWebGL1and2Reset();\r\n        };\r\n    }\r\n    startPendingCanvasMutationFlusher() {\r\n        requestAnimationFrame(() => this.flushPendingCanvasMutations());\r\n    }\r\n    startRAFTimestamping() {\r\n        const setLatestRAFTimestamp = (timestamp) => {\r\n            this.rafStamps.latestId = timestamp;\r\n            requestAnimationFrame(setLatestRAFTimestamp);\r\n        };\r\n        requestAnimationFrame(setLatestRAFTimestamp);\r\n    }\r\n    flushPendingCanvasMutations() {\r\n        this.pendingCanvasMutations.forEach((values, canvas) => {\r\n            const id = this.mirror.getId(canvas);\r\n            this.flushPendingCanvasMutationFor(canvas, id);\r\n        });\r\n        requestAnimationFrame(() => this.flushPendingCanvasMutations());\r\n    }\r\n    flushPendingCanvasMutationFor(canvas, id) {\r\n        if (this.frozen || this.locked) {\r\n            return;\r\n        }\r\n        const valuesWithType = this.pendingCanvasMutations.get(canvas);\r\n        if (!valuesWithType || id === -1)\r\n            return;\r\n        const values = valuesWithType.map((value) => {\r\n            const rest = __rest(value, [\"type\"]);\r\n            return rest;\r\n        });\r\n        const { type } = valuesWithType[0];\r\n        this.mutationCb({ id, type, commands: values });\r\n        this.pendingCanvasMutations.delete(canvas);\r\n    }\r\n}\n\nexport { CanvasManager };\n", "import { CanvasContext } from '../../../../../types/dist/types.js';\nimport { patch, isBlocked, hookSetter } from '../../../utils.js';\nimport { serializeArgs } from './serialize-args.js';\n\nfunction initCanvas2DMutationObserver(cb, win, blockClass, blockSelector) {\r\n    const handlers = [];\r\n    const props2D = Object.getOwnPropertyNames(win.CanvasRenderingContext2D.prototype);\r\n    for (const prop of props2D) {\r\n        try {\r\n            if (typeof win.CanvasRenderingContext2D.prototype[prop] !== 'function') {\r\n                continue;\r\n            }\r\n            const restoreHandler = patch(win.CanvasRenderingContext2D.prototype, prop, function (original) {\r\n                return function (...args) {\r\n                    if (!isBlocked(this.canvas, blockClass, blockSelector, true)) {\r\n                        setTimeout(() => {\r\n                            const recordArgs = serializeArgs([...args], win, this);\r\n                            cb(this.canvas, {\r\n                                type: CanvasContext['2D'],\r\n                                property: prop,\r\n                                args: recordArgs,\r\n                            });\r\n                        }, 0);\r\n                    }\r\n                    return original.apply(this, args);\r\n                };\r\n            });\r\n            handlers.push(restoreHandler);\r\n        }\r\n        catch (_a) {\r\n            const hookHandler = hookSetter(win.CanvasRenderingContext2D.prototype, prop, {\r\n                set(v) {\r\n                    cb(this.canvas, {\r\n                        type: CanvasContext['2D'],\r\n                        property: prop,\r\n                        args: [v],\r\n                        setter: true,\r\n                    });\r\n                },\r\n            });\r\n            handlers.push(hookHandler);\r\n        }\r\n    }\r\n    return () => {\r\n        handlers.forEach((h) => h());\r\n    };\r\n}\n\nexport { initCanvas2DMutationObserver as default };\n", "import { getCssRuleString } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { StyleSheetMirror } from '../utils.js';\n\nclass StylesheetManager {\r\n    constructor(options) {\r\n        this.trackedLinkElements = new WeakSet();\r\n        this.styleMirror = new StyleSheetMirror();\r\n        this.mutationCb = options.mutationCb;\r\n        this.adoptedStyleSheetCb = options.adoptedStyleSheetCb;\r\n    }\r\n    attachLinkElement(linkEl, childSn) {\r\n        if ('_cssText' in childSn.attributes)\r\n            this.mutationCb({\r\n                adds: [],\r\n                removes: [],\r\n                texts: [],\r\n                attributes: [\r\n                    {\r\n                        id: childSn.id,\r\n                        attributes: childSn\r\n                            .attributes,\r\n                    },\r\n                ],\r\n            });\r\n        this.trackLinkElement(linkEl);\r\n    }\r\n    trackLinkElement(linkEl) {\r\n        if (this.trackedLinkElements.has(linkEl))\r\n            return;\r\n        this.trackedLinkElements.add(linkEl);\r\n        this.trackStylesheetInLinkElement(linkEl);\r\n    }\r\n    adoptStyleSheets(sheets, hostId) {\r\n        if (sheets.length === 0)\r\n            return;\r\n        const adoptedStyleSheetData = {\r\n            id: hostId,\r\n            styleIds: [],\r\n        };\r\n        const styles = [];\r\n        for (const sheet of sheets) {\r\n            let styleId;\r\n            if (!this.styleMirror.has(sheet)) {\r\n                styleId = this.styleMirror.add(sheet);\r\n                const rules = Array.from(sheet.rules || CSSRule);\r\n                styles.push({\r\n                    styleId,\r\n                    rules: rules.map((r, index) => {\r\n                        return {\r\n                            rule: getCssRuleString(r),\r\n                            index,\r\n                        };\r\n                    }),\r\n                });\r\n            }\r\n            else\r\n                styleId = this.styleMirror.getId(sheet);\r\n            adoptedStyleSheetData.styleIds.push(styleId);\r\n        }\r\n        if (styles.length > 0)\r\n            adoptedStyleSheetData.styles = styles;\r\n        this.adoptedStyleSheetCb(adoptedStyleSheetData);\r\n    }\r\n    reset() {\r\n        this.styleMirror.reset();\r\n        this.trackedLinkElements = new WeakSet();\r\n    }\r\n    trackStylesheetInLinkElement(linkEl) {\r\n    }\r\n}\n\nexport { StylesheetManager };\n", "import { createMirror, snapshot } from '../../../rrweb-snapshot/es/rrweb-snapshot.js';\nimport { initObservers, mutationBuffers } from './observer.js';\nimport { polyfill, on, getWindowWidth, getWindowHeight, isSerializedIframe, isSerializedStylesheet, hasShadowRoot } from '../utils.js';\nimport { EventType, IncrementalSource } from '../../../types/dist/types.js';\nimport { IframeManager } from './iframe-manager.js';\nimport { ShadowDomManager } from './shadow-dom-manager.js';\nimport { CanvasManager } from './observers/canvas/canvas-manager.js';\nimport { StylesheetManager } from './stylesheet-manager.js';\n\nfunction wrapEvent(e) {\r\n    return Object.assign(Object.assign({}, e), { timestamp: Date.now() });\r\n}\r\nlet wrappedEmit;\r\nlet takeFullSnapshot;\r\nlet canvasManager;\r\nlet recording = false;\r\nconst mirror = createMirror();\r\nfunction record(options = {}) {\r\n    const { emit, checkoutEveryNms, checkoutEveryNth, blockClass = 'rr-block', blockSelector = null, ignoreClass = 'rr-ignore', maskTextClass = 'rr-mask', maskTextSelector = null, inlineStylesheet = true, maskAllInputs, maskInputOptions: _maskInputOptions, slimDOMOptions: _slimDOMOptions, maskInputFn, maskTextFn, hooks, packFn, sampling = {}, dataURLOptions = {}, mousemoveWait, recordCanvas = false, recordCrossOriginIframes = false, userTriggeredOnInput = false, collectFonts = false, inlineImages = false, plugins, keepIframeSrcFn = () => false, ignoreCSSAttributes = new Set([]), } = options;\r\n    const inEmittingFrame = recordCrossOriginIframes\r\n        ? window.parent === window\r\n        : true;\r\n    let passEmitsToParent = false;\r\n    if (!inEmittingFrame) {\r\n        try {\r\n            window.parent.document;\r\n            passEmitsToParent = false;\r\n        }\r\n        catch (e) {\r\n            passEmitsToParent = true;\r\n        }\r\n    }\r\n    if (inEmittingFrame && !emit) {\r\n        throw new Error('emit function is required');\r\n    }\r\n    if (mousemoveWait !== undefined && sampling.mousemove === undefined) {\r\n        sampling.mousemove = mousemoveWait;\r\n    }\r\n    mirror.reset();\r\n    const maskInputOptions = maskAllInputs === true\r\n        ? {\r\n            color: true,\r\n            date: true,\r\n            'datetime-local': true,\r\n            email: true,\r\n            month: true,\r\n            number: true,\r\n            range: true,\r\n            search: true,\r\n            tel: true,\r\n            text: true,\r\n            time: true,\r\n            url: true,\r\n            week: true,\r\n            textarea: true,\r\n            select: true,\r\n            password: true,\r\n        }\r\n        : _maskInputOptions !== undefined\r\n            ? _maskInputOptions\r\n            : { password: true };\r\n    const slimDOMOptions = _slimDOMOptions === true || _slimDOMOptions === 'all'\r\n        ? {\r\n            script: true,\r\n            comment: true,\r\n            headFavicon: true,\r\n            headWhitespace: true,\r\n            headMetaSocial: true,\r\n            headMetaRobots: true,\r\n            headMetaHttpEquiv: true,\r\n            headMetaVerification: true,\r\n            headMetaAuthorship: _slimDOMOptions === 'all',\r\n            headMetaDescKeywords: _slimDOMOptions === 'all',\r\n        }\r\n        : _slimDOMOptions\r\n            ? _slimDOMOptions\r\n            : {};\r\n    polyfill();\r\n    let lastFullSnapshotEvent;\r\n    let incrementalSnapshotCount = 0;\r\n    const eventProcessor = (e) => {\r\n        for (const plugin of plugins || []) {\r\n            if (plugin.eventProcessor) {\r\n                e = plugin.eventProcessor(e);\r\n            }\r\n        }\r\n        if (packFn) {\r\n            e = packFn(e);\r\n        }\r\n        return e;\r\n    };\r\n    wrappedEmit = (e, isCheckout) => {\r\n        var _a;\r\n        if (((_a = mutationBuffers[0]) === null || _a === void 0 ? void 0 : _a.isFrozen()) &&\r\n            e.type !== EventType.FullSnapshot &&\r\n            !(e.type === EventType.IncrementalSnapshot &&\r\n                e.data.source === IncrementalSource.Mutation)) {\r\n            mutationBuffers.forEach((buf) => buf.unfreeze());\r\n        }\r\n        if (inEmittingFrame) {\r\n            emit === null || emit === void 0 ? void 0 : emit(eventProcessor(e), isCheckout);\r\n        }\r\n        else if (passEmitsToParent) {\r\n            const message = {\r\n                type: 'rrweb',\r\n                event: eventProcessor(e),\r\n                isCheckout,\r\n            };\r\n            window.parent.postMessage(message, '*');\r\n        }\r\n        if (e.type === EventType.FullSnapshot) {\r\n            lastFullSnapshotEvent = e;\r\n            incrementalSnapshotCount = 0;\r\n        }\r\n        else if (e.type === EventType.IncrementalSnapshot) {\r\n            if (e.data.source === IncrementalSource.Mutation &&\r\n                e.data.isAttachIframe) {\r\n                return;\r\n            }\r\n            incrementalSnapshotCount++;\r\n            const exceedCount = checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\r\n            const exceedTime = checkoutEveryNms &&\r\n                e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\r\n            if (exceedCount || exceedTime) {\r\n                takeFullSnapshot(true);\r\n            }\r\n        }\r\n    };\r\n    const wrappedMutationEmit = (m) => {\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.IncrementalSnapshot,\r\n            data: Object.assign({ source: IncrementalSource.Mutation }, m),\r\n        }));\r\n    };\r\n    const wrappedScrollEmit = (p) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.Scroll }, p),\r\n    }));\r\n    const wrappedCanvasMutationEmit = (p) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.CanvasMutation }, p),\r\n    }));\r\n    const wrappedAdoptedStyleSheetEmit = (a) => wrappedEmit(wrapEvent({\r\n        type: EventType.IncrementalSnapshot,\r\n        data: Object.assign({ source: IncrementalSource.AdoptedStyleSheet }, a),\r\n    }));\r\n    const stylesheetManager = new StylesheetManager({\r\n        mutationCb: wrappedMutationEmit,\r\n        adoptedStyleSheetCb: wrappedAdoptedStyleSheetEmit,\r\n    });\r\n    const iframeManager = new IframeManager({\r\n        mirror,\r\n        mutationCb: wrappedMutationEmit,\r\n        stylesheetManager: stylesheetManager,\r\n        recordCrossOriginIframes,\r\n        wrappedEmit,\r\n    });\r\n    for (const plugin of plugins || []) {\r\n        if (plugin.getMirror)\r\n            plugin.getMirror({\r\n                nodeMirror: mirror,\r\n                crossOriginIframeMirror: iframeManager.crossOriginIframeMirror,\r\n                crossOriginIframeStyleMirror: iframeManager.crossOriginIframeStyleMirror,\r\n            });\r\n    }\r\n    canvasManager = new CanvasManager({\r\n        recordCanvas,\r\n        mutationCb: wrappedCanvasMutationEmit,\r\n        win: window,\r\n        blockClass,\r\n        blockSelector,\r\n        mirror,\r\n        sampling: sampling.canvas,\r\n        dataURLOptions,\r\n    });\r\n    const shadowDomManager = new ShadowDomManager({\r\n        mutationCb: wrappedMutationEmit,\r\n        scrollCb: wrappedScrollEmit,\r\n        bypassOptions: {\r\n            blockClass,\r\n            blockSelector,\r\n            maskTextClass,\r\n            maskTextSelector,\r\n            inlineStylesheet,\r\n            maskInputOptions,\r\n            dataURLOptions,\r\n            maskTextFn,\r\n            maskInputFn,\r\n            recordCanvas,\r\n            inlineImages,\r\n            sampling,\r\n            slimDOMOptions,\r\n            iframeManager,\r\n            stylesheetManager,\r\n            canvasManager,\r\n            keepIframeSrcFn,\r\n        },\r\n        mirror,\r\n    });\r\n    takeFullSnapshot = (isCheckout = false) => {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.Meta,\r\n            data: {\r\n                href: window.location.href,\r\n                width: getWindowWidth(),\r\n                height: getWindowHeight(),\r\n            },\r\n        }), isCheckout);\r\n        stylesheetManager.reset();\r\n        mutationBuffers.forEach((buf) => buf.lock());\r\n        const node = snapshot(document, {\r\n            mirror,\r\n            blockClass,\r\n            blockSelector,\r\n            maskTextClass,\r\n            maskTextSelector,\r\n            inlineStylesheet,\r\n            maskAllInputs: maskInputOptions,\r\n            maskTextFn,\r\n            slimDOM: slimDOMOptions,\r\n            dataURLOptions,\r\n            recordCanvas,\r\n            inlineImages,\r\n            onSerialize: (n) => {\r\n                if (isSerializedIframe(n, mirror)) {\r\n                    iframeManager.addIframe(n);\r\n                }\r\n                if (isSerializedStylesheet(n, mirror)) {\r\n                    stylesheetManager.trackLinkElement(n);\r\n                }\r\n                if (hasShadowRoot(n)) {\r\n                    shadowDomManager.addShadowRoot(n.shadowRoot, document);\r\n                }\r\n            },\r\n            onIframeLoad: (iframe, childSn) => {\r\n                iframeManager.attachIframe(iframe, childSn);\r\n                shadowDomManager.observeAttachShadow(iframe);\r\n            },\r\n            onStylesheetLoad: (linkEl, childSn) => {\r\n                stylesheetManager.attachLinkElement(linkEl, childSn);\r\n            },\r\n            keepIframeSrcFn,\r\n        });\r\n        if (!node) {\r\n            return console.warn('Failed to snapshot the document');\r\n        }\r\n        wrappedEmit(wrapEvent({\r\n            type: EventType.FullSnapshot,\r\n            data: {\r\n                node,\r\n                initialOffset: {\r\n                    left: window.pageXOffset !== undefined\r\n                        ? window.pageXOffset\r\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollLeft) ||\r\n                            ((_b = (_a = document === null || document === void 0 ? void 0 : document.body) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.scrollLeft) ||\r\n                            ((_c = document === null || document === void 0 ? void 0 : document.body) === null || _c === void 0 ? void 0 : _c.scrollLeft) ||\r\n                            0,\r\n                    top: window.pageYOffset !== undefined\r\n                        ? window.pageYOffset\r\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollTop) ||\r\n                            ((_e = (_d = document === null || document === void 0 ? void 0 : document.body) === null || _d === void 0 ? void 0 : _d.parentElement) === null || _e === void 0 ? void 0 : _e.scrollTop) ||\r\n                            ((_f = document === null || document === void 0 ? void 0 : document.body) === null || _f === void 0 ? void 0 : _f.scrollTop) ||\r\n                            0,\r\n                },\r\n            },\r\n        }));\r\n        mutationBuffers.forEach((buf) => buf.unlock());\r\n        if (document.adoptedStyleSheets && document.adoptedStyleSheets.length > 0)\r\n            stylesheetManager.adoptStyleSheets(document.adoptedStyleSheets, mirror.getId(document));\r\n    };\r\n    try {\r\n        const handlers = [];\r\n        handlers.push(on('DOMContentLoaded', () => {\r\n            wrappedEmit(wrapEvent({\r\n                type: EventType.DomContentLoaded,\r\n                data: {},\r\n            }));\r\n        }));\r\n        const observe = (doc) => {\r\n            var _a;\r\n            return initObservers({\r\n                mutationCb: wrappedMutationEmit,\r\n                mousemoveCb: (positions, source) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: {\r\n                        source,\r\n                        positions,\r\n                    },\r\n                })),\r\n                mouseInteractionCb: (d) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.MouseInteraction }, d),\r\n                })),\r\n                scrollCb: wrappedScrollEmit,\r\n                viewportResizeCb: (d) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.ViewportResize }, d),\r\n                })),\r\n                inputCb: (v) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.Input }, v),\r\n                })),\r\n                mediaInteractionCb: (p) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.MediaInteraction }, p),\r\n                })),\r\n                styleSheetRuleCb: (r) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.StyleSheetRule }, r),\r\n                })),\r\n                styleDeclarationCb: (r) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.StyleDeclaration }, r),\r\n                })),\r\n                canvasMutationCb: wrappedCanvasMutationEmit,\r\n                fontCb: (p) => wrappedEmit(wrapEvent({\r\n                    type: EventType.IncrementalSnapshot,\r\n                    data: Object.assign({ source: IncrementalSource.Font }, p),\r\n                })),\r\n                selectionCb: (p) => {\r\n                    wrappedEmit(wrapEvent({\r\n                        type: EventType.IncrementalSnapshot,\r\n                        data: Object.assign({ source: IncrementalSource.Selection }, p),\r\n                    }));\r\n                },\r\n                blockClass,\r\n                ignoreClass,\r\n                maskTextClass,\r\n                maskTextSelector,\r\n                maskInputOptions,\r\n                inlineStylesheet,\r\n                sampling,\r\n                recordCanvas,\r\n                inlineImages,\r\n                userTriggeredOnInput,\r\n                collectFonts,\r\n                doc,\r\n                maskInputFn,\r\n                maskTextFn,\r\n                keepIframeSrcFn,\r\n                blockSelector,\r\n                slimDOMOptions,\r\n                dataURLOptions,\r\n                mirror,\r\n                iframeManager,\r\n                stylesheetManager,\r\n                shadowDomManager,\r\n                canvasManager,\r\n                ignoreCSSAttributes,\r\n                plugins: ((_a = plugins === null || plugins === void 0 ? void 0 : plugins.filter((p) => p.observer)) === null || _a === void 0 ? void 0 : _a.map((p) => ({\r\n                    observer: p.observer,\r\n                    options: p.options,\r\n                    callback: (payload) => wrappedEmit(wrapEvent({\r\n                        type: EventType.Plugin,\r\n                        data: {\r\n                            plugin: p.name,\r\n                            payload,\r\n                        },\r\n                    })),\r\n                }))) || [],\r\n            }, hooks);\r\n        };\r\n        iframeManager.addLoadListener((iframeEl) => {\r\n            handlers.push(observe(iframeEl.contentDocument));\r\n        });\r\n        const init = () => {\r\n            takeFullSnapshot();\r\n            handlers.push(observe(document));\r\n            recording = true;\r\n        };\r\n        if (document.readyState === 'interactive' ||\r\n            document.readyState === 'complete') {\r\n            init();\r\n        }\r\n        else {\r\n            handlers.push(on('load', () => {\r\n                wrappedEmit(wrapEvent({\r\n                    type: EventType.Load,\r\n                    data: {},\r\n                }));\r\n                init();\r\n            }, window));\r\n        }\r\n        return () => {\r\n            handlers.forEach((h) => h());\r\n            recording = false;\r\n        };\r\n    }\r\n    catch (error) {\r\n        console.warn(error);\r\n    }\r\n}\r\nrecord.addCustomEvent = (tag, payload) => {\r\n    if (!recording) {\r\n        throw new Error('please add custom event after start recording');\r\n    }\r\n    wrappedEmit(wrapEvent({\r\n        type: EventType.Custom,\r\n        data: {\r\n            tag,\r\n            payload,\r\n        },\r\n    }));\r\n};\r\nrecord.freezePage = () => {\r\n    mutationBuffers.forEach((buf) => buf.freeze());\r\n};\r\nrecord.takeFullSnapshot = (isCheckout) => {\r\n    if (!recording) {\r\n        throw new Error('please take full snapshot after start recording');\r\n    }\r\n    takeFullSnapshot(isCheckout);\r\n};\r\nrecord.mirror = mirror;\n\nexport { record as default };\n", null, null, null, null, null, null, null],
  "mappings": "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",
  "names": ["module", "_", "window", "TraceKit", "_oldTraceKit", "_slice", "slice", "UNKNOWN_FUNCTION", "ERROR_TYPES_RE", "noConflict", "wrap", "func", "apply", "this", "arguments", "e", "report", "_oldOnerrorHandler", "_onErrorHandlerInstalled", "_oldOnunhandledrejectionHandler", "_onUnhandledRejectionHandlerInstalled", "handlers", "lastException", "lastExceptionStack", "notifyHandlers", "stack", "isWindowError", "error", "exception", "collectWindowErrors", "i", "_has", "inner", "traceKitWindowOnError", "message", "url", "lineNo", "columnNo", "errorObj", "computeStackTrace", "augmentStackTraceWithInitialElement", "processLastException", "name", "location", "line", "column", "msg", "toString", "call", "groups", "match", "guessFunctionName", "context", "gatherContext", "mode", "traceKitWindowOnUnhandledRejection", "reason", "_lastExceptionStack", "_lastException", "ex", "setTimeout", "incomplete", "subscribe", "handler", "onerror", "installGlobalHandler", "onunhandledrejection", "installGlobalUnhandledRejectionHandler", "push", "unsubscribe", "length", "splice", "sourceCache", "getSource", "source", "domain", "document", "exec", "remoteFetching", "request", "XMLHttpRequest", "ActiveXObject", "getXHR", "open", "send", "responseText", "split", "m", "reFunctionArgNames", "reGuessFunction", "_isUndefined", "linesBefore", "Math", "floor", "linesOfContext", "linesAfter", "start", "max", "end", "min", "escapeRegExp", "text", "replace", "escapeCodeAsRegExpForMatchingInsideHTML", "body", "findSourceInUrls", "re", "urls", "j", "join", "substring", "index", "lastIndexOf", "findSourceInLine", "fragment", "RegExp", "findSourceByFunctionBody", "parts", "result", "href", "scripts", "getElementsByTagName", "code", "script", "src", "args", "event", "computeStackTraceFromStackProp", "submatch", "element", "chrome", "gecko", "winjs", "geckoEval", "chromeEval", "lines", "reference", "isNative", "indexOf", "columnNumber", "stackInfo", "initial", "unshift", "partial", "computeStackTraceByWalkingCallerChain", "depth", "item", "functionName", "funcs", "recursion", "curr", "caller", "input", "description", "sourceURL", "fileName", "lineNumber", "stacktrace", "opera10Regex", "opera11Regex", "exc", "lineRE1", "lineRE2", "lineRE3", "inlineScriptBlocks", "s", "relativeLine", "pos", "innerText", "midline", "ofCaller", "Error", "extendToAsynchronousCallbacks", "_helper", "fnName", "originalFn", "originalCallback", "t", "module", "exports", "object", "key", "Object", "prototype", "hasOwnProperty", "what", "global", "getTarget", "target", "_a", "isNode", "parentNode", "elementToString", "tagName", "components", "toLowerCase", "id", "className", "value", "includes", "toSelector", "options", "maxDepth", "ptr", "asString", "reverse", "ClickCollector", "constructor", "addEventListener", "breadcrumb", "class", "type", "level", "timestamp", "Date", "now", "destination", "addBreadcrumb", "telemetry", "_sessionId", "unregister", "INPUT_TAG_NAMES", "KeypressCollector", "htmlElement", "isContentEditable", "shouldDeduplicate", "lastEvent", "crumb", "timeDiff", "abs", "ErrorCollector", "captureErrorEvent", "captureError", "filterHttpBreadcrumb", "filters", "n", "data", "urlFilters", "reduce", "filtered", "filter", "originalFetch", "fetch", "processFetchArgs", "init", "method", "Request", "URL", "FetchCollector", "callback", "wrapper", "then", "response", "ok", "assign", "statusCode", "status", "statusText", "defineProperty", "writable", "configurable", "LD_ORIGINAL_XHR", "LD_ORIGINAL_XHR_OPEN", "LD_ORIGINAL_XHR_SEND", "LD_DATA_XHR", "originalOpen", "originalSend", "XhrCollector", "_event", "xhrData", "defineProperties", "pollingRegex", "streamingREgex", "defaultUrlFilter", "regexMatch", "repeat", "_b", "timeLow", "timeMid", "timeHiAndVersion", "clockSeqHiAndReserved", "clockSeqLow", "nodes", "hex", "bytes", "range", "strVal", "padStart", "fallbackUuidV4", "crypto", "getRandomValues", "typedArray", "Uint8Array", "values", "random", "getRandom128bit", "INDEX_SPECIFIER", "processUrlToFileName", "origin", "cleaned", "startsWith", "endsWith", "trimSourceLine", "maxLength", "captureStart", "beforeColumnCharacters", "captureEnd", "getLines", "trimmer", "adjustedStart", "adjustedEnd", "map", "parse", "frames", "inFrame", "function", "col", "maxLineLength", "srcBefore", "beforeLines", "srcLine", "srcAfter", "afterLines", "CUSTOM_KEY_PREFIX", "ERROR_KEY", "SESSION_CAPTURE_KEY", "GENERIC_EXCEPTION", "safeValue", "u", "BrowserTelemetryImpl", "pendingEvents", "breadcrumbs", "inspectorInstances", "collectors", "sessionId", "undefined", "randomUUID", "beforeAfterMax", "maxPendingEvents", "maxBreadcrumbs", "http", "customUrlFilter", "instrumentFetch", "instrumentXhr", "click", "keyboardInput", "forEach", "collector", "register", "inspectors", "evaluations", "synchronous", "flagKey", "flagDetail", "handleFlagUsed", "flagChange", "detail", "handleFlagDetailChanged", "client", "track", "shift", "capture", "dispatchError", "errorEvent", "sessionEvent", "close", "getTime", "dispatchFlagUsed", "dispatchFlagDetailChanged", "handleErrorEvent", "NodeType", "isShadowRoot", "host", "Boolean", "shadowRoot", "isNativeShadowDom", "getCssRulesString", "rules", "cssRules", "cssText", "Array", "from", "getCssRuleString", "rule", "cssStringified", "styleSheet", "Mirror", "idNodeMap", "Map", "nodeMetaMap", "WeakMap", "getId", "getMeta", "getNode", "get", "getIds", "keys", "removeNodeFromMap", "_this", "childNodes", "childNode", "has", "hasNode", "node", "add", "meta", "set", "oldNode", "reset", "maskInputValue", "maskInputOptions", "maskInputFn", "ORIGINAL_ATTRIBUTE_NAME", "canvasService", "canvasCtx", "_id", "tagNameRegex", "IGNORED_NODE", "genId", "URL_IN_CSS_REF", "RELATIVE_PATH", "DATA_URI", "absoluteToStylesheet", "quote1", "path1", "quote2", "path2", "path3", "filePath", "maybeQuote", "test", "concat", "pop", "_i", "parts_1", "part", "SRCSET_NOT_SPACES", "SRCSET_COMMAS_OR_SPACES", "absoluteToDoc", "doc", "attributeValue", "trim", "a", "createElement", "isSVGElement", "el", "ownerSVGElement", "getHref", "transformAttribute", "collectCharacters", "regEx", "chars", "output", "descriptorsStr", "inParens", "c", "charAt", "classMatchesRegex", "regex", "checkAncestors", "nodeType", "ELEMENT_NODE", "eIndex", "classList", "needMaskingText", "maskTextClass", "maskTextSelector", "parentElement", "contains", "closest", "matches", "serializeNode", "mirror", "blockClass", "blockSelector", "inlineStylesheet", "maskTextFn", "dataURLOptions", "inlineImages", "recordCanvas", "keepIframeSrcFn", "_c", "newlyAddedElement", "rootId", "docId", "DOCUMENT_NODE", "compatMode", "Document", "DOCUMENT_TYPE_NODE", "DocumentType", "publicId", "systemId", "needBlock", "HTMLFormElement", "processedTagName", "attributes", "len", "attr", "stylesheet", "styleSheets", "find", "rel", "_cssText", "sheet", "textContent", "checked", "selected", "__context", "canvas", "ctx", "getContext", "x", "width", "y", "height", "getImageData", "originalGetImageData", "Uint32Array", "buffer", "some", "pixel", "rr_dataURL", "toDataURL", "quality", "canvasDataURL", "blankCanvas", "image_1", "oldValue_1", "crossOrigin", "recordInlineImage", "naturalWidth", "naturalHeight", "drawImage", "err", "console", "warn", "currentSrc", "removeAttribute", "complete", "onload", "rr_mediaState", "paused", "rr_mediaCurrentTime", "currentTime", "scrollLeft", "rr_scrollLeft", "scrollTop", "rr_scrollTop", "_d", "getBoundingClientRect", "rr_width", "rr_height", "contentDocument", "rr_src", "Element", "isSVG", "TEXT_NODE", "parentTagName", "isStyle", "isScript", "nextSibling", "previousSibling", "Text", "CDATA_SECTION_NODE", "CDATA", "COMMENT_NODE", "Comment", "lowerIfExists", "maybeAttr", "serializeNodeWithId", "skipChild", "slimDOMOptions", "_e", "_f", "onSerialize", "onIframeLoad", "_g", "iframeLoadTimeout", "onStylesheetLoad", "_h", "stylesheetLoadTimeout", "_j", "_k", "_l", "preserveWhiteSpace", "_serializedNode", "sn", "comment", "as", "headFavicon", "headMetaDescKeywords", "headMetaSocial", "property", "headMetaRobots", "headMetaHttpEquiv", "headMetaAuthorship", "headMetaVerification", "serializedNode", "recordChild", "isShadowHost", "headWhitespace", "bypassOptions", "_m", "serializedChildNode", "_o", "_p", "isShadow", "iframeEl", "listener", "win", "contentWindow", "readyState", "fired", "blankUrl", "timer_1", "clearTimeout", "iframeDoc", "serializedIframeNode", "link", "styleSheetLoadTimeout", "styleSheetLoaded", "timer", "serializedLinkNode", "on", "fn", "passive", "removeEventListener", "DEPARTED_MIRROR_ACCESS_WARNING", "_mirror", "throttle", "wait", "timeout", "previous", "leading", "remaining", "trailing", "hookSetter", "d", "isRevoked", "original", "getOwnPropertyDescriptor", "patch", "replacement", "wrapped", "__rrweb_original__", "enumerable", "getWindowHeight", "innerHeight", "documentElement", "clientHeight", "getWindowWidth", "innerWidth", "clientWidth", "isBlocked", "isIgnored", "isAncestorRemoved", "isTouchEvent", "changedTouches", "isSerializedIframe", "nodeName", "isSerializedStylesheet", "getAttribute", "hasShadowRoot", "Proxy", "Reflect", "prop", "receiver", "StyleSheetMirror", "styleIDMap", "idStyleMap", "newId", "generateId", "EventType", "EventType2", "IncrementalSource", "IncrementalSource2", "MouseInteractions", "MouseInteractions2", "CanvasContext", "CanvasContext2", "isNodeInLinkedList", "DoubleLinkedList", "head", "position", "current", "next", "__ln", "moveKey", "parentId", "MutationBuffer", "frozen", "locked", "texts", "removes", "mapRemoves", "movedMap", "addedSet", "Set", "movedSet", "droppedSet", "processMutations", "mutations", "processMutation", "emit", "adds", "addList", "getNextId", "ns", "nextId", "pushAdd", "shadowHost", "getRootNode", "Node", "DOCUMENT_FRAGMENT_NODE", "rootShadowHost", "notInDoc", "addNode", "currentN", "iframeManager", "addIframe", "stylesheetManager", "trackLinkElement", "shadowDomManager", "addShadowRoot", "iframe", "childSn", "attachIframe", "observeAttachShadow", "attachLinkElement", "isParentRemoved", "isAncestorInSet", "candidate", "_node", "unhandledNode", "removeNode", "payload", "attribute", "mutationCb", "oldValue", "attributeName", "old", "setAttribute", "style", "styleObj", "pname", "newValue", "getPropertyValue", "newPriority", "getPropertyPriority", "addedNodes", "genAdds", "removedNodes", "nodeId", "deepDelete", "targetId", "delete", "childN", "freeze", "canvasManager", "unfreeze", "isFrozen", "lock", "unlock", "addsSet", "_isParentRemoved", "r", "size", "_isAncestorInSet", "mutationBuffers", "isCSSGroupingRuleSupported", "CSSGroupingRule", "isCSSMediaRuleSupported", "CSSMediaRule", "isCSSSupportsRuleSupported", "CSSSupportsRule", "isCSSConditionRuleSupported", "CSSConditionRule", "getEventTarget", "path", "composedPath", "initMutationObserver", "rootEl", "mutationBuffer", "mutationObserverCtor", "MutationObserver", "__rrMutationObserver", "angularZoneSymbol", "Zone", "__symbol__", "observer", "bind", "observe", "attributeOldValue", "characterData", "characterDataOldValue", "childList", "subtree", "initMouseInteractionObserver", "mouseInteractionCb", "sampling", "mouseInteraction", "disableMap", "Number", "isNaN", "eventKey", "eventName", "clientX", "clientY", "h", "initScrollObserver", "scrollCb", "evt", "scrollEl", "scrollingElement", "scroll", "wrapEventWithUserTriggeredFlag", "v", "enable", "userTriggered", "INPUT_TAGS", "lastInputValueMap", "getNestedCSSRulePositions", "childRule", "parentRule", "parentStyleSheet", "getIdAndStyleId", "styleMirror", "styleId", "ownerNode", "initAdoptedStyleSheetObserver", "hostId", "patchTarget", "defaultView", "ownerDocument", "ShadowRoot", "originalPropertyDescriptor", "sheets", "adoptStyleSheets", "initObservers", "o", "hooks", "currentWindow", "mousemoveCb", "viewportResizeCb", "inputCb", "mediaInteractionCb", "styleSheetRuleCb", "styleDeclarationCb", "canvasMutationCb", "fontCb", "selectionCb", "p", "mutation", "mousemove", "viewportResize", "mediaInteaction", "styleSheetRule", "styleDeclaration", "canvasMutation", "font", "selection", "mutationObserver", "mousemoveHandler", "threshold", "callbackThreshold", "mousemoveCallback", "timeBaseline", "positions", "wrappedCb", "totalOffset", "timeOffset", "updatePosition", "DragEvent", "Drag", "MouseEvent", "MouseMove", "TouchMove", "mouseInteractionHandler", "scrollHandler", "viewportResizeHandler", "lastH", "lastW", "inputHandler", "ignoreClass", "userTriggeredOnInput", "eventHandler", "isTrusted", "isChecked", "cbWithDedup", "querySelectorAll", "lastInputValue", "propertyDescriptor", "HTMLInputElement", "hookProperties", "HTMLSelectElement", "HTMLTextAreaElement", "HTMLOptionElement", "mediaInteractionHandler", "volume", "muted", "playbackRate", "media", "styleSheetObserver", "insertRule", "CSSStyleSheet", "deleteRule", "replaceSync", "supportedNestedCSSRuleTypes", "unmodifiedFunctions", "entries", "typeKey", "adoptedStyleSheetObserver", "styleDeclarationObserver", "ignoreCSSAttributes", "setProperty", "CSSStyleDeclaration", "priority", "removeProperty", "remove", "fontObserver", "collectFonts", "fontMap", "originalFontFace", "FontFace", "family", "descriptors", "fontFace", "fontSource", "JSON", "stringify", "restoreHandler", "fonts", "selectionObserver", "param", "collapsed", "updateSelection", "getSelection", "isCollapsed", "ranges", "count", "rangeCount", "getRangeAt", "startContainer", "startOffset", "endContainer", "endOffset", "pluginHandlers", "plugin", "plugins", "b", "disconnect", "CrossOriginIframeMirror", "generateIdFn", "iframeIdToRemoteIdMap", "iframeRemoteIdToIdMap", "remoteId", "idToRemoteMap", "remoteToIdMap", "idToRemoteIdMap", "getIdToRemoteIdMap", "remoteIdToIdMap", "getRemoteIdToIdMap", "ids", "getRemoteId", "IframeManager", "iframes", "crossOriginIframeMap", "crossOriginIframeMirror", "wrappedEmit", "recordCrossOriginIframes", "crossOriginIframeStyleMirror", "handleMessage", "cb", "loadListener", "isAttachIframe", "adoptedStyleSheets", "transformedEvent", "transformCrossOriginEvent", "isCheckout", "FullSnapshot", "replaceIdOnNode", "IncrementalSnapshot", "Mutation", "Meta", "Load", "DomContentLoaded", "Plugin", "Custom", "replaceIds", "ViewportResize", "MediaInteraction", "MouseInteraction", "Scroll", "CanvasMutation", "Input", "StyleSheetRule", "StyleDeclaration", "replaceStyleIds", "Font", "Selection", "AdoptedStyleSheet", "styles", "iframeMirror", "obj", "isArray", "child", "ShadowDomManager", "shadowDoms", "WeakSet", "restorePatches", "manager", "option", "iframeElement", "HTMLElement", "restorePatch", "__awaiter", "thisArg", "_arguments", "P", "generator", "Promise", "resolve", "reject", "fulfilled", "step", "rejected", "done", "lookup", "charCodeAt", "canvasVarMap", "saveWebGLVar", "isInstanceOfWebGLObject", "list", "ctor", "contextMap", "serializeArg", "arg", "Float32Array", "Float64Array", "Int32Array", "Uint16Array", "Int16Array", "Int8Array", "Uint8ClampedArray", "rr_type", "ArrayBuffer", "base64", "arraybuffer", "DataView", "byteOffset", "byteLength", "HTMLImageElement", "HTMLCanvasElement", "ImageData", "serializeArgs", "supportedWebGLConstructorNames", "initCanvasContextObserver", "contextType", "patchGLPrototype", "props", "getOwnPropertyNames", "recordArgs", "hookHandler", "setter", "WorkerClass", "WorkerThreads", "require", "__non_webpack_require__", "Worker", "createBase64WorkerFactory", "sourcemapArg", "enableUnicodeArg", "sourcemap", "enableUnicode", "Buffer", "eval", "createURL", "binaryString", "atob", "binaryView", "String", "fromCharCode", "blob", "Blob", "createObjectURL", "kIsNodeJS", "process", "WorkerFactory", "createBase64WorkerFactory$1", "CanvasManager", "pendingCanvasMutations", "rafStamps", "latestId", "invokeId", "initCanvasMutationObserver", "initCanvasFPSObserver", "clear", "resetObservers", "fps", "canvasContextReset", "snapshotInProgressMap", "worker", "onmessage", "commands", "timeBetweenSnapshots", "rafId", "lastSnapshotTime", "takeCanvasSnapshots", "matchedCanvas", "getCanvas", "getContextAttributes", "preserveDrawingBuffer", "COLOR_BUFFER_BIT", "bitmap", "createImageBitmap", "postMessage", "requestAnimationFrame", "cancelAnimationFrame", "startRAFTimestamping", "startPendingCanvasMutationFlusher", "canvas2DReset", "props2D", "CanvasRenderingContext2D", "canvasWebGL1and2Reset", "WebGLRenderingContext", "WebGL", "WebGL2RenderingContext", "WebGL2", "flushPendingCanvasMutations", "setLatestRAFTimestamp", "flushPendingCanvasMutationFor", "valuesWithType", "rest", "getOwnPropertySymbols", "propertyIsEnumerable", "StylesheetManager", "trackedLinkElements", "adoptedStyleSheetCb", "linkEl", "trackStylesheetInLinkElement", "adoptedStyleSheetData", "styleIds", "CSSRule", "wrapEvent", "takeFullSnapshot", "recording", "record", "checkoutEveryNms", "checkoutEveryNth", "maskAllInputs", "_maskInputOptions", "_slimDOMOptions", "packFn", "mousemoveWait", "inEmittingFrame", "parent", "passEmitsToParent", "color", "date", "email", "month", "number", "search", "tel", "time", "week", "textarea", "select", "password", "lastFullSnapshotEvent", "NodeList", "DOMTokenList", "TypeError", "polyfill", "incrementalSnapshotCount", "eventProcessor", "buf", "exceedCount", "exceedTime", "wrappedMutationEmit", "wrappedScrollEmit", "wrappedCanvasMutationEmit", "getMirror", "nodeMirror", "slimDOM", "initialOffset", "left", "pageXOffset", "top", "pageYOffset", "addLoadListener", "addCustomEvent", "tag", "freezePage", "ContinuousReplay", "visibilityHandler", "handleVisibilityChange", "timerHandle", "setInterval", "recordCapture", "restartCapture", "intervalMs", "startCapture", "stopper", "clearInterval", "visibilityState", "captureSession", "events", "rrweb.record", "EventBuffer", "content", "hasSpace", "isPopulated", "RollingBuffer", "bufferSize", "numBuffers", "buffers", "writePointer", "headPointer", "toArray", "asArray", "acc", "realIndex", "RollingReplay", "eventSegmentLength", "segmentBufferLength", "SessionReplay", "captureOptions", "impl", "_context", "itemOrDefault", "defaultValue", "parseHttp", "defaults", "parseStack", "initializeTelemetry", "parsedOptions"]
}
